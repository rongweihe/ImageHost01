(function(t){function e(e){for(var i,r,o=e[0],c=e[1],l=e[2],u=0,h=[];u<o.length;u++)r=o[u],Object.prototype.hasOwnProperty.call(s,r)&&s[r]&&h.push(s[r][0]),s[r]=0;for(i in c)Object.prototype.hasOwnProperty.call(c,i)&&(t[i]=c[i]);d&&d(e);while(h.length)h.shift()();return a.push.apply(a,l||[]),n()}function n(){for(var t,e=0;e<a.length;e++){for(var n=a[e],i=!0,r=1;r<n.length;r++){var c=n[r];0!==s[c]&&(i=!1)}i&&(a.splice(e--,1),t=o(o.s=n[0]))}return t}var i={},s={app:0},a=[];function r(t){return o.p+"js/"+({}[t]||t)+"."+{"chunk-2d0a3707":"285e24e8","chunk-2d0a3ef6":"bb6a6b15","chunk-2d0a510c":"ec304768","chunk-2d0aa799":"02757641","chunk-2d0aaccb":"07e3109d","chunk-2d0ab538":"eab265df","chunk-2d0ac346":"ac70700e","chunk-2d0ae544":"850cb46d","chunk-2d0aeade":"ee49e918","chunk-2d0aecf9":"a52da89a","chunk-2d0aed77":"1a796428","chunk-2d0b166f":"0a268973","chunk-2d0b19f5":"15903620","chunk-2d0b2797":"831dc5b9","chunk-2d0b2ae9":"380bf07e","chunk-2d0b3115":"45dd609e","chunk-2d0b64bf":"7b3c5fd2","chunk-2d0b64d0":"93e877ab","chunk-2d0b9f44":"e69bca54","chunk-2d0ba1c2":"720e6deb","chunk-2d0ba8d9":"b0ad131b","chunk-2d0bce33":"c5d2d1c0","chunk-2d0be2ea":"6fc2a9a7","chunk-2d0c0868":"4b2342f6","chunk-2d0c119a":"f1fa6565","chunk-2d0c210c":"1ff0ff8b","chunk-2d0c2184":"c896f14a","chunk-2d0c55f4":"da200992","chunk-2d0c7ab7":"7901ce8b","chunk-2d0c8495":"dade308d","chunk-2d0c866f":"bb460b06","chunk-2d0ccf7b":"788e90c8","chunk-2d0ccfc7":"02ccdb38","chunk-2d0ce738":"afa1be15","chunk-2d0ce7ef":"02586330","chunk-2d0cfcc0":"37a88180","chunk-2d0cfe92":"6e51d29b","chunk-2d0d2baf":"73e13cbf","chunk-2d0d3646":"28dd89c8","chunk-2d0d3e62":"01e31c0f","chunk-2d0d4404":"0afd9582","chunk-2d0d6ad7":"3431c43e","chunk-2d0d6b34":"f8891de1","chunk-2d0d7133":"b50691eb","chunk-2d0d7514":"ddf204d9","chunk-2d0d7d8c":"1d95c7a6","chunk-2d0da8f6":"efc27cd4","chunk-2d0daae9":"5034ac07","chunk-2d0df075":"9a70b222","chunk-2d0df21d":"30f60eca","chunk-2d0e1b85":"cd9bfd1f","chunk-2d0e22ea":"443f79a3","chunk-2d0e44ea":"26269bbe","chunk-2d0e599d":"3bfdc89e","chunk-2d0e5ba4":"dec07fe6","chunk-2d0e62d4":"61e9dd53","chunk-2d0e648b":"91b19427","chunk-2d0e8df2":"8964ef33","chunk-2d0efcdf":"f705214b","chunk-2d0f02bd":"05b23b70","chunk-2d209029":"500c05d0","chunk-2d209171":"7046dbce","chunk-2d209b50":"53a7f34a","chunk-2d20f159":"f528405f","chunk-2d2101d0":"e1a3639a","chunk-2d21048c":"9eb62164","chunk-2d212f1e":"1975945e","chunk-2d217c9d":"bd1a60c4","chunk-2d21de27":"53d7ec59","chunk-2d21f0d5":"ffa38786","chunk-2d2214ef":"656010fd","chunk-2d221a5f":"fe75b368","chunk-2d221f5b":"af6173a0","chunk-2d224d1d":"11543838","chunk-2d224ea1":"39aae0d2","chunk-2d2250e2":"a218a345","chunk-2d226cf7":"2c9f3103","chunk-2d2290fe":"a167e1f5","chunk-2d229493":"cd50be07","chunk-2d229616":"edff9039","chunk-2d2299f6":"ffbd3406","chunk-2d229b2c":"262e01a4","chunk-2d229c14":"f838cc75","chunk-2d22a16b":"e9bb9306","chunk-2d22a179":"6d1ba39a","chunk-2d22c563":"9a6f2b77","chunk-2d22c8e5":"0bdf2151","chunk-2d22cfac":"603cce82","chunk-2d22d237":"a7fde47c","chunk-2d22d48f":"76834d9f","chunk-2d230e22":"88ffb265","chunk-2d237700":"c7ccef71","chunk-2d238a09":"fe765f1f","chunk-7482622c":"d64b0cb4","chunk-748bca26":"557b1b9c"}[t]+".js"}function o(e){if(i[e])return i[e].exports;var n=i[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,o),n.l=!0,n.exports}o.e=function(t){var e=[],n=s[t];if(0!==n)if(n)e.push(n[2]);else{var i=new Promise((function(e,i){n=s[t]=[e,i]}));e.push(n[2]=i);var a,c=document.createElement("script");c.charset="utf-8",c.timeout=120,o.nc&&c.setAttribute("nonce",o.nc),c.src=r(t);var l=new Error;a=function(e){c.onerror=c.onload=null,clearTimeout(u);var n=s[t];if(0!==n){if(n){var i=e&&("load"===e.type?"missing":e.type),a=e&&e.target&&e.target.src;l.message="Loading chunk "+t+" failed.\n("+i+": "+a+")",l.name="ChunkLoadError",l.type=i,l.request=a,n[1](l)}s[t]=void 0}};var u=setTimeout((function(){a({type:"timeout",target:c})}),12e4);c.onerror=c.onload=a,document.head.appendChild(c)}return Promise.all(e)},o.m=t,o.c=i,o.d=function(t,e,n){o.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},o.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o.t=function(t,e){if(1&e&&(t=o(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)o.d(n,i,function(e){return t[e]}.bind(null,i));return n},o.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return o.d(e,"a",e),e},o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},o.p="https://sf1-scmcdn2-tos.pstatp.com/xitu_juejin_web_editor/",o.oe=function(t){throw console.error(t),t};var c=window["webpackJsonp"]=window["webpackJsonp"]||[],l=c.push.bind(c);c.push=e,c=c.slice();for(var u=0;u<c.length;u++)e(c[u]);var d=l;a.push([0,"chunk-vendors"]),n()})({0:function(t,e,n){t.exports=n("cd49")},"00b7":function(t,e,n){},"043c":function(t,e,n){},"045f":function(t,e,n){t.exports=n.p+"img/img.8288be10.svg"},"0506":function(t,e,n){"use strict";var i=n("dd3b"),s=n.n(i);s.a},"0524":function(t,e,n){"use strict";var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"publish-popup",class:{active:t.active,disabled:t.disabled},attrs:{"st:block":"publishPopup"}},[n("div",{staticClass:"toggle-btn",on:{click:function(e){t.active=!t.disabled&&!t.active}}},[n("span",{staticClass:"title"},[t._v(t._s(t.actionText))]),n("i",{staticClass:"icon",class:["ion-arrow-"+(t.active?"up":"down")+"-b"]})]),n("div",{directives:[{name:"show",rawName:"v-show",value:t.active,expression:"active"}],staticClass:"panel"},[n("div",{staticClass:"title"},[t._v(t._s(t.actionText+"文章"))]),n("div",{staticClass:"category-box"},[n("div",{staticClass:"sub-title"},[t._v("分类")]),n("div",{staticClass:"category-list"},t._l(t.categoryList,(function(e){return n("div",{staticClass:"item",class:{active:t.currentCategoryId===e.id},on:{click:function(n){t.post.category=e}}},[t._v(" "+t._s(e.title)+" ")])})),0)]),n("div",{staticClass:"tag-box"},[n("div",{staticClass:"sub-title"},[t._v("添加标签")]),n("div",{staticClass:"category-list"},[t._l(t.post.tags,(function(e){return n("div",{staticClass:"item",on:{click:function(n){return n.stopPropagation(),t.removeTag(e)}}},[t._v(" "+t._s(e.title)+" ")])})),t.customTagLength<t.tagLimit?[t.isSugging?n("TagInput",{ref:"tagInput",staticClass:"tag-input",attrs:{tagLimit:t.tagLimit},on:{add:t.addTag,cancleSug:t.cancleSug}}):n("div",{staticClass:"add-btn-item",on:{click:function(e){return e.stopPropagation(),t.handleAddButton(e)}}},[t._v(" +添加标签 ")])]:t._e()],2)]),n("button",{staticClass:"publish-btn",attrs:{disabled:t.disabled||!t.isDraft&&!t.canPublish,"st:name":"publishBtn"},on:{click:t.publish}},[t._v(" "+t._s("确定并"+t.actionText)+" ")]),t.isDraft||t.canPublish?t._e():n("div",{staticClass:"forbidden-box"},[t._v(" 您尚不能发布文章 "),n("br"),t._v(" 请先验证手机或邮箱，或 "),n("a",{staticClass:"link",attrs:{href:"/user/settings/account",target:"_blank"}},[t._v(" 绑定第三方账号 ")]),n("br"),t._v(" （操作后刷新此页面） ")])])])},s=[],a=n("c5cc"),r=n("8a69"),o=n("e974"),c=n("7bbb");function l(t,e){c["b"](),e.getPage(),e.getPageSize(),e.getSort();return Object(a["a"])({url:"/tag_api/v1/query_tag_list",method:"post",body:{key_word:t}}).then(t=>t.data).then(t=>t.map(d))}function u(){return Object(a["a"])({url:"/tag_api/v1/query_category_list",method:"post",body:{}}).then(t=>t.data).then(t=>t.map(o["a"].fromServerDescriptor))}function d(t){const e=t.tag||{},n=t.user_interact||{};return r["a"].fromDescriptor({id:e.tag_id,title:e.tag_name,createdAt:new Date(e.ctime),updatedAt:new Date(e.mtime),color:e.color,icon:e.icon,showOnNav:e.show_navi,alias:e.tag_alias,entryCount:e.post_article_count,subscribersCount:e.concern_user_count,subscribed:n.is_follow})}function h(){return u()}function f(){return h()}var p=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"tag-input"},[n("input",{directives:[{name:"model",rawName:"v-model",value:t.addingTagWord,expression:"addingTagWord"}],ref:"sugInput",staticClass:"input",attrs:{type:"text",placeholder:t.tagInputPlaceholder},domProps:{value:t.addingTagWord},on:{keydown:function(e){return t.onKeyDown(e)},blur:t.cancleSug,input:function(e){e.target.composing||(t.addingTagWord=e.target.value)}}}),t.addingTagWord.length&&t.suggestedTagList.length?n("ul",{staticClass:"suggested-tag-list"},t._l(t.suggestedTagList,(function(e,i){return n("li",{staticClass:"tag",class:{selected:i===t.selectedIndex},on:{click:function(n){return n.stopPropagation(),t.addTag(e)}}},[t._v(" "+t._s(e.title)+" ")])})),0):t._e(),t.addingTagWord.length&&!t.suggestedTagList.length?n("ul",{staticClass:"suggested-tag-list"},[n("li",{staticClass:"empty-tag"},[t._v(" 无匹配标签 ")])]):t._e()])},m=[];function g(t,e){return l(t,e)}class b{constructor(){this._constraintList=[],this._selectKeyList=[],this._includeKeyList=[],this._page=1,this._pageSize=null,this._sort=null,this._pointer=null}select(t){return this._selectKeyList=this._selectKeyList.concat(t instanceof Array?t:[t]),this}include(t){return this._includeKeyList=this._includeKeyList.concat(t instanceof Array?t:[t]),this}page(t){return this._page=t,this}getPage(){return this._page}pageSize(t){return this._pageSize=t,this}getPageSize(){return this._pageSize}sort(t){return this._sort=t,this}getSort(){return this._sort}pointer(t){return this._pointer=t,this}getPointer(){return this._pointer}ascending(t){return v(this,"ascending",t)}addAscending(t){return v(this,"addAscending",t)}descending(t){return v(this,"descending",t)}addDescending(t){return v(this,"addDescending",t)}equalTo(t,e){return v(this,"equalTo",t,e)}notEqualTo(t,e){return v(this,"notEqualTo",t,e)}lessThan(t,e){return v(this,"lessThan",t,e)}lessThanOrEqualTo(t,e){return v(this,"lessThanOrEqualTo",t,e)}greaterThan(t,e){return v(this,"greaterThan",t,e)}greaterThanOrEqualTo(t,e){return v(this,"greaterThanOrEqualTo",t,e)}containedIn(t,e){return v(this,"containedIn",t,e)}matches(t,e,n){return v(this,"matches",t,e,n)}getEqualConstraintValue(t){const e=this._constraintList.filter(e=>"equalTo"===e.type&&e.key===t)[0];return(e||{}).value}applyAVQuery(t){return this._pageSize&&(t.skip((this._page-1)*this._pageSize),t.limit(this._pageSize)),this._selectKeyList.length&&t.select(this._selectKeyList),this._includeKeyList.forEach(e=>{t.include(e)}),this._constraintList.forEach(({type:e,key:n,value:i,option:s})=>{t[e](n,i,s)}),t}}function v(t,e,n,i,s){return t._constraintList.push({type:e,key:n,value:i,option:s}),t}function _(t){const e=(new b).page(1).pageSize(20);return g(t,e)}var k=n("c34c"),y={props:["tagLimit"],data:()=>({addingTagWord:"",suggestedTagList:[],selectedIndex:-1,requestToken:null,tagInputPlaceholder:""}),watch:{addingTagWord(){this.fetchSuggestedTagList()}},methods:{cancleSug(){this.addingTagWord.trim().length||this.$emit("cancleSug")},addTag(t){this.$emit("add",t),this.reset()},onKeyDown(t){switch(t.keyCode){case 38:t.preventDefault(),this.selectePrev();break;case 40:t.preventDefault(),this.selecteNext();break;case 13:this.addSelectedTag();break}},selecteNext(){this.selectedIndex<this.suggestedTagList.length-1&&this.selectedIndex++},selectePrev(){this.selectedIndex>0&&this.selectedIndex--},addSelectedTag(){const t=this.suggestedTagList[this.selectedIndex];t&&this.addTag(t)},reset(){this.addingTagWord="",this.resetSuggestion()},resetSuggestion(){this.selectedIndex=-1,this.suggestedTagList=[]}},created(){this.tagInputPlaceholder="搜索标签",this.fetchSuggestedTagList=Object(k["a"])(()=>{const t=Date.now();this.requestToken=t,this.resetSuggestion(),this.addingTagWord&&_(this.addingTagWord).then(e=>{this.requestToken===t&&(this.suggestedTagList=e)})},300)}},C=y,w=(n("5955"),n("2877")),x=Object(w["a"])(C,p,m,!1,null,"30000dda",null),E=x.exports,O={components:{TagInput:E},props:["post","disabled"],data:()=>({isSugging:!1,active:!1,categoryList:[],tagLimit:1}),computed:{currentCategoryId(){return(this.post.category||{}).id},isDraft(){return!this.post.entry},actionText(){return this.isDraft?"发布":"更新"},user(){return this.$store.getters.USER},canPublish(){const t=this.user;return t&&(t.community||t.emailVerified||t.mobilePhoneVerified)},customTagLength(){return this.post.tags.length}},methods:{cancleSug(){this.isSugging=!1},handleAddButton(){this.isSugging=!0,this.$nextTick(()=>{this.$refs.tagInput.$refs.sugInput.focus()})},addTag(t){this.removeTag(t),this.post.tags=this.post.tags.concat([t]),this.isSugging=!1},removeTag(t){this.post.tags=this.post.tags.filter(e=>e.id!==t.id)},publish(){this.$emit("publish")}},domEvents:{click({target:t}){this.$el.contains(t)||(this.active=!1)}},created(){this.user&&((1===this.user.builder||1===this.user.favorable_author||1===this.user.book_author||this.user.level>=4)&&(this.tagLimit=2),1===this.user.administrator&&(this.tagLimit=5))},mounted(){f().then(t=>{this.categoryList=t,this.post.category&&this.post.category.category_url||(this.post.category=j(t))})}};function j(t){return t.filter(t=>"article"===t.category_url)[0]||t[0]}var T=O,S=(n("2e74"),Object(w["a"])(T,i,s,!1,null,"44283c70",null));e["a"]=S.exports},"077c":function(t,e,n){t.exports=n.p+"img/collapse.dbb05aef.svg"},"08a6":function(t,e,n){"use strict";n.r(e);var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n(t.editor,{tag:"component",attrs:{post:t.post,status:t.status},on:{update:t.update,publish:t.publish}})},s=[],a=n("e37c"),r=n("2fd7"),o=n("3828"),c=n("88f3");const l=new r["a"];var u={components:{RichTextEditor:o["a"],MarkdownEditor:c["a"]},data:()=>({editor:null,post:null,status:"editing"}),metaInfo(){const t=["写文章",(this.post||{}).title,"掘金"];return{title:t.filter(t=>t).join(" - ")}},methods:{init(){const t=this.$route.params.id;this.initPost(t).then(()=>this.initEditor()).catch(t=>{this.$error(t)})},initPost(t){return Object(a["b"])(t).then(e=>{e.entry?this.post=e:window.location.href="/editor/drafts/"+t})},initEditor(){this.post&&(this.editor="wysiwyg"===this.post.type?"RichTextEditor":"MarkdownEditor")},update(){this.status="saving",l.validate(this.post).then(()=>Object(a["a"])(this.post)).then(()=>{this.status="editing"}).catch(t=>{this.status="error",this.$error(t)})},publish(){this.status="saving",l.validate(this.post).then(()=>Object(a["e"])(this.post)).then(()=>{window.location.href=Object(a["c"])(this.post.id)}).catch(t=>{this.status="error",this.$error(t)})}},mounted(){this.init()}},d=u,h=n("2877"),f=Object(h["a"])(d,i,s,!1,null,"15cdce54",null);e["default"]=f.exports},"0b6e":function(t,e,n){"use strict";n.r(e);var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"view index-view"})},s=[],a={mounted(){window.location.href="/editor/drafts?v=2"}},r=a,o=n("2877"),c=Object(o["a"])(r,i,s,!1,null,"7552ffae",null);e["default"]=c.exports},"0c00":function(t,e,n){},1:function(t,e){},"117d":function(t,e,n){"use strict";var i=n("8075"),s=n.n(i);s.a},1518:function(t,e,n){"use strict";n.r(e),e["default"]="### 用掘金－Markdown 编辑器写文章\n\n欢迎使用 掘金－Markdown 编辑器撰写技术文章，只专注于内容和技术，不再费心排版的问题。这是一份简要的 Markdown 引导指南，希望可以帮助您顺利的开始使用 Markdown 编辑器。\n\n### 丰富的快捷键\n\n本 Markdown 编辑器支持丰富的格式快捷键，可以非常便捷、轻松的使用 Markdown 语言，形成优美的排版和内容格式。\n\n支持的快捷键有：\n\n* 加粗： `Ctrl/Cmd + B`\n* 标题： `Ctrl/Cmd + H`\n* 插入链接： `Ctrl/Cmd + K`\n* 插入代码： `Ctrl/Cmd + Shift + C`\n* 行内代码： `Ctrl/Cmd + Shift + K`\n* 插入图片： `Ctrl/Cmd + Shift + I`\n* 无序列表： `Ctrl/Cmd + Shift + L`\n* 撤销： `Ctrl/Cmd + Z`\n\n### 常用语法\n\n#### 标题\n\n> 语法格式：** '#'+'空格'+'文本' **\n\n# 一级标题\n## 二级标题\n### 三级标题\n#### 四级标题\n##### 五级标题\n###### 六级标题\n\n#### 列表\n\n> 无序列表语法格式：** '-' + '空格' ＋ '文本' **\n\n- 文本一\n- 文本二\n- 文本三\n\n> 有序列表语法格式：** '数字' + '.' + '空格' + '文本' **\n\n1. 文本一\n2. 文本二\n3. 文本三\n\n> 任务列表语法格式：** '-' + '空格' + '[ ]' + '文本' **\n\n- [x] 文本一\n- [ ] 文本二\n- [ ] 文本三\n\n#### 链接和图片\n\n在 Markdown 中插入链接不需要其他按钮，你只需要使用`［显示文本］(链接地址)`这样的格式语法即可。例如：\n[稀土掘金](https://gold.xitu.io)\n插入图片的语法与插入链接的语法很像，只是前面多了一个 `!`.语法如下：\n`![图片的标注](图片链接地址)`\n\n#### 引用\n\n> 语法：** '>'+'空格'+'文本' **\n\n\n例如：\n\n> Markdown 是一种轻量级标记语言，它允许人们使用易读易写的纯文本格式编写文档，然后转换成格式丰富的HTML页面。\n\n#### 代码\n\n如下是代码段的语法：\n\n<pre>\n```编程语言\n 这是代码段\n```\n</pre>\n\n例如：\n\n``` python\ndef bubbleSort(alist):\n for passnum in range(len(alist)-1,0,-1):\n #print alist,passnum\n for i in range(passnum):\n if alist[i]>alist[i+1]:\n temp = alist[i]\n alist[i] = alist[i+1]\n alist[i+1] = temp\n return alist\n```\n\n#### 表格\n\n**Markdown　Extra**　表格语法：\n\n项目 | 价格\n-------- | ---\niPhone | $560\niPad | $780\niMac | $1000\n\n可以使用冒号来定义对齐方式：\n\n| 项目 | 价格 | 数量 |\n| :-------- | --------:| :--: |\n| iPhone | 6000 元 | 5 |\n| iPad | 3800 元 | 12 |\n| iMac | 10000 元 | 234 |\n\n\n#### 结语\n\n以上是最常见的 Markdown 的语法和格式，如果你还希望深入的学习 Markdown，可以参考这里[Markdown语法](https://www.appinn.com/markdown/)，非常感谢使用** 掘金－Markdown 编辑器**,希望为您提供舒适的写作体验。\n"},1575:function(t,e,n){},1595:function(t,e,n){"use strict";var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"main-image-selector",class:{active:t.active,unset:t.unset,updating:t.updating},attrs:{"st:block":"mainImageSelector"}},[n("div",{staticClass:"toggle-btn",on:{click:function(e){t.active=!t.active}}}),n("div",{directives:[{name:"show",rawName:"v-show",value:t.active,expression:"active"}],staticClass:"panel"},[n("div",{staticClass:"title"},[t._v("添加封面大图")]),n("button",{directives:[{name:"show",rawName:"v-show",value:t.unset,expression:"unset"}],staticClass:"select-btn",attrs:{disabled:t.updating,"st:name":"addBtn"},on:{click:t.selectImageFile}},[t._v(" "+t._s(t.prompt)+" ")]),n("div",{directives:[{name:"show",rawName:"v-show",value:!t.unset,expression:"!unset"}],staticClass:"preview-box"},[n("img",{staticClass:"preview-image",attrs:{src:t.thumbUrl}}),n("button",{staticClass:"delete-btn",attrs:{title:"移除这张图片","st:name":"removeBtn"},on:{click:t.deleteImage}},[n("i",{staticClass:"ion-trash-a"})])])]),n("input",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],ref:"file",attrs:{type:"file"},on:{change:function(e){return t.onFileSelected(e)}}})])},s=[],a=n("a9cf"),r=n("5c91"),o=n("6a08"),c={props:["post"],data:()=>({active:!1,updating:!1}),computed:{unset(){return!this.post.cover_image},prompt(){return this.updating?"头图设置中...":"点击此处添加图片"},thumbUrl(){const t=this.post.cover_image;return t?Object(r["b"])(t,480,480):""}},methods:{selectImageFile(){this.$refs.file.click()},onFileSelected({target:t}){const e=t.files[0];e&&(this.$refs.file.value=null,this.changeMainImage(e))},changeMainImage(t){return this.updating=!0,Object(o["b"])(this.post.user_id,[t]).then(t=>{this.post.cover_image=t[0]&&t[0].Url,this.updating=!1}).catch(t=>{t.message=t.message||"头图设置失败",this.$error(t),this.updating=!1})},deleteImage(){return Object(a["a"])(this.post).then(()=>{this.post.cover_image=null})}},domEvents:{click({target:t}){this.$el.contains(t)||(this.active=!1)}}},l=c,u=(n("283f"),n("2877")),d=Object(u["a"])(l,i,s,!1,null,"6b58442b",null);e["a"]=d.exports},"15b4":function(t,e,n){},1684:function(t,e,n){},"1a50":function(t,e,n){"use strict";var i=n("41aa"),s=n.n(i);s.a},"1b28":function(t,e,n){"use strict";n.d(e,"c",(function(){return M})),n.d(e,"a",(function(){return P})),n.d(e,"b",(function(){return U})),n.d(e,"d",(function(){return R}));var i=n("66e4"),s=n.n(i),a=n("0d96"),r=n.n(a),o=n("6443"),c=n.n(o),l=n("ec0d"),u=n.n(l),d=n("27ba"),h=n.n(d),f=n("27fe"),p=n.n(f),m=n("ecd3"),g=n.n(m),b=n("7921"),v=n.n(b),_=n("6644"),k=n.n(_),y=n("292c"),C=n.n(y),w=n("b84f"),x=n.n(w),E=n("64ed"),O=n("d91e"),j=n("6a08"),T=n("50c5"),S=n.n(T),A=n("14ec"),L=n.n(A);n("631c"),n("7cd2");const I=h()({async upload(t){const e=await Object(j["b"])("",t);return e.map(t=>t.Url)}}),$=/Mac/.test(navigator.platform)?"Cmd":"Ctrl",D=Object(O["a"])([I]),N=[c()(),s()(),u()(),I,v()({test(t){return!0}}),{editorEffect(t){t.editor.focus(),t.editor.setOption("extraKeys",{[$+"-H"]:()=>{D.h2.onClick(t)},[$+"-B"]:()=>{D.bold.onClick(t)},[$+"-K"]:()=>{D.link.onClick(t)},[`Shift-${$}-K`]:()=>{D.code.onClick(t)},[`Shift-${$}-C`]:()=>{D.codeBlock.onClick(t)},[`Shift-${$}-I`]:()=>{D.image.onClick(t)},[`Shift-${$}-L`]:()=>{D.ul.onClick(t)}})}}],M=({onLoadingChange:t,catchError:e})=>({editorEffect({editor:n}){const i=async(n,i)=>{if("paste"!==i.origin)return;const s=n.getValue(),a=[],r=Object(E["getProcessor"])({plugins:[{rehype:t=>t.use(()=>t=>{k()(t,"element",t=>{if("img"===t.tagName){const e=t.properties.src;e.includes("p-boe.byted.org")||e.includes("juejin.byteimg.com")||a.push(e)}})})}]});if(r.processSync(s),!a.length)return;t(!0);let o=!1;const c=await Promise.all(a.map(async t=>{try{const e=await Object(j["a"])(t);return e.data}catch(e){return o=!0,null}}));o&&e();let l=s;a.forEach((t,n)=>{if(c[n])if(l.includes(t))l=l.replace(t,c[n]);else try{const e=decodeURI(t);l=l.replace(e,c[n])}catch(i){e()}}),n.setValue(l),t(!1)};return n.on("change",i),()=>{n.off("change",i)}}}),P=[...N,r()(),p()(),g()({style({frontmatter:t}){var e,n;return null!==(n=null===(e=S.a[null===t||void 0===t?void 0:t.theme])||void 0===e?void 0:e.style)&&void 0!==n?n:S.a.juejin.style},async lazyStyle({frontmatter:t}){var e,n,i;const s=null!==(e=null===t||void 0===t?void 0:t.highlight)&&void 0!==e?e:null===(n=S.a[null===t||void 0===t?void 0:t.theme])||void 0===n?void 0:n.highlight,a=null!==(i=L.a[s])&&void 0!==i?i:L.a.github,r=await a();return r.default}})],U=[...P,{viewerEffect({$el:t}){const e=t.querySelectorAll(".prism-player");0!==e.length&&e.forEach(t=>{const e=t.getAttribute("data-source");if(!e)return;const n=document.createElement("video");n.controls=!0,n.src=e,t.replaceWith(n)})}}],R=[...N,{remark:t=>t.use(x.a),rehype:t=>t.use(()=>t=>{k()(t,"element",(t,e,n)=>{const i=t.properties;if(i.className&&i.className.includes("math")){const s=t.children[0].value;i.className.includes("math-inline")?n.children.splice(e,1,C()("img",{className:["equation"],src:`https://${window.location.host}/equation?tex=${encodeURIComponent(s)}`,alt:s.replace(/"/g,"&quot;")})):i.className.includes("math-display")&&n.children.splice(e,1,C()("figure",[C()("img",{className:["equation"],src:`https://${window.location.host}/equation?tex=${encodeURIComponent(s)}`,alt:s.replace(/"/g,"&quot;")})]))}})})}]},"1b8d":function(t,e,n){"use strict";n.r(e);var i=n("7c64");const s="auth/UPDATE_STATE";e["default"]={state:{userId:null,clientId:null,token:null,user:null},getters:{[i["AUTH_INFO"]]:t=>t,[i["USER"]]:t=>t.user},mutations:{[s](t,e){Object.assign(t,e)}},actions:{[i["SET_AUTH_INFO"]]({commit:t},e){t(s,e)}}}},"1bd3":function(t,e,n){"use strict";var i=n("8f0a"),s=n.n(i);s.a},"1c8b":function(t,e,n){},"1e08":function(t,e,n){},"1ec1":function(t,e,n){},"23c1":function(t,e,n){},2409:function(t,e,n){"use strict";var i=n("a0d4"),s=n.n(i);s.a},"24c0":function(t,e,n){"use strict";const i={init(){(function(t,e,n,i,s,a,r){t["GoogleAnalyticsObject"]=s,t[s]=t[s]||function(){(t[s].q=t[s].q||[]).push(arguments)},t[s].l=1*new Date,a=e.createElement(n),r=e.getElementsByTagName(n)[0],a.async=1,a.src=i,r.parentNode.insertBefore(a,r)})(window,document,"script","//www.google-analytics.com/analytics.js","ga"),window.ga("create","UA-57015356-3")},exec(...t){window.ga||this.init(),window.ga.apply(window,t)}};e["a"]=i},"268c":function(t,e,n){"use strict";var i=n("80e9"),s=n.n(i);s.a},"283f":function(t,e,n){"use strict";var i=n("a4f5"),s=n.n(i);s.a},"2c25":function(t,e,n){"use strict";var i=n("4cc5"),s=n.n(i);s.a},"2df9":function(t,e,n){"use strict";var i=n("f8ff"),s=n.n(i);s.a},"2e106":function(t,e,n){"use strict";var i=n("1c8b"),s=n.n(i);s.a},"2e74":function(t,e,n){"use strict";var i=n("35a6"),s=n.n(i);s.a},"2fa5":function(t,e,n){"use strict";var i=n("1e08"),s=n.n(i);s.a},"2fd7":function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var i=n("ea37"),s=n("cecb");class a{validate(t){return Promise.resolve().then(()=>this.checkCategory(t)).then(()=>this.checkTags(t)).then(()=>this.checkTitle(t)).then(()=>this.checkMarkdown(t)).then(()=>this.checkHttpImage(t))}checkCategory(t){return t.category?Promise.resolve():Promise.reject(new r("请选择一个分类"))}checkTags(t){return t.tags.length>0?Promise.resolve():Promise.reject(new r("至少添加一个标签"))}checkTitle(t){return(t.title||"").trim()?Promise.resolve():Promise.reject(new r("标题不能为空"))}checkMarkdown(t){return(t.markdown||"").trim()?Promise.resolve():Promise.reject(new r("内容不能为空"))}checkWordCount(t){const e=Object(i["a"])(t.html);return e&&e>s["b"]?Promise.reject(new r(`文章超出${s["b"]}字数限制`)):Promise.resolve()}checkHttpImage(t){const e=/<img[^>]*\bsrc="http:/.test(t.html||"");if(e){const t="图片地址必须为 HTTPS，请转存或替换内容中的非法图片地址";return Promise.reject(new r(t))}return Promise.resolve()}}class r extends Error{}},"2fe1":function(t,e,n){},"32a2":function(t,e,n){},3348:function(t,e,n){"use strict";var i=n("23c1"),s=n.n(i);s.a},"33f7":function(t,e,n){"use strict";n.r(e);var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"view"},[t.bookInfo?n("BookEditor",{attrs:{status:t.status},on:{update:t.update,publish:t.publish}}):t._e()],1)},s=[],a=n("964c"),r=function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.loadedSectionContent?n("div",{staticClass:"book-edit-view"},[n("EditorHeader",{ref:"header",attrs:{"section-html":t.sectionInfo,status:t.status},on:{titleSubmit:t.onTitleSubmit,update:t.requestUpdate,publish:t.publish}}),n("div",{staticClass:"edit-wrap"},[n("div",{directives:[{name:"show",rawName:"v-show",value:t.summaryExtended,expression:"summaryExtended"}],ref:"directory",staticClass:"directory-box"},[n("router-link",{staticClass:"summary",attrs:{tag:"div",to:t.toSummary}},[t._v(" 小册介绍 ")]),n("EditorDirectory",{staticClass:"editor-directory",on:{deleteSection:t.init}})],1),n("div",{staticClass:"edit-box",class:{extended:t.extended}},[n("Editor",{staticClass:"edit-box-bytemd",attrs:{mode:t.extended?"tab":"split",value:t.markdown,plugins:t.plugins,sanitize:t.sanitize,editorConfig:{placeholder:"开始写作"}},on:{change:t.handleChange}}),n("div",{staticClass:"footer"},[n("EditorFooter",{staticClass:"editor-footer",on:{uploadImage:t.openImageFileDialog}}),n("input",{ref:"fileInput",staticStyle:{display:"none"},attrs:{type:"file"},on:{input:t.handleFileInput}}),t.extended?t._e():n("PreviewFooter",{attrs:{wordCount:t.wordCount}})],1)],1)]),t.imageLoading?n("ImageUploadProgressPanel",{attrs:{text:"图片解析中...",allowCancel:!1}}):t._e()],1):t._e()},o=[],c=n("c34c"),l=n("cecb"),u=n("6a08"),d=n("3dc0"),h=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("header",{staticClass:"book-header"},[n("TitleInput",{staticClass:"title-input",attrs:{value:t.baseInfo.title},on:{input:t.onTitleUpdate,submit:function(e){return t.$emit("titleSubmit")}}}),n("div",{staticClass:"right-box"},[n("StatusText",{staticClass:"status-text with-padding",attrs:{status:t.status}}),n("Poster",{staticClass:"with-padding",attrs:{info:t.baseInfo}}),n("PublishPopup",{staticClass:"with-padding",attrs:{baseInfo:t.baseInfo},on:{publish:t.publish,updatePrice:t.updatePrice,updateIsFinished:t.updateIsFinished,updateFinishedAt:t.updateFinishedAt,updateProfile:t.updateProfile,updateDesc:t.updateDesc,updateCategoryId:t.updateCategoryId,updateXiaoceDraft:t.updateXiaoceDraft}}),n("MainNavigator")],1)],1)},f=[],p=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("input",{directives:[{name:"model",rawName:"v-model",value:t.innerValue,expression:"innerValue"}],ref:"input",staticClass:"title-input",attrs:{placeholder:"输入小册标题...",spellcheck:"false",maxlength:t.maxlength},domProps:{value:t.innerValue},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.$emit("submit")},input:function(e){e.target.composing||(t.innerValue=e.target.value)}}})},m=[],g=(n("3bba"),{props:["value"],data:()=>({maxlength:100,innerValue:""}),watch:{value:{handler(t,e){this.innerValue=t},immediate:!0},innerValue(t,e){this.$emit("input",t)}},mounted(){}}),b=g,v=(n("cde9"),n("2877")),_=Object(v["a"])(b,p,m,!1,null,"32795623",null),k=_.exports,y=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"main-image-selector",class:{active:t.active,unset:t.unset,updating:t.updating}},[n("div",{staticClass:"toggle-btn",on:{click:function(e){t.active=!t.active}}}),n("div",{directives:[{name:"show",rawName:"v-show",value:t.active,expression:"active"}],staticClass:"panel"},[n("div",{staticClass:"title"},[t._v("添加小册封面")]),n("div",{staticClass:"size"},[t._v("建议 650*910（ png 格式）")]),n("button",{directives:[{name:"show",rawName:"v-show",value:t.unset,expression:"unset"}],staticClass:"select-btn",attrs:{disabled:t.updating},on:{click:t.selectImageFile}}),n("div",{directives:[{name:"show",rawName:"v-show",value:!t.unset,expression:"!unset"}],staticClass:"preview-box"},[n("img",{staticClass:"preview-image",attrs:{src:t.thumbUrl}}),n("button",{staticClass:"delete-btn",attrs:{title:"移除这张图片"},on:{click:t.deleteImage}},[n("i",{staticClass:"ion-trash-a"})])])]),n("input",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],ref:"file",attrs:{type:"file"},on:{change:function(e){return t.onFileSelected(e)}}})])},C=[],w=n("a9cf"),x=n("5c91"),E={props:["info"],data:()=>({active:!1,updating:!1}),computed:{unset(){return!this.info.cover_img},prompt(){return this.updating?"封面设置中...":"点击此处添加图片"},thumbUrl(){const t=this.info.cover_img;return t?Object(x["b"])(t,480,480):""}},methods:{selectImageFile(){this.$refs.file.click()},onFileSelected({target:t}){const e=t.files[0];e&&(this.$refs.file.value=null,this.changeMainImage(e))},changeMainImage(t){return this.updating=!0,Object(u["b"])(this.info.user_id,[t]).then(t=>{this.info.cover_img=t[0]&&t[0].Url,this.info.change_field="cover_img",this.updating=!1}).catch(t=>{t.message=t.message||"头图设置失败",this.$error(t),this.updating=!1})},deleteImage(){return Object(w["a"])(this.info).then(()=>{this.info.cover_img=null,this.info.change_field="cover_img"})}},domEvents:{click({target:t}){this.$el.contains(t)||(this.active=!1)}}},O=E,j=(n("379b"),Object(v["a"])(O,y,C,!1,null,"729be267",null)),T=j.exports,S=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"publish-popup",class:{active:t.active,disabled:t.disabled}},[n("div",{staticClass:"toggle-btn",on:{click:function(e){t.active=!t.disabled&&!t.active}}},[n("span",{staticClass:"title"},[t._v(t._s(t.actionText))]),n("i",{staticClass:"icon",class:["ion-arrow-"+(t.active?"up":"down")+"-b"]})]),n("div",{directives:[{name:"show",rawName:"v-show",value:t.active,expression:"active"}],staticClass:"panel"},[n("div",{staticClass:"title"},[t._v(t._s(""+t.actionText))]),n("div",{staticClass:"summary-box"},[n("div",{staticClass:"sub-title"},[t._v("摘要")]),n("textarea",{directives:[{name:"model",rawName:"v-model",value:t.summary,expression:"summary"}],ref:"summaryTextarea",staticClass:"summary-textarea",attrs:{placeholder:"摘要将显示在小册详情页标题的下方，建议 100 字以内","max-length":"100"},domProps:{value:t.summary},on:{input:function(e){e.target.composing||(t.summary=e.target.value)}}})]),n("div",{staticClass:"category-box"},[n("div",{staticClass:"sub-title"},[t._v("分类")]),n("div",{staticClass:"category-list"},t._l(t.categoryList,(function(e){return n("div",{key:e.id,staticClass:"item",class:{active:t.currentCategoryId===e.category_id},on:{click:function(n){return t.updateCategory(e)}}},[t._v(" "+t._s(e.category_name)+" ")])})),0)]),n("label",{staticClass:"line-confirmation"},[n("input",{directives:[{name:"model",rawName:"v-model",value:t.consent,expression:"consent"}],attrs:{type:"checkbox"},domProps:{checked:Array.isArray(t.consent)?t._i(t.consent,null)>-1:t.consent},on:{change:function(e){var n=t.consent,i=e.target,s=!!i.checked;if(Array.isArray(n)){var a=null,r=t._i(n,a);i.checked?r<0&&(t.consent=n.concat([a])):r>-1&&(t.consent=n.slice(0,r).concat(n.slice(r+1)))}else t.consent=s}}}),n("div",{staticClass:"txt"},[n("span",[t._v("我已阅读同意")]),n("span",{staticClass:"agreement",on:{click:function(e){return e.preventDefault(),e.stopPropagation(),t.explainVisible("agreement")}}},[t._v(" 《掘金小册写作线上协议》 ")])])]),n("label",{staticClass:"line-confirmation"},[n("input",{directives:[{name:"model",rawName:"v-model",value:t.isFinished,expression:"isFinished"}],attrs:{disabled:t.completed,type:"checkbox"},domProps:{checked:Array.isArray(t.isFinished)?t._i(t.isFinished,null)>-1:t.isFinished},on:{change:function(e){var n=t.isFinished,i=e.target,s=!!i.checked;if(Array.isArray(n)){var a=null,r=t._i(n,a);i.checked?r<0&&(t.isFinished=n.concat([a])):r>-1&&(t.isFinished=n.slice(0,r).concat(n.slice(r+1)))}else t.isFinished=s}}}),t._m(0)]),n("button",{staticClass:"publish-btn",attrs:{disabled:t.submitDisabled},on:{click:t.publish}},[t._v(" "+t._s(t.actionText)+" ")])]),t.explainType?n("Explain",{attrs:{type:t.explainType},on:{close:function(e){t.explainType=""}}}):t._e(),t.visibleIsFinished?n("BookComplete",{on:{ok:t.ok,cancel:t.cancel}}):t._e()],1)},A=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"txt"},[n("span",[t._v("所有章节已完成")])])}],L=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"masker"},["earnings"==t.type?n("div",{staticClass:"earnings"},[n("div",{staticClass:"heading"},[t._v(" 收益与结算 "),n("span",{staticClass:"close",on:{click:function(e){return e.stopPropagation(),t.close(e)}}},[t._v("+")])]),n("div",{staticClass:"content"},[t._v(" 你的小册收益 ＝ 销量 × ( 单价 - 折扣 ) × 70% * 推广折扣：在推广期会有不同的优惠折扣，结算将按照折扣后的单价进行结算； * 结算日期：在所有章节写作完成后，每月 10 日进行结算； * 手续费：结账时会去除支付平台的手续费 0.6%； ")])]):t._e(),"agreement"==t.type?n("div",{staticClass:"agreement"},[n("div",{staticClass:"heading"},[t._v(" 掘金小册平台写作线上协议 "),n("span",{staticClass:"close",on:{click:function(e){return e.stopPropagation(),t.close(e)}}},[t._v("+")])]),n("div",{staticClass:"content",domProps:{innerHTML:t._s(t.agreement)}})]):t._e()])},I=[];const $='本协议系由北京北比信息技术有限公司（以下简称“北比”）与所有通过掘金小册平台发布作品的主体（以下简称“作者”）就资源的引入、使用及相关服务所订立的有效合约，所有作者必须同意并遵守本协议。作者通过作者发布程序阅读本协议并点击"同意"按钮或以任何方式参与数字作品提交均被视为作者完全接受本协议。\n\n一、总则\n1.1 本协议内容包括掘金小册与作者（线上）协议及所有北比已经发布的或将来可能发布的各类规则。所有规则为本协议不可分割的组成部分，与协议正文具有同等法律效力。\n1.2 双方承诺接受并遵守本协议的约定。本协议一经勾选“我已阅读并同意”后生效，北比有权随时对协议内容进行修订，修订后的协议将公布于掘金小册平台上，作者继续使用掘金小册，则视为对修订后的协议不持任何异议并同意遵守；如作者对协议存在异议，可以向北比书面提出退出掘金小册，但作者在北比确认其退出许可前的行为，仍受本协议约束。\n\n二、定义\n2.1 “掘金小册平台”（以下简称“掘金小册”）：是指由北比所有并运营的数字作品引入平台及各类客户端软件，供掘金小册的作者和用户发布或查询、使用数字作品。\n2.2 “数字作品”： 指作者通过掘金小册向用户提供的电子图书、文字作品、交流活动文字整理、图片、电子杂志，电子报纸、音频、视频等各类数字化作品，以及与数字作品相关的内容。就文字作品而言，包括标题、正文、附注等内容。\n2.3 “用户”：是指在掘金小册浏览、阅读、下载等使用数字作品的互联网用户和移动互联网用户。\n2.4 “注册”：是指作者登录掘金小册，按要求填写相关信息，在线申请其服务账户的过程。注册的作者必须是拥有合法的数字作品的实体，如作者违反本协议有关作者的规定或超越其民事权利能力或民事行为能力范围的，则本协议自始无效，一经发现，北比有权立即注销其服务账户，并追究其违约使用掘金小册服务的法律责任。\n\n三、平台模式\n3.1 北比向作者提供掘金小册及相关服务，使作者得以通过掘金小册发布数字作品及相关信息并接受用户对数字作品的浏览、阅读、下载或其他使用需求。\n3.2 自本协议生效后，作者免费授权北比在掘金小册上免费使用作者提供的数字作品，包括但不限于将作者数字作品在掘金小册上进行上传、复制、传输、通过信息网络传播、推广，供用户以搜索、浏览、阅读或者下载等方式使用；并授权北比将作者数字作品基于互联网或无线互联网形式面向全球用户进行推广。\n3.3 作者在未得到北比许可的情况下，不得授权第三方以任何形式传播作者在掘金小册上发布的数字作品。本规定在数字作品发布之日起一年后自动失效。\n\n四、所有权与知识产权\n北比保留对以下各项内容、信息完全的、不可分割的所有权及知识产权:\n（1）掘金小册及其所有组成元素，包括但不限于所有内容、数据、技术、软件、代码、用户界面以及与其相关的任何衍生作品；\n（2）作者向掘金小册提供的与该平台服务相关的任何信息及反馈（不包含作者向掘金小册提供的数字作品）。\n\n五、作者的权利与义务\n5.1 作者保证拥有所提供数字作品的完整版权与有效授权，有权授权北比在掘金小册上以本协议约定的方式使用授权作品。\n（1）对于非作者自有权利的数字作品，作者应当获得权利人的有效授权，确保作者有权通过掘金小册上传、复制、传输、通过信息网络传播、推广该等数字作品。作者确保其获得的授权可以使北比合法地通过掘金小册推广和按约使用数字作品。作者应自行向权利人支付可能存在的许可费用、版税以及其它应缴费用以获取权利人的有效授权。\n（2）对于作者自有权利的数字作品，作者签署本协议即代表作者免费授权北比通过掘金小册推广和按约使用数字作品，包括但不限于将数字作品存储于掘金小册提供的存储空间和通过掘金小册进行信息网络传播等。\n5.2 作者保证其所提供的全部作品（包括作品封面、图片、目录、正文内容、视频等）及在掘金小册上传的全部信息符合中国法律、法规及国家政策的规定，不含任何违法、违规内容。\n5.3 作者免费授予北比拥有全部授权作品及相关信息的信息网络传播权。根据上述授权，北比有权将作者授权使用的数字作品基于互联网或无线互联网在掘金小册及北比其它产品上进行传播或推广。\n5.4 作者保证本协议的签署和履行并不侵犯任何第三方权益，也不会被任何第三方追索；作者保证提供的数字作品不存在任何权利瑕疵，没有侵犯任何第三方的合法权益；作者对所提供数字作品资源内容的真实性、准确性、完整性、合法性等负完全责任；如北比被第三方主张权利而产生任何纠纷、仲裁、诉讼，或遭到国家相关部门处理，由作者出面解决，承担全部法律责任并使北比免责，并赔偿因上述原因给北比造成的全部直接和间接损失。\n5.5 作者应妥善保管自己的服务账户及密码信息，因作者自身原因丢失账户、密码或其他重要信息等，作者自行承担一切不利后果。严禁作者以任何形式擅自转让或授权他人使用自己的服务账户，一经发现，北比有权立即封禁该服务账户，并有权终止向作者提供本协议约定的服务而无须承担违约责任。\n5.6 作者承诺并完全同意：作者对其数字作品的上传、存储、传播等环节产生的后果独立承担全部法律责任。\n5.7 未经北比事先许可，作者不得在数字作品发布之日起一年内授予第三方传播其数字作品的权利。\n5.8 未经北比事先书面同意，作者不得使用北比的名义进行任何以营利为目的的商业活动或任何可能对北比的品牌造成不利影响的活动。\n5.9 未经北比事先书面许可，作者不得擅自删除、下线、中断或关闭其已向掘金小册提供的授权数字作品。\n5.10 如因作者提供给的数字作品的版权到期或作者权利授权方原因等导致该数字作品需要下线的，作者应提前30天以书面形式通知北比后，方可对相应数字作品进行下线处理。\n\n六、掘金小册的权利与义务\n6.1 北比负责对作者授权作品及相关信息在掘金小册及其它展示终端上的运营业务提供相关的技术支持与维护服务。\n6.2 北比可以根据国家法律法规及相关政策的规定，制定北比及掘金小册各项管理制度，对作者授权数字作品在掘金小册的上传、存储、通过信息网络传播、使用等行为进行规范；同时，对于违反国家法律、法规、规范性文件规定及其他不符合北比或掘金小册要求的数字作品，北比有权禁止该作品在掘金小册或其它北比产品上进行发布或展示。\n6.3 出于为用户提供更好阅读体验以及使作者作品在掘金小册上得到更好展示的目的，北比有权对作者授权在掘金小册上展示的数字作品的格式进行加工和制作及销售数字作品的权利。\n6.4 出于宣传或推广的目的，北比有权在授权范围内免费使用作者数字作品的片段（不超过原作品内容的30%）、作品名称、作品插图等，并授权北比及其关联公司对作者数字作品进行全文内容检索。同时，北比可为履行本协议目的，在掘金小册和其他媒介使用作者的商标、标识等知识产权，以说明作者参与本协议项下的情况。\n6.5 对于第三方侵犯本协议项下数字作品的侵权行为，作者授权北比有权独立采取包括但不限于诉讼、仲裁等各种法律手段维护自身的合法权益并获取相应收益，维权行为所发生的费用由北比独自承担。\n6.6 由于作者与第三方就数字作品版权出现争议导致阅读开放平台必须对该作品下线的，北比可予以配合，但作者应承担由此产生的全部责任以及给北比造成的全部损失。\n6.7 如作者数字作品或相关业务违反本协议约定，或造成掘金小册系统严重负担，或不符合北比或掘金小册相关制度规则，或其他有损北比或掘金小册利益的，北比有权不予上线或通知作者移除相关内容，作者应在接到通知后立刻移除，北比也可以不经通知自行移除数字作品，无需承担任何违约责任。\n6.8 本协议到期后，如作者并未主动下线或删除掘金小册上的数字作品，视为作者授权北比在平台上继续按本协议约定的方式使用其数字作品，授权期限直至作者主动删除或下线数字作品为止。\n\n七、隐私\n7.1 在收集、使用、共享或存储与任何用户相关的所有数据（包括但不限于任何用户信息）时，作者同意实施并遵守所适用的隐私和保密标准，这些标准至少与北比隐私政策中阐明的标准同等严格和对用户有利。\n7.2 为保护用户的隐私，并使用户能够控制对其数据隐私设置的访问，禁止作者将其访问或收集的与掘金小册用户相关的任何数据提供给任何第三方。作者据此同意遵守并且不以任何方式避开由北比设定的所有此类数据访问限制和用户选择的任何隐私设置。\n7.3 在北比提出要求时，作者应立即向北比提供相关用户信息，以便:\n(1)保护或维护北比或掘金小册或其员工、代理商等的合法权利或财产；\n(2)保护掘金小册服务的用户或公众的安全（包括在紧急情况下采取相应措施）；\n(3)防止欺诈行为或实现风险管理目的；\n(4)执行相关政府主管部门的要求、规定、命令等；\n(5)遵守法律或法定程序。\n\n八、信息披露与保密\n8.1 作者与北比关于重大信息的披露、采用、表述等均应获得双方的一致认可。作者可以宣传其已与掘金小册的事实与情况，但未经过北比事先书面同意，不得发布使用任何含有北比名称、商标、logo、标记等的新闻稿、其他宣传声明或推广材料。出于宣传或推广目的，北比有权发布、提及或描述掘金小册、掘金小册授权数字作品或作者的宣传和推广材料。\n8.2 北比或作者对于因签署或履行本协议而了解或接触到的对方的商业秘密及其他保密资料和信息（以下简称“保密信息”）均应保守秘密。除非国家法律法规、政府或者法院的要求，或者本协议双方同意，任何一方不得向任何第三方泄露、给予或转让该等保密信息。\n除为实现本协议项下约定之目的所必须外，未经对方事先书面同意，任何一方不得擅自使用、复制或擅自向任何第三方授权使用、授权复制对方的商标、标志、商业信息、技术及其他资料等。\n8.3 本保密条款不因本协议的无效、被撤销、解除、提前终止、不具操作性等而失效。\n\n九、免责声明\n9.1 本协议项下掘金小册将在现有技术的基础上尽最大努力提供相应的安全措施以保障服务安全和正常运行。但掘金小册明确声明对服务不作任何明示或暗示的保证，包括但不限于对服务的安全性、可靠性、持续性、准确性、适用于某一特定用途等。作者签署本协议即意味着理解且不要求北比或掘金小册在以下任一情况下承担责任：\n（1）不可抗力。不可抗力是指本协议双方不能合理控制、不可预见或即使预见亦无法避免的事件，包括但不限于政府行为、地震、台风、洪水、火灾或其它天灾、战争或任何其它类似事件。\n（2）鉴于互联网之特殊性质，不可抗力亦包括但不限于下列影响互联网正常运行之情形：\n（a）黑客攻击；\n（b）电信部门技术调整导致之重大影响；\n（c）因政府管制而造成之暂时关闭；\n（d）病毒侵袭；\n（e）网站升级、系统停机维护或通讯终端、电信设备出现故障导致无法进行数据传输；\n（f）其他非因双方原因导致互联网无法正常运行、服务中断或延迟之情形。\n（3）如发生不可抗力事件，遭受该事件的一方应立即以可能的最快捷的方式通知另一方该事件的性质、发生日期、预计持续时间等有关细节，以及该事件阻碍通知方履行其于本协议项下义务的程度。\n（4）在不可抗力事件持续期间，遭受不可抗力事件的一方应定期及时地告知另一方不可抗力事件的现状。如不可抗力事件结束，应立即以书面形式通知对方，并继续履行其于本协议项下之义务。\n（5）遭受不可抗力事件的一方应当向另一方提供事件发生地区的公证机构(或其他适当机构)出具的证实不可抗力事件的合法证明。\n（6）如果不可抗力事件持续超过九十（90）天，任何一方均可按本协议11.1之规定终止本协议。\n（7）本协议任何一方违约后遭遇不可抗力的，违约责任不因不可抗力而免除。\n9.2 北比有权在提前通知或不通知的情况下随时修改、限制、暂停或终止全部或部分掘金小册服务，对于此等修改、限制、暂停或终止行为，北比对作者或任何第三方不负任何责任。\n9.3 北比及其关联公司仅向作者及用户提供技术平台以便作者得以向通过信息网络传播、推广其授权数字作品，不对作者或用户的任何口头、书面陈述或者其向掘金小册上传的任何信息之真实性、合法性做任何担保，或对此承担任何责任。北比与掘金小册不对作者与用户之间达成的或涉及的法定义务或约定义务承担任何责任。北比与掘金小册亦无义务参与与数字作品使用有关的任何理赔、纠纷处理等活动。如因数字作品或其使用产生纠纷的，作者应以自己的名义独立承担所有法律责任。\n9.4 北比没有义务为作者保存其存储于掘金小册中的数据以及作者使用掘金小册产生的任何数据。作者应自行对相关数据进行定期保存。作者如因数据丢失造成损失或产生其他责任，北比及掘金小册均不负责承担。\n9.5 在任何情况下，北比、掘金小册及其董事、员工或代理人，均不负责对作者或任何第三方就任何法定或约定之损害承担责任，即使北比或掘金小册已经知道或已被告知发生了上述损害或上述损害发生的可能性。\n\n十、违约责任\n10.1 除本合同另有约定外，任何一方违反本合同约定的，应赔偿因此给另一方造成的经济损失。\n10.2 因作者所提供的数字作品存在权利瑕疵或侵犯任何第三方的合法权益、内容违法违规等导致北比或掘金小册损失或陷入诉讼、争议，或者受到国家有关部门的查处或处罚，应视为作者根本违约，由作者出面解决并承担全部责任。同时，北比有权单方解除本协议，终止提供本协议约定的服务。因此给北比造成损失的，作者应负责赔偿北比的全部损失，包括直接损失与其他合理损失。\n10.3 若双方均违反本协议之约定，则应当各自承担相应的责任。\n\n十一、协议期限与终止\n11.1 协议终止：发生以下任何事件时，经书面通知对方，任何一方均可立即终止本协议：\n（一）一方严重违反本协议，且对于可补救的违约，未在收到对方书面通知后三十（30）天内予以补救；\n（二）一方严重违约致使不能实现合同目的；\n（三）一方破产、无力偿债、进入清算或解散程序、不再从事业务或不能清偿到期债务；\n（四）按本协议第9.1条之约定，不可抗力事件发生并持续超过九十（90）天。\n';var D={props:["type"],data:()=>({agreement:$}),methods:{close(){this.$emit("close")}},mounted(){}},N=D,M=(n("6a2e"),Object(v["a"])(N,L,I,!1,null,"68554f33",null)),P=M.exports,U=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"masker"},[n("div",{staticClass:"dialog"},[n("div",{staticClass:"heading"},[t._v("确认所有章节写作已完成")]),n("div",{staticClass:"context"},[t._v(" 勾选“所有章节已完成”后，将会取消“预售”标记，并将所有文章展示给购买用户。 ")]),n("div",{staticClass:"footer"},[n("div",{staticClass:"cancel",on:{click:function(e){return e.stopPropagation(),t.cancel(e)}}},[t._v("取消")]),n("div",{staticClass:"ok",on:{click:function(e){return e.stopPropagation(),t.ok(e)}}},[t._v("确定")])])])])},R=[],F={methods:{ok(){this.$emit("ok")},cancel(){this.$emit("cancel")}},mounted(){}},H=F,B=(n("d87f"),Object(v["a"])(H,U,R,!1,null,"3b5264b9",null)),q=B.exports,z=(n("9b04"),n("7e48")),V={components:{BookComplete:q,Explain:P},props:["baseInfo","disabled"],data:()=>({explainType:"",active:!1,visibleIsFinished:!1,completed:!1,consent:!0,finishedAt:"",profile:"",summary:"",price:"",categoryList:[],isFinished:!1}),computed:{submitDisabled(){return this.disabled||!this.consent},isPublish(){return 0===this.baseInfo.status},actionText(){return this.isPublish?"提交审核":"更新"},currentCategoryId(){return this.baseInfo.category_id}},watch:{baseInfo:{handler(t){this.category_id=t.category_id,this.summary=t.summary,this.isFinished=t.is_finished,t.is_finished&&(this.completed=!0)},immediate:!0},isFinished(t){t?this.visibleIsFinished=!0:this.$emit("updateIsFinished",!1)},summary(t,e){t.length>100?(this.$alert("字数超出限制"),this.summary=e):this.$emit("updateDesc",t)},currentCategoryId(t){this.$emit("updateCategoryId",t)}},methods:{updateCategory(t){this.baseInfo.category_id=t.category_id,this.$emit("updateXiaoceDraft")},ok(){this.visibleIsFinished=!1,this.$emit("updateIsFinished",!0)},cancel(){this.visibleIsFinished=!1,this.isFinished=!1,this.$emit("updateIsFinished",!1)},explainVisible(t){this.explainType=t},publish(){this.baseInfo.title.trim()?this.$emit("publish"):this.$alert("请先填写标题")}},domEvents:{click({target:t}){this.$el.contains(t)||(this.active=!1)}},mounted(){Object(z["f"])().then(t=>{this.categoryList=t,this.baseInfo.category_id&&"0"!==this.baseInfo.category_id||(this.baseInfo.category_id=X(t).category_id)})}};function X(t){return t.filter(t=>"article"===t.category_url)[0]||t[0]}var G=V,W=(n("1bd3"),Object(v["a"])(G,S,A,!1,null,"4b535164",null)),Y=W.exports,K=n("8bb0"),J=n("e0a3");var Q={components:{TitleInput:k,StatusText:K["a"],Poster:T,PublishPopup:Y,MainNavigator:J["a"]},props:["sectionHtml","status"],computed:{info(){return this.$store.state.draft},baseInfo(){return this.info.booklet_draft}},methods:{updateXiaoceDraft(){this.$emit("update")},updateIsFinished(t){this.baseInfo.is_finished=t?1:0,this.baseInfo.change_field="is_finished"},updateFinishedAt(t){this.baseInfo.finishedAt=t},updatePrice(t){this.baseInfo.price=t},updateProfile(t){this.baseInfo.profile=t},updateDesc(t){this.baseInfo.summary=t,this.baseInfo.change_field="summary"},updateCategoryId(t){this.baseInfo.category_id=t,this.baseInfo.change_field="category_id"},onTitleUpdate(t){this.baseInfo.title=t,this.baseInfo.change_field="title"},publish(){this.$emit("publish")}}},Z=Q,tt=(n("e3ce"),Object(v["a"])(Z,h,f,!1,null,"d7112ab8",null)),et=tt.exports,nt=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"editor-footer",class:{extended:t.extended}},[i("button",{staticClass:"ctrl-btn summary-btn",attrs:{title:t.summaryExtended?"点击隐藏章节目录":"点击恢复章节目录"},on:{click:t.toggleSummaryLayout}},[i("pre",[t._v(t._s(t.summaryExtended))]),i("img",{directives:[{name:"show",rawName:"v-show",value:t.summaryExtended,expression:"summaryExtended"}],staticClass:"icon",attrs:{src:n("d24a")}}),i("img",{directives:[{name:"show",rawName:"v-show",value:!t.summaryExtended,expression:"!summaryExtended"}],staticClass:"icon",attrs:{src:n("d45d")}})]),i("button",{staticClass:"ctrl-btn shotcut-btn"},[i("img",{staticClass:"icon",attrs:{src:n("be86")}}),i("ShotcutPanel",{staticClass:"shotcut-panel"})],1),i("button",{staticClass:"ctrl-btn upload-image-btn",attrs:{title:"点击上传图片"},on:{click:t.uploadImage}},[i("img",{staticClass:"icon",attrs:{src:n("045f")}})]),i("button",{staticClass:"ctrl-btn toggle-layout-btn",attrs:{title:t.extended?"点击恢复预览区":"点击隐藏预览区"},on:{click:t.toggleLayout}},[i("img",{directives:[{name:"show",rawName:"v-show",value:t.extended,expression:"extended"}],staticClass:"icon",attrs:{src:n("077c")}}),i("img",{directives:[{name:"show",rawName:"v-show",value:!t.extended,expression:"!extended"}],staticClass:"icon",attrs:{src:n("cdb2")}})])])},it=[],st=function(){var t=this,e=t.$createElement;t._self._c;return t._m(0)},at=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"shotcut-panel"},[n("span",{staticClass:"panel-title"},[t._v("快捷键")]),n("a",{staticClass:"more-link",attrs:{href:"/book/5c90640c5188252d7941f5bb/section/5c9066395188252d71681c5d",target:"_blank"}},[t._v(" 更多语法 ")]),n("table",{staticClass:"shotcut-table"},[n("thead",[n("tr",[n("th",[t._v("Markdown")]),n("th",[t._v("结果")]),n("th",[t._v("快捷键")])])]),n("tbody",[n("tr",[n("td",[t._v("# 标题")]),n("td",[t._v("H1")]),n("td")]),n("tr",[n("td",[t._v("## 标题")]),n("td",[t._v("H2")]),n("td",[t._v("Ctrl / ⌘ + H")])]),n("tr",[n("td",[t._v("**文本**")]),n("td",[n("b",[t._v("粗体")])]),n("td",[t._v("Ctrl / ⌘ + B")])]),n("tr",[n("td",[t._v("[描述](http://)")]),n("td",[n("a",[t._v("链接")])]),n("td",[t._v("Ctrl / ⌘ + K")])]),n("tr",[n("td",[t._v("`code`")]),n("td",[n("code",[t._v("Inline Code")])]),n("td",[t._v("Ctrl / ⌘ + Shift + K")])]),n("tr",[n("td",[t._v("```code```")]),n("td",[n("pre",[t._v("Code")])]),n("td",[t._v("Ctrl / ⌘ + Shift + C")])]),n("tr",[n("td",[t._v("![alt](http://)")]),n("td",[t._v("图片")]),n("td",[t._v("Ctrl / ⌘ + Shift + I")])]),n("tr",[n("td",[t._v("* item")]),n("td",[t._v("列表")]),n("td",[t._v("Ctrl / ⌘ + Shift + L")])])])])])}],rt=(n("268c"),{}),ot=Object(v["a"])(rt,st,at,!1,null,"137daaa3",null),ct=ot.exports,lt={components:{ShotcutPanel:ct},computed:{summaryExtended(){return"extended"===this.$store.getters.XIAOCE_SUMMARY_LAYOUT},extended(){return"extended"===this.$store.getters.XIAOCE_LAYOUT}},methods:{toggleSummaryLayout(){this.$store.dispatch(this.$store.types.TOGGLE_XIAOCE_SUMMARY_LAYOUT)},toggleLayout(){this.$store.dispatch(this.$store.types.TOGGLE_XIAOCE_LAYOUT)},uploadImage(){this.$emit("uploadImage")}}},ut=lt,dt=(n("2df9"),Object(v["a"])(ut,nt,it,!1,null,"02414ea8",null)),ht=dt.exports,ft=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"editor-directory"},[n("draggable",{ref:"list",staticClass:"list",class:{dragging:t.dragging},attrs:{id:"list",element:"div",options:t.dragOptions,move:t.onMove},on:{start:t.draggingStart,update:t.draggingUpdate},model:{value:t.listArr,callback:function(e){t.listArr=e},expression:"listArr"}},[n("transition-group",{staticClass:"list-transition",attrs:{type:"transition",name:"list",tag:"div"}},t._l(t.listArr,(function(e,i){return n("item",{key:i,attrs:{section:e,index:i,activeIndex:t.activeIndex},on:{setFreeSection:t.setFreeSection,setFinished:t.setFinished,changeSection:t.changeSection,updateActiveIndex:t.onUpdateActiveIndex}})})),1)],1),n("button",{staticClass:"btn-section",on:{click:function(e){return e.stopPropagation(),t.changeSection(null,t.listArr.length,"add")}}},[t._v(" 添加章节 ")]),t.isHedingType?n("HeadingPopup",{attrs:{type:t.hedingType,heading:t.sectionHeading,order:t.headingIndex},on:{update:t.updateHeading,delete:t.deleteHeading,add:t.addHeading,cancel:function(e){t.hedingType=null}}}):t._e()],1)},pt=[],mt=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"section-item"},[i("router-link",{staticClass:"item",attrs:{tag:"div",to:t.routeXiaoce(t.section)}},[i("div",{staticClass:"item-cont"},[i("div",{staticClass:"order"},[t._v(t._s(t.index+1)+".")]),i("div",{staticClass:"title"},[i("div",{staticClass:"text"},[t._v(t._s(t.section.draft_title||t.defaultText))]),t.section.is_free?i("div",{staticClass:"to-read"},[t._v("试读")]):t._e()])]),i("div",{staticClass:"bar"},[i("img",{attrs:{src:n("bf5f")}})]),i("div",{staticClass:"more"},[i("div",{staticClass:"toggle-btn",on:{click:function(e){return e.stopPropagation(),e.preventDefault(),t.toggleVisibleDropdown(t.index)}}},[i("img",{attrs:{src:n("8aea")}})])]),t.confirmComplete?i("SectionDone",{on:{ok:t.ok,cancel:t.cancel}}):t._e()],1),i("div",{directives:[{name:"show",rawName:"v-show",value:t.activeIndex===t.index,expression:"activeIndex === index"}],staticClass:"menu"},[i("span",[t._v(t._s(t.index))]),i("div",{on:{click:function(e){return e.stopPropagation(),t.changeSection(t.section,t.index,"update")}}},[t._v(" 修改标题 ")]),t.section.is_free?t._e():i("div",{on:{click:function(e){return e.stopPropagation(),t.setFreeSection(t.section,t.index,1)}}},[t._v(" 设置为试读 ")]),t.section.is_free?i("div",{on:{click:function(e){return e.stopPropagation(),t.setFreeSection(t.section,t.index,0)}}},[t._v(" 取消试读 ")]):t._e(),i("div",[i("label",[i("span",[t._v("本章节已完成")]),i("input",{directives:[{name:"model",rawName:"v-model",value:t.section.status,expression:"section.status"}],staticClass:"check",attrs:{type:"checkbox",disabled:t.checked},domProps:{checked:Array.isArray(t.section.status)?t._i(t.section.status,null)>-1:t.section.status},on:{change:function(e){var n=t.section.status,i=e.target,s=!!i.checked;if(Array.isArray(n)){var a=null,r=t._i(n,a);i.checked?r<0&&t.$set(t.section,"status",n.concat([a])):r>-1&&t.$set(t.section,"status",n.slice(0,r).concat(n.slice(r+1)))}else t.$set(t.section,"status",s)}}})])]),i("div",{on:{click:function(e){return e.stopPropagation(),t.changeSection(t.section,t.index,"delete")}}},[t._v("删除")])])],1)},gt=[],bt=n("8690"),vt=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"masker"},[n("div",{staticClass:"dialog"},[n("div",{staticClass:"heading"},[t._v("确认章节写作完成")]),n("div",{staticClass:"context"},[t._v(" 标记本章节完成后，将会给用户发送更新通知，通知只可发送一次，并且不可撤销，请谨慎操作。 ")]),n("div",{staticClass:"footer"},[n("div",{staticClass:"cancel",on:{click:function(e){return e.stopPropagation(),t.cancel(e)}}},[t._v("取消")]),n("div",{staticClass:"ok",on:{click:function(e){return e.stopPropagation(),t.ok(e)}}},[t._v("确定")])])])])},_t=[],kt={methods:{ok(){this.$emit("ok")},cancel(){this.$emit("cancel")}}},yt=kt,Ct=(n("fa05"),Object(v["a"])(yt,vt,_t,!1,null,"5163d350",null)),wt=Ct.exports,xt={props:["section","index","activeIndex"],data:()=>({defaultText:"小册章节标题",confirmComplete:!1,checked:!1}),components:{SectionDone:wt},watch:{"section.status"(t){!0===t?this.confirmComplete=!0:!1===t&&this.$emit("setFinished",this.section,this.index,0)}},methods:{ok(){this.confirmComplete=!1,this.$emit("updateActiveIndex",null),this.$emit("setFinished",this.section,this.index,1)},cancel(){this.confirmComplete=!1,this.section.status=0,this.$emit("updateActiveIndex",null),this.$emit("setFinished",this.section,this.index,0)},routeXiaoce(t){let e=this.$route.name,n=this.$route.params.id,i=t.section_id,s={name:e,params:{id:n,sectionId:i}};return s},toggleVisibleDropdown(t){this.$emit("updateActiveIndex",this.activeIndex===t?null:t)},changeSection(t,e,n){this.$emit("changeSection",t,e,n),this.toggleVisibleDropdown(e)},setFreeSection(t,e,n){this.$emit("setFreeSection",t,e,n),this.toggleVisibleDropdown(e)}},mounted(){this.checked=1===this.section.status,this.removeEventListener=Object(bt["f"])(document,"click",t=>{this.$emit("updateActiveIndex",null)})},beforeDestroy(){this.removeEventListener()}},Et=xt,Ot=(n("c019"),Object(v["a"])(Et,mt,gt,!1,null,"3dd4fdd2",null)),jt=Ot.exports,Tt=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"heading-popup"},[n("div",{staticClass:"heading-box"},[t.headingTypeIsDelete?t._e():n("div",{staticClass:"title"},[t._v("输入章节标题")]),t.headingTypeIsDelete?n("div",{staticClass:"title"},[t._v("删除章节")]):t._e(),t.headingTypeIsDelete?n("div",{staticClass:"heading-input"},[t._v(" 此操作将删除该章节的内容，不可恢复，确定删除吗? ")]):n("div",{staticClass:"heading-input"},[n("div",{staticClass:"order"},[t._v(t._s(t.order+1)+".")]),n("input",{directives:[{name:"model",rawName:"v-model",value:t.headingObj.draft_title,expression:"headingObj.draft_title"}],ref:"headingInput",domProps:{value:t.headingObj.draft_title},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.check(e)},input:function(e){e.target.composing||t.$set(t.headingObj,"draft_title",e.target.value)}}})]),n("div",{staticClass:"heading-bar"},[n("button",{staticClass:"cancel",on:{click:t.cancel}},[t._v("取消")]),n("button",{staticClass:"submit",on:{click:t.check}},[t._v("确定")])])])])},St=[],At={props:["type","heading","order"],data:()=>({headingObj:{draft_title:"",section_id:null}}),computed:{headingTypeIsDelete(){return"delete"===this.type}},watch:{"headingObj.draft_title"(t,e){t.length>100&&(this.$alert("字数超出限制"),this.headingObj.draft_title=e)}},methods:{check(){let t=this.type;"update"===t?this.$emit("update",this.headingObj):"delete"===t?this.$emit("delete",this.headingObj):this.$emit("add",this.headingObj)},cancel(){this.$emit("cancel")}},mounted(){this.headingTypeIsDelete||this.$refs.headingInput.focus(),this.headingObj=Object.assign(this.headingObj,this.heading)}},Lt=At,It=(n("de99"),Object(v["a"])(Lt,Tt,St,!1,null,"5905329c",null)),$t=It.exports,Dt=n("1516"),Nt=n.n(Dt);const Mt="draft/UPDATE_STATE";var Pt={components:{draggable:Nt.a,Item:jt,HeadingPopup:$t},data:()=>({activeIndex:null,dragging:!1,hedingType:null,sectionHeading:null,headingIndex:0,canMove:!0,editable:!1,delayedDragging:!1,isDragging:!1}),computed:{info(){return this.$store.state.draft},listArr:{get(){return this.info.sections.filter(t=>null!==t)},set(t){return t}},isHedingType(){return this.hedingType},bookId(){return this.$route.params.id},dragOptions(){return{draggable:".section-item",handle:".bar",animation:150,group:"description",ghostClass:"ghost"}}},watch:{isDragging(t){this.delayedDragging=!0,this.$nextTick(()=>{this.delayedDragging=!1})}},methods:{updateState(t){this.$store.commit(Mt,{...this.info,...t})},onUpdateActiveIndex(t){this.activeIndex=t},setFreeSection(t,e,n){Object(z["i"])({section_id:t.section_id,is_free:n,change_field:"is_free"}).then(i=>{this.listArr[e]={...t,is_free:n},this.updateState({sections:this.listArr})}).catch(t=>{this.$alert(t)})},setFinished(t,e,n){Object(z["i"])({section_id:t.section_id,status:n,change_field:"status"}).then(i=>{this.listArr[e]={...t,status:n},this.updateState({sections:this.listArr})}).catch(t=>{this.$alert(t)})},changeSection(t,e,n){this.sectionHeading=t,this.headingIndex=e,this.hedingType=n},deleteHeading(t){this.hedingType=null;let e=this.handleleSectionInfo("del",t);Object(z["i"])({...e,status:-1,change_field:"status"}).then(t=>{this.listArr.splice(this.headingIndex,1);let e=this.bookId;this.$store.commit(Mt,{...this.info,sections:[...this.listArr]}),this.$router.push({name:"bookEditor",params:{id:e}}),this.$emit("deleteSection")})},addHeading(t){this.hedingType=null;let e=this.handleleSectionInfo("add",t);Object(z["a"])(e).then(t=>{e={...e,...t},this.listArr.push(e),this.$store.commit(Mt,{...this.info,sections:[...this.listArr]}),this.$router.replace({params:{sectionId:e.section_id}})})},updateHeading(t){this.hedingType=null;let e=this.handleleSectionInfo("update",t);Object(z["i"])({...e,change_field:"title"}).then(e=>{this.listArr.splice(this.headingIndex,1,t),this.$store.commit(Mt,{...this.info,sections:[...this.listArr]})})},handleleSectionInfo(t,e){let n=this.bookId,i=e.draft_title,s=e.section_id,a=e.is_free||0,r=e.status||0,o={};return"add"===t?o={booklet_id:n,title:i,status:r}:"update"===t?o={section_id:s,title:i,is_free:a}:"del"===t&&(o={booklet_id:n,section_id:s,status:r}),o},draggingStart(){this.dragging=!0},draggingUpdate(t){this.dragging=!1;let e=this.bookId;const{newIndex:n,oldIndex:i}=t,s=this.listArr.splice(i,1)[0];this.listArr.splice(n,0,s);let a=this.listArr.map(t=>t.section_id);a.unshift(this.info.introduction.section_id),a=a.join("|"),this.canMove=!1,Object(z["h"])({booklet_id:e,section_ids:a,change_field:"section_ids"}).then(t=>{this.canMove=!0,this.updateState({sections:this.listArr})}).catch(()=>{this.canMove=!0})},onMove(){return this.canMove}},created(){}},Ut=Pt,Rt=(n("2fa5"),Object(v["a"])(Ut,ft,pt,!1,null,"67dafbc2",null)),Ft=Rt.exports,Ht=n("1b28"),Bt=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"preview-footer"},[n("div",{staticClass:"title"},[t._v("预览")]),n("div",{staticClass:"word-count"},[t._v(t._s(t.displayWordCount))])])},qt=[],zt={props:["wordCount"],computed:{displayWordCount(){return this.wordCount?this.wordCount+" 字":"字数"}}},Vt=zt,Xt=(n("f1da"),Object(v["a"])(Vt,Bt,qt,!1,null,"c40dbd8c",null)),Gt=Xt.exports,Wt=n("64ed"),Yt=n("ea37"),Kt=n("6b53"),Jt={components:{EditorHeader:et,EditorDirectory:Ft,Editor:d["Editor"],EditorFooter:ht,MainNavigator:J["a"],PreviewFooter:Gt,ImageUploadProgressPanel:Kt["a"]},data(){const t=this;return{imageLoading:!1,sectionInfo:null,loadedSectionContent:!1,plugins:[...Ht["b"],{editorEffect:({editor:t})=>{this.cm=t}},Object(Ht["c"])({onLoadingChange(e){t.imageLoading=e},catchError(){t.$error("图片地址解析失败")}})],markdown:""}},props:["status"],computed:{info(){return this.$store.state.draft},wordCount(){return Object(Yt["b"])(this.markdown)},bookId(){return this.$route.params.id},sectionId(){return this.$route.params.sectionId},extended(){return"extended"===this.$store.getters.XIAOCE_LAYOUT},summaryExtended(){return"extended"===this.$store.getters.XIAOCE_SUMMARY_LAYOUT},isDraft(){return!this.info.isPublish},toSummary(){let t="summary";return{params:{sectionId:t}}},notNeedConfirmedUpdate(){return[this.info.booklet_draft.title,this.info.booklet_draft.cover_img,this.info.booklet_draft.summary,this.info.booklet_draft.summaryHtml,this.info.booklet_draft.is_finished]}},watch:{$route(){this.getXiaoceSection()},markdown(){this.requestSectionUpdate()},notNeedConfirmedUpdate(){this.requestUpdate()}},methods:{sanitize(t){const e=JSON.parse(JSON.stringify(t));return e.tagNames.push("section","video","source"),e.attributes.video=["controls","src"],e.attributes.source=["src"],e.attributes.div.push("data*"),e},async handleFileInput(t){try{const e=t.target,n=this.cm;if(!e.files||!e.files.length)return;const i=e.files[0],s=await this.fileHandler(i),a=n.getSelection();n.replaceSelection(`![${a}](${s})`),n.focus()}catch(e){this.$error(e)}},openImageFileDialog(){this.$refs.fileInput.click()},onTitleSubmit(){},handleChange(t){this.markdown=t},sectionUpdate(){const t=this.sectionId,e=this.markdown,n=Object(Wt["getProcessor"])({plugins:Ht["d"],sanitize:this.sanitize}).processSync(e).toString();Object(z["i"])({section_id:"summary"===t?this.info.introduction.section_id:t,content:n,markdown_content:e,change_field:"content"}).then(t=>{0!==t.err_no&&this.$error(t.err_msg||"请稍后再试")})},handleUpdate(){},async fileHandler(t){const e=await Object(u["b"])("",[t]);return e[0].Url},getXiaoceSection(){let t="summary"===this.sectionId?this.info.introduction.section_id:this.sectionId;Object(z["e"])({section_id:t}).then(t=>{const e=t.section,{markdown_content:n,draft_content:i}=e;this.sectionInfo=e,this.loadedSectionContent=!0,this.$nextTick(()=>{this.markdown=n})}).catch(()=>{this.loadedSectionContent=!0}).finally(()=>{this.cm&&this.cm.focus()})},init(){this.sectionId||this.$router.push({name:"bookEditor",params:{id:this.bookId,sectionId:"summary"}}),this.getXiaoceSection()},update(){this.$emit("update")},publish(){this.$emit("publish")},updateInfo(t){this.$emit("updateInfo",t)}},created(){this.requestUpdate=Object(c["a"])(()=>{this.update()},l["a"]),this.requestSectionUpdate=Object(c["a"])(()=>{this.sectionUpdate()},l["a"])},mounted(){this.$store.state;this.init()}},Qt=Jt,Zt=(n("0506"),n("bc2f"),n("7a82"),n("3cbf"),Object(v["a"])(Qt,r,o,!1,null,"de70aeac",null)),te=Zt.exports;n("e37c");const ee="## 作者介绍\n\n## 小册介绍\n\n## 你会学到什么？ \n\n## 适宜人群\n\n## 购买须知\n\n1. 本小册为图文形式内容服务，共计 N 节；\n2. 全部文章预计 x 月 x 日更新完成；\n3. 购买用户可享有小册永久的阅读权限；\n4. 购买用户可进入小册微信群，与作者互动；\n5. 掘金小册为虚拟内容服务，一经购买成功概不退款；\n6. 掘金小册版权归北京北比信息技术有限公司所有，任何机构、媒体、网站或个人未经本网协议授权不得转载、链接、转贴或以其他方式复制发布/发表，违者将依法追究责任；\n7. 在掘金小册阅读过程中，如有任何问题，请邮件联系 xiaoce@xitu.io",ne="draft/UPDATE_STATE";var ie={components:{BookEditor:te},data:()=>({bookInfo:null,summaryDefaultText:ee,status:""}),computed:{xiaoceInfo(){return this.$store.state.draft}},methods:{init(){const t=this.$route.params.id;this.initXiaoce(t);let e=a["a"]("xiaoceLayout"),n=a["a"]("xiaoceSummaryLayout");e||this.$store.dispatch(this.$store.types.TOGGLE_XIAOCE_LAYOUT),n||this.$store.dispatch(this.$store.types.TOGGLE_XIAOCE_SUMMARY_LAYOUT)},initXiaoce(t){"new"===t?this.addXiaoce():this.getXiaoce()},addXiaoce(){Object(z["b"])().then(t=>{let{booklet_id:e}=t;this.$router.replace({params:{id:e}})}).then(t=>{this.init()})},getXiaoce(){const t=this.$route.params.id;Object(z["c"])({booklet_id:t}).then(t=>{this.$store.commit(ne,t),this.bookInfo=t})},update(){this.status="saving";const{booklet_draft:t}=this.bookInfo;return Object(z["h"])(t).then(()=>{this.status="editing"}).catch(t=>{this.status="error",this.$error(t)})},publish(){this.status="saving";const{booklet_draft:t}=this.bookInfo;Object(z["g"])(t).then(()=>{this.status="editing";let e=t.booklet_id;window.location.href="/book/"+e}).catch(t=>{this.status="error",this.$error(t)})}},metaInfo(){return{title:"写小册 - 掘金"}},preFetch(t){},mounted(){this.init()},beforeDestroy(){}},se=ie,ae=(n("759c"),Object(v["a"])(se,i,s,!1,null,"547f6410",null));e["default"]=ae.exports},3595:function(t,e,n){"use strict";var i=n("95c6"),s=n.n(i);s.a},"35a6":function(t,e,n){},"35ca":function(t,e,n){t.exports=n.p+"img/md.555fde04.svg"},"379b":function(t,e,n){"use strict";var i=n("1575"),s=n.n(i);s.a},"37c5":function(t,e,n){},3828:function(t,e,n){"use strict";var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"rich-text-editor",attrs:{"st:block":"richTextEditor"}},[n("EditorHeader",{ref:"header",attrs:{guided:t.guided,post:t.post,status:t.status},on:{publish:t.publish}}),n("div",{staticClass:"main"},[n("TitleInput",{staticClass:"title-input",on:{submit:t.onTitleSubmit},model:{value:t.post.title,callback:function(e){t.$set(t.post,"title",e)},expression:"post.title"}}),n("div",{ref:"content",staticClass:"rich-text-editor-content"})],1),n("CodeLangSelector",{ref:"codeLangSelector",on:{update:t.updatePost}}),n("LinkDialog",{ref:"linkDialog",on:{update:t.updateLink}}),t.isImageUploading?n("ImageUploadProgressPanel",{on:{cancel:t.cancelImageUpload}}):t._e(),n("ImageSizeAlert",{ref:"imageSizeAlert"})],1)},s=[],a=(n("e022"),n("705e")),r=n("c34c"),o=n("8690"),c=n("cecb"),l=n("6a08"),u=n("673f"),d=n.n(u),h=n("7a61"),f=n("c901");n("77f5");class p{constructor(){Object.assign(this,{text:"输入正文...",hideOnClick:!0})}}n("6f6b");const m=800;class g{constructor(){Object.assign(this,{allowMultiParagraphSelection:!0,firstButtonClass:"medium-editor-button-first",lastButtonClass:"medium-editor-button-last",relativeContainer:document.body,standardizeSelectionStart:!1,static:!0,updateOnEmptySelection:!0,buttons:[{name:"formatBold",aria:"",contentDefault:'<i class="bold-icon icon"></i>',attrs:{"data-tooltip":"粗体（⌘ + B）","data-tooltip-delay":m,"data-shotcut":"command + b, ctrl + b"}},{name:"italic",aria:"",contentDefault:'<i class="italic-icon icon"></i>',attrs:{"data-tooltip":"斜体（⌘ + I）","data-tooltip-delay":m,"data-shotcut":"command + i, ctrl + i"}},{name:"underline",aria:"",contentDefault:'<i class="underline-icon icon"></i>',attrs:{"data-tooltip":"下划线（⌘ + U）","data-tooltip-delay":m,"data-shotcut":"command + u, ctrl + u"}},{name:"h2",aria:"",contentDefault:'<i class="h1-icon icon"></i>',attrs:{"data-tooltip":"标题一","data-tooltip-delay":m}},{name:"h3",aria:"",contentDefault:'<i class="h2-icon icon"></i>',attrs:{"data-tooltip":"标题二","data-tooltip-delay":m}},{name:"quote",aria:"",contentDefault:'<i class="quote-icon icon"></i>',attrs:{"data-tooltip":"引语","data-tooltip-delay":m}},{name:"formatHighlight",aria:"",contentDefault:'<i class="highlight-icon icon"></i>',attrs:{"data-tooltip":"代码块","data-tooltip-delay":m}},{name:"formatCode",aria:"",contentDefault:'<i class="code-icon icon"></i>',attrs:{"data-tooltip":"行内代码","data-tooltip-delay":m}},{name:"formatUnorderedList",aria:"",contentDefault:'<i class="unordered-list-icon icon"></i>',attrs:{"data-tooltip":"无序列表","data-tooltip-delay":m}},{name:"formatOrderedList",aria:"",contentDefault:'<i class="ordered-list-icon icon"></i>',attrs:{"data-tooltip":"有序列表","data-tooltip-delay":m}},{name:"formatLink",aria:"",contentDefault:'<i class="link-icon icon"></i>',attrs:{"data-tooltip":"链接（⌘ + K）","data-tooltip-delay":m,"data-shotcut":"command + k, ctrl + k"}},{name:"uploadImage",aria:"",contentDefault:'<i class="upload-image-icon icon"></i>',attrs:{"data-tooltip":"插入图片","data-tooltip-delay":m}}]})}}class b{constructor(){Object.assign(this,{tagList:["img","svg"]})}}const v={PRE:{excludeActionList:["formatHighlight"]}};class _{constructor(){Object.assign(this,{interceptor(t,e,n){k(e)&&(t.preventDefault(),t.stopPropagation())}})}}function k(t){const e=C(y(),Object.keys(v)),n=v[e];return!(!n||!n.excludeActionList)&&-1===n.excludeActionList.indexOf(t)}function y(){const t=window.getSelection();return t.rangeCount?t.getRangeAt(0).endContainer:null}function C(t,e){while(t){if(-1!==e.indexOf(t.nodeName))return t.nodeName;t=t.parentNode}return null}class w{constructor(){Object.assign(this,{interceptor(t){const e=x(),n=E(e);if(n)return e.isFocusOnEnd?this.pasteHTML("\n\n"):this.pasteHTML("\n"),!1}})}}function x(){const t=window.getSelection();if(!t.rangeCount)return null;const e=t.getRangeAt(0),n=e.endContainer;return n.isFocusOnEnd=3===n.nodeType&&n.length===e.endOffset,n}function E(t){while(t){if("PRE"===t.nodeName)return t;t=t.parentNode}return null}var O=n("453e");class j extends O["a"]{constructor(){super({maxSize:5242880,validTypeList:["jpg","png","gif","webp"]})}}class T{constructor(){Object.assign(this,{validate:t=>(new j).validate(t)})}}class S{constructor(){Object.assign(this,{cleanAttrs:[],doPaste(t,e){const n=this.base.getExtensionByName("clipboard");n.handlePaste(t,e)}})}}class A{constructor(){Object.assign(this,{spellcheck:!1,anchorPreview:!1,imageDragging:!1,keyboardCommands:!1,placeholder:new p,toolbar:new g,clickSelect:new b,buttonInterceptor:new _,newLineInterceptor:new w,uploadImage:new T,paste:new S})}}n("15b4");var L=d.a.Extension.extend({name:"toolbarTooltip",init(){d.a.Extension.prototype.init.apply(this,arguments),this.initToolbarTooltip()},initToolbarTooltip(){this.on(document.body,"mouseenter",(function({target:t}){M(t)&&I(t)}),!0),this.on(document.body,"mouseleave",(function({target:t}){M(t)&&$(t)}),!0)}});function I(t){const e=window.setTimeout((function(){const e=D(t);if(!e)return;const n=P(e);document.body.appendChild(n),U(n,t),t._releaseTooltip=function(){n.parentNode.removeChild(n)}}),N(t));t._releaseTooltip=function(){window.clearTimeout(e)}}function $(t){t._releaseTooltip&&t._releaseTooltip()}function D(t){return t.getAttribute("data-tooltip")}function N(t){return t.getAttribute("data-tooltip-delay")||0}function M(t){return t.classList.contains("medium-editor-action")}function P(t){const e=document.createElement("div");return e.classList.add("medium-editor-action-tooltip"),e.appendChild(document.createTextNode(t)),e}function U(t,e){const n=e.getBoundingClientRect(),i=n.left+n.width/2,s=n.bottom;t.style.left=i+"px",t.style.top=s+"px",t.classList.add("active")}var R=d.a.extensions.button.extend({name:"uploadImage",action:"uploadImage",contentDefault:"<b>IMG</b>",inputElement:null,uploadTask:null,validate:()=>Promise.resolve(),init(){d.a.Extension.prototype.init.apply(this,arguments),Object.assign(this,this.getEditorOption(this.name)),Object.assign(this,this.getButtonOption()),d.a.extensions.button.prototype.init.apply(this,arguments),this.initUploadImage()},initUploadImage(){this.prepareInputElement(),this.subscribeCancelEvent(),this.initDropEventListener()},destroy(){this.inputElement.parentNode.removeChild(this.inputElement)},getButtonOption(){return((this.getEditorOption("toolbar")||{}).buttons||[]).filter(t=>t.name===this.name)[0]},subscribeCancelEvent(){this.subscribe("cancelImageUpload",()=>{this.uploadTask&&this.uploadTask.abort()})},initDropEventListener(){this.on(document,"drop",t=>{t.preventDefault();const e=t.dataTransfer.files[0];e&&this.uploadImageFile(e)},!0),this.on(document,"dragover",t=>{t.preventDefault(),t.dataTransfer.dropEffect="copy"},!0)},prepareInputElement(){const t=document.createElement("input");t.setAttribute("type","file"),t.style.display="none",document.body.appendChild(t),this.inputElement=t,this.on(t,"change",({target:t})=>{const e=t.files[0];e&&(t.value=null,this.uploadImageFile(e))})},handleClick(){this.openFileDialog()},openFileDialog(){this.inputElement.click()},uploadImageFile(t){Object(l["b"])("",[t]).then(t=>{const e=t[0]&&t[0].Url;this.addImageToContent(e),this.trigger("imageUploadSuccess",e)}).catch(t=>{t.message=t.aborted?"上传已取消":t.message||"图片上传失败",this.trigger("imageUploadFailed",t)})},validateImageFile(t){return this.validate(t).then(()=>t)},isFocus(){return!!this.base.getFocusedElement()},addImageToContent(t){const e=`<p><img src="${t}"><br></p>`;this.isFocus()?(this.base.execAction("insertHTML","<p><br></p>"),this.base.pasteHTML(e),this.base.execAction("insertHTML","<p><br></p>")):this.base.setContent(this.base.getContent()+e)}}),F=d.a.Extension.extend({name:"clickSelect",init(){d.a.Extension.prototype.init.apply(this,arguments),this.initClickSelect()},initClickSelect(){const t=(this.getEditorOption(this.name)||{}).tagList;t&&t.length&&this.getEditorElements().forEach(e=>{this.on(e,"click",e=>{H(e.target,t)&&(e.preventDefault(),this.selectElement(e.target))},!0)})},selectElement(t){const e=window.getSelection(),n=document.createRange();n.selectNode(t),e.removeAllRanges(),e.addRange(n)}});function H(t,e){return-1!==e.indexOf(t.tagName.toLowerCase())}var B=d.a.Extension.extend({name:"state",init(){d.a.Extension.prototype.init.apply(this,arguments),this.subscribe("checkState",this.check.bind(this))},check(){this.base.checkContentChanged(),this.base.getExtensionByName("toolbar").checkState()}}),q=d.a.Extension.extend({name:"buttonInterceptor",interceptor(){},init(){d.a.Extension.prototype.init.apply(this,arguments),this.initButtonInterceptor()},initButtonInterceptor(){this.applyOption(),this.addEventListener()},applyOption(){Object.assign(this,this.getEditorOption(this.name))},addEventListener(){this.on(document.body,"click",this.clickHandler.bind(this),!0)},clickHandler(t){const e=z(t.target,this.getEditorId()),n=e?e.getAttribute("data-action"):null;e&&this.interceptor.call(this.base,t,n,e)}});function z(t,e){const n=document.getElementById("medium-editor-toolbar-"+e);while(t){if(V(t,n))return t;t=t.parentNode}return null}function V(t,e){return t.classList&&t.classList.contains("medium-editor-action")&&e.contains(t)}var X=d.a.Extension.extend({name:"newLineInterceptor",interceptor(){},init(){d.a.Extension.prototype.init.apply(this,arguments),this.initNewLineInterceptor()},initNewLineInterceptor(){this.applyOption(),window.setTimeout(this.wrapEventListener.bind(this))},applyOption(){Object.assign(this,this.getEditorOption(this.name))},wrapEventListener(){const t=this.base.events.customEvents.editableKeydownEnter,e=t[0];e&&(t[0]=t=>{if(!1!==this.interceptor.call(this.base,t))return e.call(this.base,t);t.preventDefault()})}}),G=d.a.Extension.extend({name:"blankLine",init(){d.a.Extension.prototype.init.apply(this,arguments),this.enabled()&&this.initKeepBlankLine()},enabled(){const t=this.getEditorOption(this.name);return!1!==t},initKeepBlankLine(){this.subscribe("editableKeyup",this.handleChange.bind(this)),this.subscribe("editablePaste",this.handleChange.bind(this))},handleChange(){this.getEditorElements().forEach(t=>{const e=W(t),n=e.length,i=t.children.length===n;if(0!==n){if(n>1&&i){const n=e[0];e.slice(1).forEach(e=>{t.removeChild(e)}),Object(o["b"])(n)}}else t.appendChild(K())})}});function W(t){const e=[],n=t.children;for(let i=n.length-1;i>=0;i--){if(!Y(n[i]))break;e.push(n[i])}return e.reverse()}function Y(t){return 1===(t.children||[]).length&&"BR"===t.children[0].nodeName}function K(){const t=document.createElement("p");return t.innerHTML="<br>",t}var J=n("8a60"),Q=n.n(J),Z=d.a.Extension.extend({name:"buttonShotcut",mousetrapList:[],init(){d.a.Extension.prototype.init.apply(this,arguments),this.initButtonShotcut()},initButtonShotcut(){const t=this.getEditorOption("toolbar")||{},e=t.buttons||[],n=e.map(tt).filter(t=>t);this.getEditorElements().forEach(t=>{const e=new Q.a(t);n.forEach(({shotcut:t,name:n})=>{e.bind(t,this.createEventHandler(n))}),this.mousetrapList.push(e)})},createEventHandler(t){const e=this.getEditorId();return function(){const n=et(t,e);return n&&n.click(),!1}},destroy(){this.mousetrapList.forEach(t=>t.reset()),this.mousetrapList=[]}});function tt(t){const e=(t.attrs||{})["data-shotcut"];return e?{name:t.name,shotcut:e.replace(/\s/g,"").split(",")}:null}function et(t,e){const n="medium-editor-toolbar-"+e,i="medium-editor-action-"+t,s=`#${n} .${i}`;return document.querySelector(s)}var nt=n("7cbb"),it=d.a.Extension.extend({name:"clipboard",translator:new f["a"],init(){d.a.Extension.prototype.init.apply(this,arguments),this.initClipboard()},initClipboard(){this.getEditorElements().forEach(t=>{this.on(t,"cut",this.handleCut.bind(this),!0),this.on(t,"copy",this.handleCopy.bind(this),!0)})},handleCut(t){},handleCopy(t){},handlePaste(t,e){if(t){const e=st(t),n=this.translator.toEditingHtml(e);this.base.pasteHTML(n)}else e&&this.base.pasteHTML(Object(nt["a"])(e))}});function st(t){return t.replace(/^[\s\S]+?-->([\s\S]*)<!--[\s\S]+?$/,"$1").replace(/<!--[\s\S]*?-->/g,"")}var at=n("52f0"),rt=n.n(at),ot=d.a.Extension.extend({name:"clean",init(){d.a.Extension.prototype.init.apply(this,arguments),this.initClean()},initClean(){this.subscribe("editableKeydown",t=>{8===t.keyCode&&this.handleRemoveEvent(t)})},handleRemoveEvent(t){const e=rt.a.getSelection(),n=e.focusNode||{},i=ct(n);i&&ut(n,i)&&(t.preventDefault(),i.removeChild(i.children[0]),this.trigger("checkState"))}});function ct(t){while(t){if(lt(t))return t;t=t.parentNode}return null}function lt(t){return t.classList&&t.classList.contains("medium-editor-element")}function ut(t,e){const n=e.children[0],i=n&&!n.innerText.trim();return dt(t,e)&&i}function dt(t,e){while(e.children[0]){if(e.children[0]===t)return!0;e=e.children[0]}return!1}var ht=n("9db5"),ft=d.a.extensions.button.extend({name:"formatHighlight",action:"formatHighlight",contentDefault:"<b>HIGHLIGHT</b>",classApplier:null,init(){d.a.Extension.prototype.init.apply(this,arguments),Object.assign(this,this.getEditorOption(this.name)),Object.assign(this,this.getButtonOption()),d.a.extensions.button.prototype.init.apply(this,arguments),this.initHighlight()},initHighlight(){this.initClassApplier(),this.initEventListener()},initClassApplier(){rt.a.init(),this.classApplier=rt.a.createClassApplier(ht["CLASS_NAME"],{elementTagName:"pre",normalize:!0,useExistingElements:!1,onElementCreate:t=>{const e=t.innerText;e&&(t.innerHTML=document.createTextNode(e).innerHTML)}})},initEventListener(){this.subscribe("editableKeydown",t=>{8===t.keyCode&&this.handleRemoveEvent(t)}),this.subscribe("editableKeyup",t=>{if(8===t.keyCode){const t=mt().start;t||this.trigger("codeBlockDeactive")}}),this.subscribe("editableClick",t=>{"PRE"===t.target.nodeName?this.trigger("codeBlockActive",t.target):this.trigger("codeBlockDeactive")})},handleRemoveEvent(t){const e=rt.a.getSelection(),n=e.focusNode||{},i=e.isCollapsed&&"PRE"===n.nodeName&&gt(n)&&bt(n.parentNode);i&&(t.preventDefault(),n.parentNode.removeChild(n))},getButtonOption(){return((this.getEditorOption("toolbar")||{}).buttons||[]).filter(t=>t.name===this.name)[0]},queryCommandState(){return this.isInCodeBlock()},handleClick(){if(!this.isFocused()||this.isInCodeBlock())return;const t=pt();this.base.pasteHTML("<p><br></p>"),this.base.pasteHTML(`<p>${vt(t)}</p>`),this.trigger("checkState")},isFocused(){return!!this.base.getFocusedElement()},isInCodeBlock(){const t=mt();return t.start||t.end}});function pt(){const t=rt.a.getSelection();if(!t.rangeCount)return"";const e=document.createElement("div"),n=t.getRangeAt(0).cloneContents();return n.querySelectorAll("p").forEach(t=>{t.lastChild&&"BR"===t.lastChild.nodeName||t.appendChild(document.createElement("br"))}),e.appendChild(n),e.innerText}function mt(){const t={start:null,end:null},e=window.getSelection();if(!e.rangeCount)return t;const n=e.getRangeAt(0);return t.start=Object(o["d"])(n.startContainer,"PRE"),t.end=Object(o["d"])(n.endContainer,"PRE"),t}function gt(t){return 1===t.parentNode.children.length}function bt(t){return t.parentNode.children[0]===t}function vt(t=""){return`<pre class="${ht["CLASS_NAME"]}">${Object(nt["a"])(t)||"<br>"}</pre>`}var _t=n("519d"),kt=d.a.extensions.button.extend({name:"formatCode",action:"formatCode",contentDefault:"<b>CODE</b>",classApplier:null,init(){d.a.Extension.prototype.init.apply(this,arguments),Object.assign(this,this.getEditorOption(this.name)),Object.assign(this,this.getButtonOption()),d.a.extensions.button.prototype.init.apply(this,arguments),this.initClassApplier()},initClassApplier(){rt.a.init(),this.classApplier=rt.a.createClassApplier(_t["CLASS_NAME"],{elementTagName:"code",normalize:!0,onElementCreate:t=>{const e=t.innerText;while(t.firstChild)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(e))}})},getButtonOption(){return((this.getEditorOption("toolbar")||{}).buttons||[]).filter(t=>t.name===this.name)[0]},queryCommandState(){return this.classApplier.isAppliedToSelection()},handleClick(){this.isFocused()&&(this.classApplier.toggleSelection(),this.trigger("checkState"))},isFocused(){return!!this.base.getFocusedElement()}}),yt=n("7f42"),Ct=d.a.extensions.button.extend({name:"formatBold",action:"formatBold",contentDefault:"<b>B</b>",classApplier:null,init(){d.a.Extension.prototype.init.apply(this,arguments),Object.assign(this,this.getEditorOption(this.name)),Object.assign(this,this.getButtonOption()),d.a.extensions.button.prototype.init.apply(this,arguments),this.initClassApplier()},initClassApplier(){rt.a.init(),this.classApplier=rt.a.createClassApplier(yt["CLASS_NAME"],{elementTagName:"b",normalize:!0})},getButtonOption(){return((this.getEditorOption("toolbar")||{}).buttons||[]).filter(t=>t.name===this.name)[0]},queryCommandState(){return this.classApplier.isAppliedToSelection()},handleClick(){this.isFocused()&&(this.classApplier.toggleSelection(),this.trigger("checkState"))},isFocused(){return!!this.base.getFocusedElement()}}),wt=d.a.extensions.button.extend({name:"formatOrderedList",action:"insertorderedlist",contentDefault:"<b>OL</b>",init(){d.a.Extension.prototype.init.apply(this,arguments),Object.assign(this,this.getEditorOption(this.name)),Object.assign(this,this.getButtonOption()),d.a.extensions.button.prototype.init.apply(this,arguments)},getButtonOption(){return((this.getEditorOption("toolbar")||{}).buttons||[]).filter(t=>t.name===this.name)[0]},queryCommandState(){return this.base.queryCommandState(this.getAction())},handleClick(){this.isFocused()&&this.execAction(this.getAction())},isFocused(){return!!this.base.getFocusedElement()}}),xt=d.a.extensions.button.extend({name:"formatUnorderedList",action:"insertunorderedlist",contentDefault:"<b>UL</b>",init(){d.a.Extension.prototype.init.apply(this,arguments),Object.assign(this,this.getEditorOption(this.name)),Object.assign(this,this.getButtonOption()),d.a.extensions.button.prototype.init.apply(this,arguments)},getButtonOption(){return((this.getEditorOption("toolbar")||{}).buttons||[]).filter(t=>t.name===this.name)[0]},queryCommandState(){return this.base.queryCommandState(this.getAction())},handleClick(){this.isFocused()&&this.execAction(this.getAction())},isFocused(){return!!this.base.getFocusedElement()}}),Et=d.a.extensions.button.extend({name:"formatLink",action:"formatLink",contentDefault:"<b>LINK</b>",init(){d.a.Extension.prototype.init.apply(this,arguments),Object.assign(this,this.getEditorOption(this.name)),Object.assign(this,this.getButtonOption()),d.a.extensions.button.prototype.init.apply(this,arguments),this.initFormatLink()},initFormatLink(){this.subscribe("requestUpdateLink",t=>{this.base.restoreSelection();const e=Ot();e?t?e.setAttribute("href",t):(Object(o["h"])(e),this.base.execAction("unlink")):t?this.base.createLink({value:t,target:"_blank"}):this.base.execAction("unlink"),this.trigger("checkState")})},getButtonOption(){return((this.getEditorOption("toolbar")||{}).buttons||[]).filter(t=>t.name===this.name)[0]},isAlreadyApplied(t){return"A"===t.nodeName},handleClick(){if(!this.isFocused())return;const t=Ot(),e=window.getSelection().isCollapsed;this.base.saveSelection(),t?this.trigger("requestEditLink",t.getAttribute("href")):e||this.trigger("requestCreateLink")},isFocused(){return!!this.base.getFocusedElement()}});function Ot(){const{start:t,end:e}=jt(),n=t&&t===e;return n?t:null}function jt(){const t={start:null,end:null},e=window.getSelection();if(!e.rangeCount)return t;const n=e.getRangeAt(0);return t.start=Object(o["d"])(n.startContainer,"A"),t.end=Object(o["d"])(n.endContainer,"A"),t}class Tt{constructor(t){this.element=t,this.translator=new f["a"],this.origin=new d.a(t,Object.assign({extensions:{toolbarTooltip:new L,uploadImage:new R,clickSelect:new F,state:new B,buttonInterceptor:new q,newLineInterceptor:new X,blankLine:new G,buttonShotcut:new Z,clipboard:new it,clean:new ot,formatHighlight:new ft,formatCode:new kt,formatBold:new Ct,formatOrderedList:new wt,formatUnorderedList:new xt,formatLink:new Et}},new A))}destroy(){this.origin.destroy()}getContent(){const t=this.origin.getContent();return h["a"](t)}setContent(t){this.origin.setContent(this.translator.toEditingHtml(t))}subscribe(...t){return this.origin.subscribe.apply(this.origin,t)}trigger(...t){return this.origin.trigger.apply(this.origin,t)}}var St=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("header",{staticClass:"header rich-text-editor-header",attrs:{"st:block":"editorHeader"}},[n("div",{staticClass:"header-content"},[n("Logo",{staticClass:"logo"}),n("StatusText",{staticClass:"status-text with-padding",attrs:{status:t.status}}),n("MainImageSelector",{staticClass:"main-image-selector with-padding",attrs:{post:t.post}}),n("EditorSwitcher",{staticClass:"editor-switcher with-padding",attrs:{type:"richText"}}),n("PublishPopup",{staticClass:"publish-popup with-padding",attrs:{post:t.post,status:t.status},on:{publish:t.publish}}),n("MainNavigator",{staticClass:"main-navigator with-padding"})],1)])},At=[],Lt=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"logo"})},It=[],$t=(n("2c25"),n("2877")),Dt={},Nt=Object($t["a"])(Dt,Lt,It,!1,null,"01bee318",null),Mt=Nt.exports,Pt=n("8bb0"),Ut=n("1595"),Rt=n("745c"),Ft=n("0524"),Ht=n("e0a3"),Bt={components:{Logo:Mt,StatusText:Pt["a"],MainImageSelector:Ut["a"],EditorSwitcher:Rt["a"],PublishPopup:Ft["a"],MainNavigator:Ht["a"]},props:["guided","post","status"],methods:{publish(){this.$emit("publish")}}},qt=Bt,zt=(n("ad56"),Object($t["a"])(qt,St,At,!1,null,"7a5a684f",null)),Vt=zt.exports,Xt=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("textarea",{directives:[{name:"model",rawName:"v-model",value:t.innerValue,expression:"innerValue"}],ref:"input",staticClass:"title-input",attrs:{placeholder:"输入标题...",spellcheck:"false",maxlength:t.maxlength,rows:"1"},domProps:{value:t.innerValue},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.$emit("submit")},input:function(e){e.target.composing||(t.innerValue=e.target.value)}}})},Gt=[],Wt=n("3bba"),Yt={props:["value"],data:()=>({maxlength:Wt["a"],innerValue:""}),watch:{value:{handler(t,e){this.innerValue=t},immediate:!0},innerValue(t,e){const n=t.replace(/[\r\n]/g,"");n!==t?this.innerValue=n:(this.$emit("input",n),this.$nextTick(()=>Kt(this.$refs.input)))}},mounted(){this.$refs.input.focus()}};function Kt(t){t.style.height="1px",t.style.height=t.scrollHeight+"px"}var Jt=Yt,Qt=(n("e108"),Object($t["a"])(Jt,Xt,Gt,!1,null,"1016d8f6",null)),Zt=Qt.exports,te=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{directives:[{name:"show",rawName:"v-show",value:t.visible,expression:"visible"}],staticClass:"code-lang-selector",style:t.style,on:{mousewheel:function(t){t.stopPropagation()}}},[n("div",{staticClass:"current-lang",on:{click:t.toggleList}},[t._v(t._s(t.currentLang))]),n("ul",{directives:[{name:"show",rawName:"v-show",value:t.listVisible,expression:"listVisible"}],ref:"list",staticClass:"lang-list"},[t._l(t.usedLangList,(function(e){return n("li",{staticClass:"item used",on:{click:function(n){return t.selectLang(e)}}},[t._v(" "+t._s(e)+" ")])})),t._l(t.langList,(function(e){return n("li",{staticClass:"item",on:{click:function(n){return t.selectLang(e)}}},[t._v(" "+t._s(e)+" ")])}))],2)])},ee=[],ne=n("ee10"),ie=n("964c"),se={data:()=>({langList:Object(ne["a"])(),usedLangList:[],currentLang:ht["DEFAULT_LANG"],visible:!1,listVisible:!1,top:0,left:0}),computed:{style(){return{top:this.top+"px",left:this.left+"px"}}},methods:{setTargetCodeBlock(t){this.hide(),this.codeBlock=t,this.currentLang=t.getAttribute(ht["LANG_ATTR_NAME"])||ht["DEFAULT_LANG"],this.getUsedLangList(),this.show()},show(){this.position(),this.visible=!0},position(){if(!this.codeBlock)return;const t=Object(o["e"])(this.codeBlock);this.top=t.top,this.left=t.left},hide(){this.codeBlock=null,this.visible=!1,this.hideList()},toggleList(){this.listVisible?this.hideList():this.showList()},getUsedLangList(){const t=ie["a"]("usedCodeLangList")||[];this.usedLangList=t.length?t:[]},updateUsedLangList(){const t=this.currentLang,e=this.usedLangList,n=[t].concat(e.filter(e=>e!==t).slice(0,9));ie["b"]("usedCodeLangList",n)},showList(){this.listVisible=!0},hideList(){this.listVisible=!1,this.$refs.list.scrollTop=0},selectLang(t){this.currentLang=t,this.updateCodeBlockLang(),this.updateUsedLangList(),this.hideList()},updateCodeBlockLang(){this.codeBlock&&(this.codeBlock.setAttribute(ht["LANG_ATTR_NAME"],this.currentLang),this.$emit("update",this.currentLang))}},mounted(){this.removeResizeListener=Object(o["f"])(window,"resize",()=>{this.$nextTick(()=>{this.position()})})},beforeDestroy(){this.removeResizeListener()}},ae=se,re=(n("8780"),Object($t["a"])(ae,te,ee,!1,null,"75a3b4b0",null)),oe=re.exports,ce=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{directives:[{name:"show",rawName:"v-show",value:t.visible,expression:"visible"}],staticClass:"link-dialog-box"},[n("div",{staticClass:"link-dialog"},[n("div",{staticClass:"dialog-header"},[n("div",{staticClass:"dialog-title"},[t._v(t._s(t.title))]),n("button",{staticClass:"close-btn ion-close-round",attrs:{title:"关闭"},on:{click:t.close}})]),n("div",{staticClass:"dialog-body"},[n("form",{on:{submit:function(e){return e.preventDefault(),t.submit(e)}}},[n("div",{staticClass:"input-group"},[n("div",{staticClass:"input-icon url-input-icon",on:{click:function(e){return t.$refs.urlInput.select()}}}),n("input",{directives:[{name:"model",rawName:"v-model",value:t.form.url,expression:"form.url"}],ref:"urlInput",staticClass:"input url-input",attrs:{placeholder:"输入网址...",spellcheck:"false"},domProps:{value:t.form.url},on:{input:function(e){e.target.composing||t.$set(t.form,"url",e.target.value)}}})])])]),n("div",{staticClass:"dialog-footer"},[n("button",{staticClass:"ctrl-btn cancel-btn",on:{click:t.close}},[t._v("取消")]),n("button",{staticClass:"ctrl-btn confirm-btn",on:{click:t.submit}},[t._v("确定")])])])])},le=[],ue={data:()=>({visible:!1,url:"",form:{url:""}}),computed:{isEdit(){return!!this.url},title(){return this.isEdit?"编辑链接":"创建链接"}},methods:{show(t){this.url=t||"",this.form.url=this.url,this.visible=!0,this.$nextTick(()=>{this.$refs.urlInput.select()})},close(){this.visible=!1},update(){this.$emit("update",this.form.url.trim())},submit(){this.close(),this.update()}}},de=ue,he=(n("1a50"),Object($t["a"])(de,ce,le,!1,null,"ab991774",null)),fe=he.exports,pe=n("6b53"),me=function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.visible?n("div",{staticClass:"image-size-alert"},[n("span",{staticClass:"close-btn ion-close",attrs:{title:"关闭"},on:{click:function(e){t.visible=!1}}}),n("div",{staticClass:"title"},[t._v(t._s(t.title))]),n("div",{staticClass:"text"},[t._v(" 请尽可能压缩图片大小以提升阅读体验。 "),n("br"),t._v(" 推荐在线压缩工具： "),n("ul",{staticClass:"recommended-list"},[n("li",{staticClass:"item"},[t._v(" 静图压缩： "),n("a",{staticClass:"link",attrs:{href:"https://tinypng.com/",target:"_blank"}},[t._v(" "+t._s("tinypng.com")+" ")])]),n("li",{staticClass:"item"},[t._v(" 动图压缩： "),n("a",{staticClass:"link",attrs:{href:"https://ezgif.com/optimize",target:"_blank"}},[t._v(" "+t._s("ezgif.com")+" ")])])])])]):t._e()},ge=[],be={data:()=>({visible:!1,title:""}),methods:{show(t){const e=Date.now();this.title=t||"图片过大",this.token=e,this.visible=!0,setTimeout(()=>{e===this.token&&(this.visible=!1)},15e3)}}},ve=be,_e=(n("a1fe"),Object($t["a"])(ve,me,ge,!1,null,"08993f1a",null)),ke=_e.exports;const ye=new a["a"];var Ce={components:{EditorHeader:Vt,TitleInput:Zt,CodeLangSelector:oe,LinkDialog:fe,ImageUploadProgressPanel:pe["a"],ImageSizeAlert:ke},props:["guided","post","status"],data:()=>({isImageUploading:!1}),computed:{isDraft(){return!this.post.entry},notNeedConfirmedUpdate(){return[this.post.title,this.post.html,this.post.markdown,this.post.category,this.post.tags,this.post.cover_image]}},watch:{notNeedConfirmedUpdate(){this.requestUpdate()}},methods:{initEditor(){this.editor=new Tt(this.$refs.content),this.editor.setContent(this.post.html),this.editor.subscribe("codeBlockActive",t=>{this.$refs.codeLangSelector.setTargetCodeBlock(t)}),this.editor.subscribe("codeBlockDeactive",()=>{this.$refs.codeLangSelector.hide()}),this.editor.subscribe("requestEditLink",t=>{this.$refs.linkDialog.show(t)}),this.editor.subscribe("requestCreateLink",()=>{this.$refs.linkDialog.show()}),this.editor.subscribe("imageUploading",()=>{this.isImageUploading=!0}),this.editor.subscribe("imageUploadSuccess",()=>{this.isImageUploading=!1}),this.editor.subscribe("imageUploadFailed",t=>{this.isImageUploading=!1,"size"===t.type?this.$refs.imageSizeAlert.show(t.message):this.$error(t)}),this.editor.subscribe("editableInput",Object(r["a"])(()=>{this.updatePost()},300))},updatePost(){const t=this.editor.getContent();this.post.html=t,this.post.markdown=ye.fromHtml(t)},updateLink(t){window.setTimeout(()=>{this.editor.trigger("requestUpdateLink",t)},200)},cancelImageUpload(){this.isImageUploading=!1,this.editor.trigger("cancelImageUpload")},onTitleSubmit(){this.$refs.content.focus()},update(){this.$emit("update")},async publish(){let t=!1;const e=Array.from(this.editor.element.querySelectorAll("img"));await Promise.all(e.map(async e=>{try{const t=e.getAttribute("src");if(!(t.includes("data:image/svg+xml;utf8")||t.includes("p-boe.byted.org")||t.includes("juejin.byteimg.com"))){const n=await Object(l["a"])(t),i=n.data;e.setAttribute("src",i)}}catch{t=!0}})),this.updatePost(),t&&this.$error("图片地址解析失败"),this.$emit("publish")}},created(){this.requestUpdate=Object(r["a"])(()=>{this.update()},c["a"])},mounted(){this.initEditor()},beforeDestroy(){this.editor.destroy()}},we=Ce,xe=(n("ae73"),n("dfa1"),Object($t["a"])(we,i,s,!1,null,"7f01ad6a",null));e["a"]=xe.exports},"39f1":function(t,e,n){"use strict";var i=n("be41"),s=n.n(i);s.a},"3b37":function(t,e,n){"use strict";n.r(e),n.d(e,"install",(function(){return p}));var i=n("24c0");function s(t,e){const n=o(e);if(!c(n))return;const s=r(n);i["a"].exec("send","event","generalElementEvent",t,s)}function a(t){const e=o(t);return c(e)?r(o(t)):"Event wouldn't be sent."}function r(t){const e=[l(),u(t),d(t),h(t)].map(f).join(" ");return e}function o(t){const e=[];while(t&&1===t.nodeType)e.unshift({block:t.getAttribute("st:block"),name:t.getAttribute("st:name"),state:t.getAttribute("st:state"),silent:t.hasAttribute("st:silent")}),t=t.parentNode;return e}function c(t){const e=t.some(t=>t.silent);if(e)return!1;for(let n=t.length-1;n>=0;n--){const{block:e,name:i}=t[n];if(e)return!1;if(i)return!0}}function l(){const{href:t,origin:e}=window.location;return t.slice(e.length).split("#")[0]}function u(t){return t.filter(t=>t.block).map(t=>t.block+(t.state?":"+t.state:"")).join("/")}function d(t){for(let e=t.length-1;e>=0;e--){const{block:n,name:i}=t[e];if(n)return null;if(i)return i}}function h(t){for(let e=t.length-1;e>=0;e--){const{block:n,name:i,state:s}=t[e];if(n)return null;if(i||s)return s}}function f(t){return t?t.replace(/ /g,"_"):"-"}function p(t,e){m(t),g()}function m(t){t.prototype.$st={click(t){s("click",t||this.$el)},show(t){s("show",t||this.$el)}},window.addEventListener("click",(function(t){s("click",t.target)}),!0)}function g(){window.$stInfo=function(t){return t?{label:a(t)}:"Please select a node in [Elements] tab."}}},"3b6d":function(t,e,n){},"3bba":function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));const i=80},"3cbf":function(t,e,n){"use strict";var i=n("2fe1"),s=n.n(i);s.a},"3d36":function(t,e,n){"use strict";n.r(e);var i=n("7c64");const s="draft/UPDATE_STATE";e["default"]={state:{booklet_draft:{},sections:[]},getters:{},mutations:{[s](t,e){Object.assign(t,e)}},actions:{[i["DELETE_DRAFT"]]({commit:t},e){t(i["ENTITY_DELETED"],{model:"draft",id:e})}}}},"3d66":function(t,e,n){"use strict";var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("button",{staticClass:"new-button",attrs:{"st:name":"newBtn"},on:{click:t.onClick}},[t._v("写文章")])},s=[],a={methods:{onClick(){window.location.href="/editor/drafts/new?v=2"}}},r=a,o=n("2877"),c=Object(o["a"])(r,i,s,!1,null,"1cadd853",null);e["a"]=c.exports},"40fe":function(t,e,n){},"41aa":function(t,e,n){},"425c":function(t,e,n){"use strict";n.r(e);var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"view draft-index-view"},[n("MainHeader",{staticClass:"main-header"}),n("main",{staticClass:"main"},[n("DraftList",{attrs:{list:t.list,"xiaoce-list":t.xiaoceList,"xiaoce-count":t.countXiaoce,"xiaoce-hasmore":t.hasMoreXiaoce,"cur-type":t.$route.query.type,loading:t.loading},on:{"type-select":t.onTypeSelect,delete:t.deleteDraft,"xiaoce-fetchmore":t.getXiaoceDraftList}})],1)],1)},s=[],a=n("7590");n("db82"),n("7bbb"),n("b8ba");var r=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("header",{staticClass:"header main-header",attrs:{"st:block":"mainHeader"}},[n("div",{staticClass:"header-content"},[n("a",{staticClass:"logo",attrs:{href:"/"}}),n("NewButton",{staticClass:"new-button"}),1===t.user.book_author?n("button",{staticClass:"new-button",on:{click:t.toXiaoceEditor}},[t._v(" 写小册 ")]):t._e(),n("MainNavigator")],1)])},o=[],c=n("e0a3"),l=n("3d66"),u={components:{MainNavigator:c["a"],NewButton:l["a"]},computed:{user(){return this.$store.getters.USER||{}}},methods:{toXiaoceEditor(){let t="new";window.location.href=`/editor/book/${t}/section`}}},d=u,h=(n("c931"),n("2877")),f=Object(h["a"])(d,r,o,!1,null,"4aa0afe2",null),p=f.exports,m=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"draft-list"},[n("div",{staticClass:"list-header"},[n("div",{staticClass:"list-header-item",class:{active:"article"===t.curType||!t.curType},on:{click:function(e){return t.onTypeSelect("article")}}},[t._v(" 专栏草稿（"+t._s(t.list.length)+"） ")]),1===this.user.book_author?n("div",{staticClass:"list-header-item",class:{active:"xiaoce"===t.curType},on:{click:function(e){return t.onTypeSelect("xiaoce")}}},[t._v(" 小册草稿（"+t._s(t.xiaoceCount)+"） ")]):t._e()]),"xiaoce"!==t.curType?n("ul",{staticClass:"list"},t._l(t.list,(function(e){return n("li",{staticClass:"item"},[n("Draft",{attrs:{draft:e},on:{delete:t.deleteDraft}})],1)})),0):t._e(),"xiaoce"===t.curType?n("ul",{ref:"list",staticClass:"list"},t._l(t.xiaoceList,(function(e){return n("li",{staticClass:"item"},[n("XiaoceDraft",{attrs:{draft:e},on:{delete:t.deleteDraft}})],1)})),0):t._e()])},g=[],b=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"draft"},[i("a",{staticClass:"title",attrs:{href:t.editUrl}},[t._v(t._s(t.title))]),i("div",{staticClass:"info-box"},["markdown"===t.draft.type?i("img",{staticClass:"item icon",attrs:{src:n("992a")}}):t._e(),i("div",{staticClass:"item date"},[t._v(t._s(t.date))]),i("div",{ref:"menu",staticClass:"menu ion-ios-more",on:{click:function(e){t.isMenuActive=!t.isMenuActive}}},[i("ul",{directives:[{name:"show",rawName:"v-show",value:t.isMenuActive,expression:"isMenuActive"}],staticClass:"menu-list"},[i("li",{staticClass:"item",on:{click:t.editDraft}},[t._v("编辑")]),i("li",{staticClass:"item",on:{click:function(e){t.isDeleteDialogVisible=!0}}},[t._v("删除")])])])]),t.isDeleteDialogVisible?i("ConfirmDialog",{attrs:{title:"删除草稿",content:"删除后不可恢复，确认删除此草稿吗？"},on:{cancel:function(e){t.isDeleteDialogVisible=!1},confirm:t.deleteDraft}}):t._e()],1)},v=[],_=n("9b04"),k=n("6658"),y={components:{ConfirmDialog:k["a"]},props:["draft"],data:()=>({isMenuActive:!1,isDeleteDialogVisible:!1}),computed:{editUrl(){return"/editor/drafts/"+this.draft.id},title(){return this.draft.title||"无标题"},date(){return Object(_["a"])(this.draft.updatedAt,"YYYY 年 M 月 D 日 HH:mm")}},methods:{editDraft(){window.location.href=this.editUrl},deleteDraft(){this.$emit("delete",this.draft),this.isDeleteDialogVisible=!1}},domEvents:{click({target:t}){this.$refs.menu.contains(t)||(this.isMenuActive=!1)}}},C=y,w=(n("3595"),Object(h["a"])(C,b,v,!1,null,"5ee49c32",null)),x=w.exports,E=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"draft"},[n("a",{staticClass:"title",attrs:{href:t.editUrl}},[t._v(t._s(t.title))]),n("div",{staticClass:"info-box"},[n("div",{staticClass:"item date"},[t._v(t._s(t.date))]),n("div",{ref:"menu",staticClass:"menu ion-ios-more",on:{click:function(e){t.isMenuActive=!t.isMenuActive}}},[n("ul",{directives:[{name:"show",rawName:"v-show",value:t.isMenuActive,expression:"isMenuActive"}],staticClass:"menu-list"},[n("li",{staticClass:"item",on:{click:t.editDraft}},[t._v("编辑")]),n("li",{staticClass:"item",on:{click:function(e){t.isDeleteDialogVisible=!0}}},[t._v("删除")])])])]),t.isDeleteDialogVisible?n("ConfirmDialog",{attrs:{title:"删除草稿",content:"删除后不可恢复，确认删除此草稿吗？"},on:{cancel:function(e){t.isDeleteDialogVisible=!1},confirm:t.deleteDraft}}):t._e()],1)},O=[],j=(n("ea37"),{components:{ConfirmDialog:k["a"]},props:["draft"],data:()=>({isMenuActive:!1,isDeleteDialogVisible:!1}),computed:{editUrl(){return`/editor/book/${this.draft.base_info.booklet_id}/section`},title(){return this.draft.base_info.title||"无标题"},date(){return Object(_["a"])(1e3*this.draft.base_info.mtime,"YYYY 年 M 月 D 日 HH:mm")}},methods:{editDraft(){window.location.href=this.editUrl},deleteDraft(){this.$emit("delete",this.draft,"xiaoce"),this.isDeleteDialogVisible=!1}},domEvents:{click({target:t}){this.$refs.menu.contains(t)||(this.isMenuActive=!1)}}}),T=j,S=(n("a175"),Object(h["a"])(T,E,O,!1,null,"ea9a59ce",null)),A=S.exports,L=n("8690"),I={components:{Draft:x,XiaoceDraft:A},props:["list","xiaoceList","curType","loading","xiaoceCount","xiaoceCursor","xiaocehasmore"],computed:{user(){return this.$store.getters.USER||{}}},methods:{onTypeSelect(t){this.$emit("type-select",t)},deleteDraft(t,e){this.$emit("delete",t,e)},fetchMoreIfConditionIsSatisfied(){const t=Object(L["c"])(this.$refs.list);t>-200&&this.$emit("xiaoce-fetchmore")}},mounted(){this.$refs.list&&Object(L["g"])(this.$refs.list,()=>{this.fetchMoreIfConditionIsSatisfied()})}},$=I,D=(n("2409"),Object(h["a"])($,m,g,!1,null,"024d34fd",null)),N=D.exports,M=n("7e48"),P={components:{MainHeader:p,DraftList:N},data:()=>({list:[],xiaoceList:[],cursorXiaoce:0,countXiaoce:0,hasMoreXiaoce:!0,loadingDraft:!1,loadingXiaoceDraft:!1}),computed:{user(){return this.$store.getters.USER||{}},loading(){return this.loadingDraft||this.loadingXiaoceDraft}},methods:{fetch(){this.loading||(this.getDraftList(),1===this.user.book_author&&this.getXiaoceDraftList())},getDraftList(){this.loadingDraft=!0,Object(a["e"])().then(t=>{this.list=t.sort((t,e)=>e.updatedAt-t.updatedAt),this.loadingDraft=!1}).catch(t=>{this.loadingDraft=!1,this.$error(t)})},getXiaoceDraftList(){this.hasMoreXiaoce&&!this.loadingXiaoceDraft&&(this.loadingXiaoceDraft=!0,Object(M["d"])({cursor:this.cursorXiaoce}).then(t=>{this.xiaoceList=this.xiaoceList.concat(t.data||[]),this.cursorXiaoce=t.cursor,this.countXiaoce=t.count,this.hasMoreXiaoce=t.has_more,this.loadingXiaoceDraft=!1}).catch(t=>{this.loadingXiaoceDraft=!1,this.$error(t)}))},onTypeSelect(t){this.$router.push({name:"draftIndex",params:{},query:{type:t||"article"}})},deleteArticleDraft(t){Object(a["b"])(t.id).then(()=>{this.loading=!1,this.list=this.list.filter(e=>e.id!==t.id)})},deleteXiaoceDraft(t){Object(M["h"])({booklet_id:t.base_info.booklet_id,status:-1,change_field:"status"}).then(e=>{this.loading=!1,this.countXiaoce=this.countXiaoce-1,this.xiaoceList=this.xiaoceList.filter(e=>e.base_info.booklet_id!==t.base_info.booklet_id)})},deleteDraft(t,e){"xiaoce"===e?this.deleteXiaoceDraft(t):this.deleteArticleDraft(t)}},metaInfo(){return{title:"草稿 - 掘金"}},mounted(){this.fetch()}},U=P,R=(n("117d"),Object(h["a"])(U,i,s,!1,null,"fec1ce18",null));e["default"]=R.exports},"43b4":function(t,e,n){},"453e":function(t,e,n){"use strict";n.d(e,"a",(function(){return s}));var i=n("8896");class s{constructor(t){this.maxSize=t.maxSize,this.validTypeList=t.validTypeList}validate(t){return this.checkSize(t).then(()=>this.checkType(t))}checkSize(t){return this.maxSize&&t.size>this.maxSize?Promise.reject(new a(this.maxSize)):Promise.resolve()}checkType(t){return this.validTypeList?Object(i["a"])(t,this.validTypeList).then(t=>{if(!t)return Promise.reject(new r(this.validTypeList))}):Promise.resolve()}}class a extends Error{constructor(t){if(super(),t){const e=Math.floor(t/1024/1024*100)/100;this.message=`图片文件过大，最大支持 ${e} MB`}else this.message="图片文件过大";this.type="size"}}class r extends Error{constructor(t){super(),this.message=`仅支持 ${t.join(" | ")} 格式的图片`,this.type="type"}}},4678:function(t,e,n){var i={"./af":"2bfb","./af.js":"2bfb","./ar":"8e73","./ar-dz":"a356","./ar-dz.js":"a356","./ar-kw":"423e","./ar-kw.js":"423e","./ar-ly":"1cfd","./ar-ly.js":"1cfd","./ar-ma":"0a84","./ar-ma.js":"0a84","./ar-sa":"8230","./ar-sa.js":"8230","./ar-tn":"6d83","./ar-tn.js":"6d83","./ar.js":"8e73","./az":"485c","./az.js":"485c","./be":"1fc1","./be.js":"1fc1","./bg":"84aa","./bg.js":"84aa","./bn":"9043","./bn.js":"9043","./bo":"d26a","./bo.js":"d26a","./br":"6887","./br.js":"6887","./bs":"2554","./bs.js":"2554","./ca":"d716","./ca.js":"d716","./cs":"3c0d","./cs.js":"3c0d","./cv":"03ec","./cv.js":"03ec","./cy":"9797","./cy.js":"9797","./da":"0f14","./da.js":"0f14","./de":"b469","./de-at":"b3eb","./de-at.js":"b3eb","./de-ch":"bb71","./de-ch.js":"bb71","./de.js":"b469","./dv":"598a","./dv.js":"598a","./el":"8d47","./el.js":"8d47","./en-au":"0e6b","./en-au.js":"0e6b","./en-ca":"3886","./en-ca.js":"3886","./en-gb":"39a6","./en-gb.js":"39a6","./en-ie":"e1d3","./en-ie.js":"e1d3","./en-nz":"6f50","./en-nz.js":"6f50","./eo":"65db","./eo.js":"65db","./es":"898b","./es-do":"0a3c","./es-do.js":"0a3c","./es.js":"898b","./et":"ec18","./et.js":"ec18","./eu":"0ff2","./eu.js":"0ff2","./fa":"8df4","./fa.js":"8df4","./fi":"81e9","./fi.js":"81e9","./fo":"0721","./fo.js":"0721","./fr":"9f26","./fr-ca":"d9f8","./fr-ca.js":"d9f8","./fr-ch":"0e49","./fr-ch.js":"0e49","./fr.js":"9f26","./fy":"7118","./fy.js":"7118","./gd":"f6b4","./gd.js":"f6b4","./gl":"8840","./gl.js":"8840","./gom-latn":"0caa","./gom-latn.js":"0caa","./he":"c7aa","./he.js":"c7aa","./hi":"dc4d","./hi.js":"dc4d","./hr":"4ba9","./hr.js":"4ba9","./hu":"5b14","./hu.js":"5b14","./hy-am":"d6b6","./hy-am.js":"d6b6","./id":"5038","./id.js":"5038","./is":"0558","./is.js":"0558","./it":"6e98","./it.js":"6e98","./ja":"079e","./ja.js":"079e","./jv":"b540","./jv.js":"b540","./ka":"201b","./ka.js":"201b","./kk":"6d79","./kk.js":"6d79","./km":"e81d","./km.js":"e81d","./kn":"3e92","./kn.js":"3e92","./ko":"22f8","./ko.js":"22f8","./ky":"9609","./ky.js":"9609","./lb":"440c","./lb.js":"440c","./lo":"b29d","./lo.js":"b29d","./lt":"26f9","./lt.js":"26f9","./lv":"b97c","./lv.js":"b97c","./me":"293c","./me.js":"293c","./mi":"688b","./mi.js":"688b","./mk":"6909","./mk.js":"6909","./ml":"02fb","./ml.js":"02fb","./mr":"39bd","./mr.js":"39bd","./ms":"ebe4","./ms-my":"6403","./ms-my.js":"6403","./ms.js":"ebe4","./my":"8689","./my.js":"8689","./nb":"6ce3","./nb.js":"6ce3","./ne":"3a39","./ne.js":"3a39","./nl":"facd","./nl-be":"db29","./nl-be.js":"db29","./nl.js":"facd","./nn":"b84c","./nn.js":"b84c","./pa-in":"f3ff","./pa-in.js":"f3ff","./pl":"8d57","./pl.js":"8d57","./pt":"f260","./pt-br":"d2d4","./pt-br.js":"d2d4","./pt.js":"f260","./ro":"972c","./ro.js":"972c","./ru":"957c","./ru.js":"957c","./sd":"6784","./sd.js":"6784","./se":"ffff","./se.js":"ffff","./si":"eda5","./si.js":"eda5","./sk":"7be6","./sk.js":"7be6","./sl":"8155","./sl.js":"8155","./sq":"c8f3","./sq.js":"c8f3","./sr":"cf1e","./sr-cyrl":"13e9","./sr-cyrl.js":"13e9","./sr.js":"cf1e","./ss":"52bd","./ss.js":"52bd","./sv":"5fbd","./sv.js":"5fbd","./sw":"74dc","./sw.js":"74dc","./ta":"3de5","./ta.js":"3de5","./te":"5cbb","./te.js":"5cbb","./tet":"576c","./tet.js":"576c","./th":"10e8","./th.js":"10e8","./tl-ph":"0f38","./tl-ph.js":"0f38","./tlh":"cf75","./tlh.js":"cf75","./tr":"0e81","./tr.js":"0e81","./tzl":"cf51","./tzl.js":"cf51","./tzm":"c109","./tzm-latn":"b53d","./tzm-latn.js":"b53d","./tzm.js":"c109","./uk":"ada2","./uk.js":"ada2","./ur":"5294","./ur.js":"5294","./uz":"2e8c","./uz-latn":"010e","./uz-latn.js":"010e","./uz.js":"2e8c","./vi":"2921","./vi.js":"2921","./x-pseudo":"fd7e","./x-pseudo.js":"fd7e","./yo":"7f33","./yo.js":"7f33","./zh-cn":"5c3a","./zh-cn.js":"5c3a","./zh-hk":"49ab","./zh-hk.js":"49ab","./zh-tw":"90ea","./zh-tw.js":"90ea"};function s(t){var e=a(t);return n(e)}function a(t){if(!n.o(i,t)){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}return i[t]}s.keys=function(){return Object.keys(i)},s.resolve=a,t.exports=s,s.id="4678"},"46bb":function(t,e,n){},"48c2":function(t,e,n){},"4cc5":function(t,e,n){},"4cc8":function(t,e,n){"use strict";n.r(e);var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"edit-draft"},[n(t.editor,{tag:"component",attrs:{post:t.draft,status:t.status},on:{update:t.update,publish:t.publish}})],1)},s=[],a=n("7590"),r=n("e37c"),o=n("2fd7"),c=(n("964c"),n("3828")),l=n("88f3");const u=new o["a"];var d={components:{RichTextEditor:c["a"],MarkdownEditor:l["a"]},data:()=>({editor:null,draft:null,status:"editing"}),computed:{editorType(){const{USER:t}=this.$store.getters;return t&&"wysiwyg"===t.editor_type?"wysiwyg":"markdown"}},metaInfo(){const t=["写文章",(this.draft||{}).title,"掘金"];return{title:t.filter(t=>t).join(" - ")}},methods:{init(){const t=this.$route.params.id;this.initDraft(t).catch(t=>{404===t.normalizedCode&&this.$router.push({name:"notFound"}),this.$error(t)}).then(()=>this.initEditor()).catch(t=>{this.$error(t)})},initDraft(t){const e="new"===t?this.getBlankDraft():this.fetchDraft(t);return e.then(e=>{e.entry?window.location.href="/editor/posts/"+t:this.draft=e})},getBlankDraft(){return Object(a["c"])({type:"wysiwyg"===this.editorType?"wysiwyg":"markdown"})},fetchDraft(t){return Object(a["d"])(t)},initEditor(){this.draft&&("wysiwyg"===this.draft.type||0===this.draft.edit_type?this.editor="RichTextEditor":this.editor="MarkdownEditor")},update(){(this.draft.id||this.draft.title||this.draft.html)&&(this.status="saving",Object(a["a"])(this.draft).then(()=>{const t=this.$route.params&&this.$route.params.id,e=this.draft.id;t!==e&&this.$router.replace({params:{id:e}}),this.status="editing"}).catch(t=>{this.status="error",this.$error(t)}))},publish(){const t=this.$store.state.auth.user.level;u.validate(this.draft).then(()=>Object(a["a"])(this.draft)).then(()=>Object(a["f"])(this.draft.id,t)).then(t=>{if(t&&t.article_id){const e={id:t.article_id,type:"post"};window.sessionStorage.setItem("PUB_INFO",JSON.stringify(e)),window.location.href=Object(r["d"])()}}).catch(t=>{this.$error(t)})}},mounted(){this.init()}};var h=d,f=n("2877"),p=Object(f["a"])(h,i,s,!1,null,"42cc0d45",null);e["default"]=p.exports},"4cf4":function(t,e,n){"use strict";var i=n("32a2"),s=n.n(i);s.a},"519d":function(t,e,n){"use strict";n.r(e),n.d(e,"CLASS_NAME",(function(){return s})),n.d(e,"format",(function(){return a}));var i=n("a061");const s=Object(i["e"])("code");function a(t){const e=Array.from(t.querySelectorAll("pre code"));Array.from(t.querySelectorAll("code")).filter(t=>-1===e.indexOf(t)).forEach(t=>{t.classList.add(s)})}},5250:function(t,e,n){"use strict";n.r(e);var i=n("7c64");const s="error/UPDATE_STATE";e["default"]={state:{errorView:null},getters:{[i["ERROR_VIEW"]]:t=>t.errorView},mutations:{[s](t,e){Object.assign(t,e)}},actions:{[i["SET_ERROR_VIEW"]]({commit:t},e){t(s,{errorView:e})}}}},"53fc":function(t,e,n){},5636:function(t,e,n){},"56b5":function(t,e,n){},"58e8":function(t,e,n){"use strict";n.r(e);var i=n("7c64"),s=n("964c");const a="layout/UPDATE_STATE";e["default"]={state:{markdownLayout:s["a"]("markdownLayout"),xiaoceLayout:s["a"]("xiaoceLayout"),xiaoceSummaryLayout:s["a"]("xiaoceSummaryLayout")},getters:{[i["MARKDOWN_LAYOUT"]]:t=>t.markdownLayout,[i["XIAOCE_LAYOUT"]]:t=>t.xiaoceLayout,[i["XIAOCE_SUMMARY_LAYOUT"]]:t=>t.xiaoceSummaryLayout},mutations:{[a](t,e){Object.assign(t,e)}},actions:{[i["TOGGLE_MARKDOWN_LAYOUT"]]({commit:t,state:e}){const n="extended"===e.markdownLayout?"collapsed":"extended";t(a,{markdownLayout:n}),s["b"]("markdownLayout",n)},[i["TOGGLE_XIAOCE_LAYOUT"]]({commit:t,state:e}){const n="extended"===e.xiaoceLayout?"collapsed":"extended";t(a,{xiaoceLayout:n}),s["b"]("xiaoceLayout",n)},[i["TOGGLE_XIAOCE_SUMMARY_LAYOUT"]]({commit:t,state:e}){console.log(e.xiaoceSummaryLayout);const n="extended"===e.xiaoceSummaryLayout?"collapsed":"extended";t(a,{xiaoceSummaryLayout:n}),s["b"]("xiaoceSummaryLayout",n)}}}},5955:function(t,e,n){"use strict";var i=n("53fc"),s=n.n(i);s.a},"5c64":function(t,e,n){"use strict";var i=n("48c2"),s=n.n(i);s.a},"5c91":function(t,e,n){"use strict";n.d(e,"a",(function(){return s})),n.d(e,"b",(function(){return a}));const i=85;function s(t,e,n,{quality:s=i,format:a=""}={}){return r(t,1,e,n,s,a)}function a(t,e,n,{quality:s=i,format:a=""}={}){return r(t,2,e,n,s,a)}function r(t,e,n,i,s,a){const r=`?imageView2/${e}/w/${n}/h/${i}/q/${s}`+(a?"/format/"+a:"")+"/interlace/1";return t.replace(/\?.*$/,"")+r}},"604c":function(t,e,n){"use strict";function i(t,e){var n,i=t.posMax,s=!0,a=!0;return e>0?t.src.charCodeAt(e-1):-1,n=e+1<=i?t.src.charCodeAt(e+1):-1,n>=48&&n<=57&&(a=!1),{can_open:s,can_close:a}}function s(t,e){var n,s,a,r,o;if("$"!==t.src[t.pos])return!1;if(r=i(t,t.pos),!r.can_open)return e||(t.pending+="$"),t.pos+=1,!0;n=t.pos+1,s=n;while(-1!==(s=t.src.indexOf("$",s))){o=s-1;while("\\"===t.src[o])o-=1;if((s-o)%2==1)break;s+=1}return-1===s?(e||(t.pending+="$"),t.pos=n,!0):s-n===0?(e||(t.pending+="$$"),t.pos=n+1,!0):(r=i(t,s),r.can_close?(e||(a=t.push("math_inline","math",0),a.markup="$",a.content=t.src.slice(n,s)),t.pos=s+1,!0):(e||(t.pending+="$"),t.pos=n,!0))}function a(t,e,n,i){var s,a,r,o,c,l=!1,u=t.bMarks[e]+t.tShift[e],d=t.eMarks[e];if(u+2>d)return!1;if("$$"!==t.src.slice(u,u+2))return!1;if(u+=2,s=t.src.slice(u,d),i)return!0;for("$$"===s.trim().slice(-2)&&(s=s.trim().slice(0,-2),l=!0),r=e;!l;){if(r++,r>=n)break;if(u=t.bMarks[r]+t.tShift[r],d=t.eMarks[r],u<d&&t.tShift[r]<t.blkIndent)break;"$$"===t.src.slice(u,d).trim().slice(-2)&&(o=t.src.slice(0,d).lastIndexOf("$$"),a=t.src.slice(u,o),l=!0)}return t.line=r+1,c=t.push("math_block","math",0),c.block=!0,c.content=(s&&s.trim()?s+"\n":"")+t.getLines(e+1,r,t.tShift[e],!0)+(a&&a.trim()?a:""),c.map=[e,t.line],c.markup="$$",!0}function r(t){return c(t)}function o(t){return`<figure>${c(t)}</figure>`}function c(t){return`<img src="https://${window.location.host}/equation?tex=${encodeURIComponent(t)}" class="equation" alt="${t.replace(/"/g,"&quot;")}">`}t.exports=function(t,e){e=e||{};var n=function(t){return r(t)},i=function(t,e){return n(t[e].content.trim())},c=function(t){return o(t)},l=function(t,e){return c(t[e].content.trim())+"\n"};t.inline.ruler.after("escape","math_inline",s),t.block.ruler.after("blockquote","math_block",a,{alt:["paragraph","reference","blockquote","list"]}),t.renderer.rules.math_inline=i,t.renderer.rules.math_block=l}},"61c3":function(t,e,n){t.exports=n.p+"img/collapse.dbb05aef.svg"},6658:function(t,e,n){"use strict";var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"confirm-dialog-box"},[n("div",{staticClass:"confirm-dialog"},[n("div",{staticClass:"dialog-header"},[n("div",{staticClass:"dialog-title"},[t._v(t._s(t.title))]),n("button",{staticClass:"close-btn ion-close-round",attrs:{title:"关闭"},on:{click:t.cancel}})]),n("div",{staticClass:"dialog-body"},[n("div",{staticClass:"content"},[t._v(t._s(t.content))])]),n("div",{staticClass:"dialog-footer"},[n("button",{staticClass:"ctrl-btn cancel-btn",on:{click:t.cancel}},[t._v("取消")]),n("button",{staticClass:"ctrl-btn confirm-btn",on:{click:t.confirm}},[t._v("确定")])])])])},s=[],a={props:["title","content"],methods:{cancel(){this.$emit("cancel")},confirm(){this.$emit("confirm")}}},r=a,o=(n("6fc2"),n("2877")),c=Object(o["a"])(r,i,s,!1,null,"cd916810",null);e["a"]=c.exports},"676a":function(t,e,n){},6984:function(t,e,n){"use strict";n.r(e),n.d(e,"CLASS_NAME",(function(){return s})),n.d(e,"format",(function(){return a}));var i=n("a061");const s=Object(i["e"])("link");function a(t){t.querySelectorAll("a").forEach(t=>{t.classList.add(s)})}},"6a08":function(t,e,n){"use strict";n.d(e,"b",(function(){return r})),n.d(e,"a",(function(){return l}));var i=n("4791"),s=n.n(i),a=n("c5cc");async function r(t,e){const n=new s.a({userId:t,appId:2608,imageConfig:{serviceId:"k3u1fbpfcp"}});try{const t=await o(),i=e=>new Promise((i,s)=>{const a=n.addFile({file:e,stsToken:t,type:"image"});n.start(a),n.on("complete",t=>{i(t.uploadResult)}),n.on("error",t=>{s(t)})});let s=await Promise.all(e.map(async t=>{const e=await i(t);return e}));return s=await Promise.all(s.map(async t=>{const e=await c(t.Uri);return{ImageHeight:t.ImageHeight,ImageWidth:t.ImageWidth,Url:e.data.main_url}})),s}catch(i){throw new Error("上传图片失败")}}function o(){return Object(a["a"])({url:"/imagex/gen_token",query:{client:"web"}}).then(t=>{const e=t.data.token;return e})}function c(t){return Object(a["a"])({url:"/imagex/get_img_url",query:{uri:t}})}async function l(t){const e=t.startsWith("https:")||t.startsWith("http:")?t:"https:"+t,n={url:e},i=await fetch("/image/urlSave",{method:"POST",body:JSON.stringify(n),headers:{"Content-Type":"application/json"}}),s=await i.json();if(s.err_no)throw new Error(s.err_msg);return s}},"6a2e":function(t,e,n){"use strict";var i=n("886b"),s=n.n(i);s.a},"6b53":function(t,e,n){"use strict";var i=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"image-upload-progress-panel"},[i("img",{staticClass:"icon",attrs:{src:n("f9a5")}}),i("div",{staticClass:"text"},[t._v(t._s(t.text))]),t.allowCancel?i("button",{staticClass:"cancel-btn",on:{click:t.cancel}},[t._v(" 取消上传 ")]):t._e()])},s=[],a={props:{text:{default:"图片上传中"},allowCancel:{default:!0}},methods:{cancel(){this.$emit("cancel")}}},r=a,o=(n("9fb7"),n("2877")),c=Object(o["a"])(r,i,s,!1,null,"5e6e6023",null);e["a"]=c.exports},"6c54":function(t,e,n){"use strict";n.d(e,"e",(function(){return o})),n.d(e,"d",(function(){return c})),n.d(e,"a",(function(){return l})),n.d(e,"f",(function(){return u})),n.d(e,"b",(function(){return d})),n.d(e,"c",(function(){return h}));var i=n("7669"),s=n("bde8"),a=n("50c5"),r=n.n(a);function o(){return i["d"]()}function c(t){return i["c"](t)}function l(t){return i["a"](t)}function u(t){return i["f"](t)}function d(t){return i["b"](t)}function h(t){return Promise.resolve().then(()=>s["a"].fromDescriptor(Object.assign({title:"",tags:[],markdown:"markdown"===(null===t||void 0===t?void 0:t.type)?`---\n# 主题列表：${Object.keys(r.a).join(", ")}\n# 贡献主题：https://github.com/xitu/juejin-markdown-themes\ntheme: juejin\nhighlight:\n---\n\n`:"",html:"",cover_image:"",abstract:""},t)))}},"6f6b":function(t,e,n){},"6fc2":function(t,e,n){"use strict";var i=n("e234"),s=n.n(i);s.a},"705e":function(t,e,n){"use strict";n.d(e,"a",(function(){return S}));var i=n("d4cd"),s=n.n(i),a=n("bfe9"),r=n("ee10"),o=n("7cbb");function c(t,e,n){const i=t.renderer.rules[e]||l;t.renderer.rules[e]=function(t,e,s,a,r){return n(t,e,s,a,r,i)}}function l(t,e,n,i,s){return s.renderToken(t,e,n)}function u(t,e){c(t,"fence",d)}function d(t,e,n,i,s,a){const c=t[e],l=c.info.trim()||"bash",u=c.content;if("!"===l)return`<blockquote class="warning"><p>${Object(o["a"])(u)}</p></blockquote>`;{const t=Object(r["b"])(l,u);return`<pre><code lang="${l}" class="hljs ${l}">${t}</code></pre>`}}function h(t,e,n,i){const s=t[e].attrIndex(n);-1===s?t[e].attrPush([n,i]):t[e].attrs[s][1]=i}function f(t,e,n){const i=t[e].attrIndex(n);return-1===i?null:t[e].attrs[i][1]}function p(t,e){c(t,"heading_open",m)}function m(t,e,n,i,s,a){return h(t,e,"class","heading"),a(t,e,n,i,s)}function g(t,e){c(t,"image",b)}function b(t,e,n,i,s,a){const r=t[e],o=r.attrGet("title"),c=r.attrGet("src"),l=r.content;return["<figure><img",c?` src="${c}"`:"",l?` alt="${l}"`:"","><figcaption>",o||"","</figcaption></figure>"].join("")}function v(t,e){c(t,"link_open",_)}function _(t,e,n,i,s,a){const r=f(t,e,"target"),o=f(t,e,"href"),c=null!==r,l=0===(o||"").indexOf("#");return c||l||h(t,e,"target","_blank"),a(t,e,n,i,s)}var k=n("604c"),y=n.n(k),C=n("bc00"),w=n.n(C);const x=t=>{const e={},n=t.renderer.renderInline.bind(t.renderer);t.renderer.renderInline=function(t,i,s){let a=n(t,i,s);if((e["bullet_list"]||0)>0&&(e["list_item"]||0)>0){if(t[0].content.startsWith("[ ] "))return'<input type="checkbox" disabled /> '+a.substr(4);if(t[0].content.startsWith("[x] "))return'<input type="checkbox" disabled checked /> '+a.substr(4)}return a};const i=t.renderer.renderToken.bind(t.renderer);t.renderer.renderToken=function(t,n,s){let a=t[n],r=a.type;if(r.endsWith("_open")){let t=r.substr(0,r.length-5);e[t]=(e[t]||0)+1}else if(r.endsWith("_close")){let t=r.substr(0,r.length-6);e[t]=(e[t]||0)-1}return(e["bullet_list"]||0)>0&&"list_item_open"===r&&(t[n+2].content.startsWith("[ ] ")||t[n+2].content.startsWith("[x] "))&&a.attrPush(["class","task-list-item"]),i(t,n,s)}};var E=x,O=n("7d5c"),j=n.n(O);const T=new j.a;class S{constructor(){this.md=new s.a({html:!0,breaks:!1,linkify:!0,typographer:!1}).use(u).use(p).use(g).use(v).use(y.a).use(E).use(w.a),this.md.linkify.tlds(".py",!1)}toHtml(t){return Object(a["a"])(this.md.render(this.preprocessMarkdown(t)))}preprocessMarkdown(t){return(t||"").replace(/\u3000/g,"&emsp;")}fromHtml(t=""){return T.turndown(t)}}},7415:function(t,e,n){"use strict";var i=n("3b6d"),s=n.n(i);s.a},"745c":function(t,e,n){"use strict";var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"editor-switcher",class:{active:t.active},attrs:{"st:block":"editorSwitcher"}},[n("div",{staticClass:"toggle-btn",on:{click:function(e){t.active=!t.active}}},[n("i",{staticClass:"ion-ios-more"})]),n("div",{directives:[{name:"show",rawName:"v-show",value:t.active,expression:"active"}],staticClass:"panel",attrs:{"st:name":"switchBtn","st:state":t.currentState.to},on:{click:t.showDialog}},[t._v(" "+t._s(t.currentState.title)+" ")]),t.isDialogVisible?n("ConfirmDialog",{attrs:{title:t.currentState.title,content:t.currentState.content},on:{cancel:t.hideDialog,confirm:t.changeEditor}}):t._e()],1)},s=[],a=n("c5cc"),r=n("7bbb"),o=n("b8ba");function c(t,e){return r["a"]()?Object(a["a"])({url:"/user_api/v1/user/update",method:"post",body:{editor_type:e}}).then(t=>t.data):Promise.reject(Object(o["c"])())}function l(t){return c("editorType",t)}function u(t){return l(t)}function d(t){return u(t)}var h=n("6658");const f={markdown:{title:"切换为富文本编辑器",content:"切换写作模式后，当前内容不会迁移，但会自动保存为草稿。",to:"richText"},richText:{title:"切换为 Markdown 编辑器",content:"切换写作模式后，当前内容不会迁移，但会自动保存为草稿。",to:"markdown"}};var p={components:{ConfirmDialog:h["a"]},props:["type"],data:()=>({active:!1,isDialogVisible:!1}),computed:{currentState(){return f[this.type]}},methods:{showDialog(){this.isDialogVisible=!0,this.active=!1},hideDialog(){this.isDialogVisible=!1},changeEditor(){const t="markdown"===this.currentState.to?"md":"wysiwyg";d(t).then(()=>{window.location.href="/editor/drafts/new?v=2",this.hideDialog()}).catch(t=>{this.$error(t)})}},domEvents:{click({target:t}){this.$el.contains(t)||(this.active=!1)}}},m=p,g=(n("8db5"),n("2877")),b=Object(g["a"])(m,i,s,!1,null,"db25eab8",null);e["a"]=b.exports},7590:function(t,e,n){"use strict";n.d(e,"e",(function(){return r})),n.d(e,"d",(function(){return o})),n.d(e,"a",(function(){return c})),n.d(e,"b",(function(){return l})),n.d(e,"c",(function(){return u})),n.d(e,"f",(function(){return d}));var i=n("6c54"),s=n("7669");function a(t,e){return s["e"](t,e)}function r(){return i["e"]()}function o(t){return i["d"](t)}function c(t){return t.id?i["f"](t):i["a"](t).then(e=>{t.id=e.id})}function l(t){return i["b"](t)}function u(t){return i["c"](t)}function d(t,e){return a(t,e)}},"759c":function(t,e,n){"use strict";var i=n("a775"),s=n.n(i);s.a},7600:function(t,e,n){"use strict";var i=n("1684"),s=n.n(i);s.a},7669:function(t,e,n){"use strict";var i=n("e248");n.d(e,"d",(function(){return i["d"]})),n.d(e,"c",(function(){return i["c"]})),n.d(e,"a",(function(){return i["a"]})),n.d(e,"f",(function(){return i["f"]})),n.d(e,"b",(function(){return i["b"]})),n.d(e,"e",(function(){return i["e"]}))},"77f5":function(t,e,n){},"7a61":function(t,e,n){"use strict";n.d(e,"a",(function(){return r}));var i=n("a061");var s=n("9db5"),a=n("ee10");function r(t){const e=document.createElement("div");return e.innerHTML="string"===typeof t?t:t.outerHTML,o(e),e.innerHTML}function o(t){if(Object(i["c"])(t))t.parentNode.removeChild(t);else{if(Object(i["d"])(t))return Array.prototype.slice.call(t.childNodes).reverse().forEach(e=>{t.parentNode.insertBefore(e,t)}),void t.parentNode.removeChild(t);if(t.className){const e=t.className.split(/\s+/).filter(t=>!Object(i["b"])(t)).join(" ");e?t.className=e:t.removeAttribute("class")}"PRE"!==t.nodeName?([].slice.call(t.attributes||[]).forEach(e=>{Object(i["a"])(e.name)&&t.removeAttribute(e.name)}),Array.prototype.slice.call(t.childNodes).forEach(o)):c(t)}}function c(t){const e=t.getAttribute(s["LANG_ATTR_NAME"])||s["DEFAULT_LANG"];t.classList.add("hljs"),t.classList.add(e),t.innerHTML=`<code class="hljs ${e}" lang="${e}">`+Object(a["b"])(e,t.innerText)+"</code>"}},"7a82":function(t,e,n){"use strict";var i=n("a3a9"),s=n.n(i);s.a},"7ae6":function(t,e,n){t.exports=n.p+"img/extend.ec7370cb.svg"},"7bbb":function(t,e,n){"use strict";n.d(e,"c",(function(){return o})),n.d(e,"a",(function(){return d})),n.d(e,"b",(function(){return h}));var i=n("c5cc");async function s(){return Object(i["a"])({url:"/user_api/v1/user/get",method:"get",query:{aid:2608,not_self:0}}).then(t=>Object.assign({},{user:t.data}))}let a=null,r=!1;function o(t){return r?Promise.resolve(h()):(r=!0,c(t).then(u).then(l).then(h))}function c(t){return Promise.resolve().then(()=>{a=t})}function l(){return Promise.resolve().then(()=>{window.setInterval(u,6e5)})}function u(){return s().then(t=>a.dispatch(a.types.SET_AUTH_INFO,t))}function d(){return!0}function h(){return a.state.auth}},"7c64":function(t,e,n){"use strict";n.r(e),n.d(e,"SET_AUTH_INFO",(function(){return i})),n.d(e,"AUTH_INFO",(function(){return s})),n.d(e,"USER",(function(){return a})),n.d(e,"SET_ERROR_VIEW",(function(){return r})),n.d(e,"ERROR_VIEW",(function(){return o})),n.d(e,"MARKDOWN_LAYOUT",(function(){return c})),n.d(e,"TOGGLE_MARKDOWN_LAYOUT",(function(){return l})),n.d(e,"XIAOCE_LAYOUT",(function(){return u})),n.d(e,"TOGGLE_XIAOCE_LAYOUT",(function(){return d})),n.d(e,"XIAOCE_SUMMARY_LAYOUT",(function(){return h})),n.d(e,"TOGGLE_XIAOCE_SUMMARY_LAYOUT",(function(){return f})),n.d(e,"XIAOCE_DRAFT",(function(){return p}));const i="SET_AUTH_INFO",s="AUTH_INFO",a="USER",r="SET_ERROR_VIEW",o="ERROR_VIEW",c="MARKDOWN_LAYOUT",l="TOGGLE_MARKDOWN_LAYOUT",u="XIAOCE_LAYOUT",d="TOGGLE_XIAOCE_LAYOUT",h="XIAOCE_SUMMARY_LAYOUT",f="TOGGLE_XIAOCE_SUMMARY_LAYOUT",p="XIAOCE_DRAFT"},"7cbb":function(t,e,n){"use strict";n.d(e,"a",(function(){return s}));var i=n("b9bf");function s(t){return Object(i["htmlEncode"])(t||"")}},"7e48":function(t,e,n){"use strict";n.d(e,"b",(function(){return r})),n.d(e,"d",(function(){return o})),n.d(e,"c",(function(){return c})),n.d(e,"h",(function(){return l})),n.d(e,"a",(function(){return u})),n.d(e,"e",(function(){return d})),n.d(e,"i",(function(){return h})),n.d(e,"g",(function(){return f})),n.d(e,"f",(function(){return p}));var i=n("c5cc");const s={title:1,cover_img:2,status:3,summary:4,finished_time:5,section_ids:6,is_finished:7,category_id:8},a={title:1,content:2,markdown_content:2,status:3,is_free:4};function r(){return Object(i["a"])({url:"/booklet_api/v1/booklet/create",method:"post",body:{}}).then(t=>t.data)}function o({cursor:t}={cursor:0}){return Object(i["a"])({url:"/booklet_api/v1/booklet/draft_list",method:"post",body:{cursor:Number(t),limit:20}})}function c({booklet_id:t}){return Object(i["a"])({url:"/booklet_api/v1/booklet/draft",method:"post",body:{booklet_id:String(t)}}).then(t=>t.data)}function l({booklet_id:t,title:e,summary:n,status:a,is_finished:r,cover_img:o,section_ids:c,category_id:l,change_field:u}){return Object(i["a"])({url:"/booklet_api/v1/booklet/update",method:"post",body:{booklet_id:String(t),title:e&&String(e),summary:n&&String(n),status:a,is_finished:r,cover_img:o,section_ids:c&&String(c),category_id:l&&String(l),change_field:s[u]}}).then(t=>t.data)}function u({booklet_id:t,title:e}){return Object(i["a"])({url:"/booklet_api/v1/section/add",method:"post",body:{booklet_id:String(t),title:e&&String(e)}}).then(t=>t.data)}function d({section_id:t}){return Object(i["a"])({url:"/booklet_api/v1/section/draft",method:"post",body:{section_id:String(t)}}).then(t=>t.data)}function h({section_id:t,title:e,content:n,markdown_content:s,status:r,is_free:o,change_field:c}){return Object(i["a"])({url:"/booklet_api/v1/section/update",method:"post",body:{section_id:t&&String(t),title:e&&String(e),content:n&&String(n),markdown_content:s&&String(s),status:r,is_free:o,change_field:a[c]},showError:!1})}function f({booklet_id:t}){return Object(i["a"])({url:"/booklet_api/v1/booklet/submit",method:"post",body:{booklet_id:t&&String(t)}}).then(t=>t.data)}function p({show_type:t}={show_type:2}){return Object(i["a"])({url:"/tag_api/v1/query_category_briefs",method:"get",query:{show_type:t}}).then(t=>t.data)}},"7e9c":function(t,e,n){},"7f42":function(t,e,n){"use strict";n.r(e),n.d(e,"CLASS_NAME",(function(){return s})),n.d(e,"format",(function(){return a}));var i=n("a061");const s=Object(i["e"])("bold");function a(t){t.querySelectorAll("b").forEach(t=>{t.classList.add(s)})}},8075:function(t,e,n){},"80e9":function(t,e,n){},8199:function(t,e,n){},"81ba":function(t,e,n){},8690:function(t,e,n){"use strict";n.d(e,"c",(function(){return s})),n.d(e,"g",(function(){return r})),n.d(e,"f",(function(){return o})),n.d(e,"b",(function(){return c})),n.d(e,"h",(function(){return l})),n.d(e,"e",(function(){return u})),n.d(e,"d",(function(){return d})),n.d(e,"a",(function(){return h}));var i=n("c34c");function s(t){const e=a().height,n=t.getBoundingClientRect().bottom;return e-n}function a(){const t=document.documentElement;return{width:Math.max(t.clientWidth,window.innerWidth||0),height:Math.max(t.clientHeight,window.innerHeight||0)}}function r(t,e,n=100){const s=Object(i["b"])(e,n);return t.addEventListener("mousewheel",s,!1),t.addEventListener("DOMMouseScroll",s,!1),function(){t.removeEventListener("mousewheel",s,!1),t.removeEventListener("DOMMouseScroll",s,!1)}}function o(t,e,n,i=!1){return t.addEventListener(e,n,i),function(){t.removeEventListener(e,n,i)}}function c(t,e){const n=window.getSelection(),i=document.createRange();i.selectNode(t),i.collapse(e),n.removeAllRanges(),n.addRange(i)}function l(t){const e=window.getSelection(),n=document.createRange();n.selectNode(t),e.removeAllRanges(),e.addRange(n)}function u(t,e){e=e||document.body;const n=e.getBoundingClientRect(),i=t.getBoundingClientRect();return{top:i.top-n.top,left:i.left-n.left}}function d(t,e){while(t){if(t.nodeName===e)return t;t=t.parentNode}return null}function h(t){try{const e=(new window.DOMParser).parseFromString(t,"text/html");return e.body}catch(e){const n=document.implementation.createHTMLDocument("");return n.body.innerHTML=t,n.body}}},8780:function(t,e,n){"use strict";var i=n("1ec1"),s=n.n(i);s.a},"886b":function(t,e,n){},8896:function(t,e,n){"use strict";n.d(e,"a",(function(){return s})),n.d(e,"b",(function(){return c}));const i=[{name:"jpg",regx:/^ffd8ff/},{name:"gif",regx:/^474946/},{name:"png",regx:/89504e47/},{name:"webp",regx:/52494646/},{name:"bmp",regx:/^424d/},{name:"any",regx:/./}];function s(t,e){return a(t).then(r).then(o.bind(null,e))}function a(t){return new Promise((e,n)=>{let i=new window.FileReader;i.onload=t=>e(t.target.result),i.onerror=t=>n(t),i.readAsArrayBuffer(t.slice(0,64))})}function r(t){return Array.prototype.slice.call(new Uint8Array(t)).reduce((t,e)=>t+e.toString(16),"")}function o(t,e){for(let n=0;n<i.length;n++)if(i[n].regx.test(e))return-1!==t.indexOf(i[n].name);return!1}function c(t){return new Promise((e,n)=>{if("undefined"===typeof window.FileReader)return void n(new Error("浏览器不支持 FileReader，请升级浏览器"));const i=new window.FileReader;i.onerror=()=>{n(new Error("文件读取失败"))},i.onload=()=>{e(i.result)},i.readAsText(t)})}},"88f3":function(t,e,n){"use strict";var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"markdown-editor",attrs:{"st:block":"markdownEditor"}},[n("EditorHeader",{ref:"header",attrs:{guided:t.guided,post:t.post,status:t.status},on:{titleSubmit:t.onTitleSubmit,publish:t.publish}}),n("Editor",{staticClass:"main",class:{extended:t.extended},attrs:{mode:t.extended?"tab":"split",value:t.post.markdown,plugins:t.plugins,sanitize:t.sanitize,editorConfig:{placeholder:"开始写作"}},on:{change:t.handleChange}}),n("div",{staticClass:"footer"},[n("EditorFooter",{staticClass:"editor-footer",on:{uploadImage:t.openImageFileDialog}}),n("input",{ref:"fileInput",staticStyle:{display:"none"},attrs:{type:"file"},on:{input:t.handleFileInput}}),t.extended?t._e():n("PreviewFooter",{attrs:{wordCount:t.wordCount}})],1),t.imageLoading?n("ImageUploadProgressPanel",{attrs:{text:"图片解析中...",allowCancel:!1}}):t._e()],1)},s=[],a=n("e022"),r=n("c34c"),o=n("cecb"),c=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("header",{staticClass:"header editor-header",class:{extended:t.extended},attrs:{"st:block":"editorHeader"}},[t._m(0),n("TitleInput",{staticClass:"title-input",attrs:{value:t.post.title},on:{input:t.onTitleUpdate,submit:function(e){return t.$emit("titleSubmit")}}}),t.guided?n("div",{staticClass:"right-box"},[n("EditorSwitcher",{staticClass:"editor-switcher with-padding",attrs:{type:"markdown"}}),n("NewButton",{staticClass:"new-button with-padding"}),n("MainNavigator",{staticClass:"main-navigator with-padding"})],1):n("div",{staticClass:"right-box"},[n("StatusText",{staticClass:"status-text with-padding",attrs:{status:t.status}}),n("MainImageSelector",{staticClass:"main-image-selector with-padding",attrs:{post:t.post}}),n("EditorSwitcher",{staticClass:"editor-switcher with-padding",attrs:{type:"markdown"}}),n("PublishPopup",{staticClass:"publish-popup with-padding",attrs:{post:t.post,disabled:"saving"===t.status},on:{publish:t.publish}}),n("MainNavigator",{staticClass:"main-navigator with-padding"})],1)],1)},l=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"left-box"},[n("div",{staticClass:"logo"})])}],u=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("input",{directives:[{name:"model",rawName:"v-model",value:t.innerValue,expression:"innerValue"}],ref:"input",staticClass:"title-input",attrs:{placeholder:"输入文章标题...",spellcheck:"false",maxlength:t.maxlength},domProps:{value:t.innerValue},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.$emit("submit")},input:function(e){e.target.composing||(t.innerValue=e.target.value)}}})},d=[],h=n("3bba"),f={props:["value"],data:()=>({maxlength:h["a"],innerValue:""}),watch:{value:{handler(t,e){this.innerValue=t},immediate:!0},innerValue(t,e){this.$emit("input",t)}},mounted(){this.$refs.input.focus()}},p=f,m=(n("f673"),n("2877")),g=Object(m["a"])(p,u,d,!1,null,"4c4c7500",null),b=g.exports,v=n("8bb0"),_=n("1595"),k=n("745c"),y=n("0524"),C=n("e0a3"),w=n("3d66"),x={components:{TitleInput:b,StatusText:v["a"],MainImageSelector:_["a"],EditorSwitcher:k["a"],PublishPopup:y["a"],MainNavigator:C["a"],NewButton:w["a"]},props:["guided","post","status"],computed:{extended(){return"extended"===this.$store.getters.MARKDOWN_LAYOUT}},methods:{onTitleUpdate(t){this.post.title=t},publish(){this.$emit("publish")}}},E=x,O=(n("dfb8"),Object(m["a"])(E,c,l,!1,null,"0631f5e2",null)),j=O.exports,T=n("3dc0"),S=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"editor-footer",class:{extended:t.extended}},[i("button",{staticClass:"ctrl-btn shotcut-btn"},[i("img",{staticClass:"icon",attrs:{src:n("35ca")}}),i("ShotcutPanel",{staticClass:"shotcut-panel"})],1),i("button",{staticClass:"ctrl-btn upload-image-btn",attrs:{title:"点击上传图片"},on:{click:t.uploadImage}},[i("img",{staticClass:"icon",attrs:{src:n("d5d1c")}})]),i("a",{staticClass:"guide-link",attrs:{href:"/book/5c90640c5188252d7941f5bb/section/"+t.link.href,target:"_blank"}},[t._v(" "+t._s(t.link.text)+" ")]),i("button",{staticClass:"ctrl-btn toggle-layout-btn",attrs:{title:t.extended?"点击恢复预览区":"点击隐藏预览区"},on:{click:t.toggleLayout}},[i("img",{directives:[{name:"show",rawName:"v-show",value:t.extended,expression:"extended"}],staticClass:"icon",attrs:{src:n("61c3")}}),i("img",{directives:[{name:"show",rawName:"v-show",value:!t.extended,expression:"!extended"}],staticClass:"icon",attrs:{src:n("7ae6")}})])])},A=[],L=function(){var t=this,e=t.$createElement;t._self._c;return t._m(0)},I=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"shotcut-panel"},[n("span",{staticClass:"panel-title"},[t._v("快捷键")]),n("a",{staticClass:"more-link",attrs:{href:"/book/5c90640c5188252d7941f5bb/section/5c9066395188252d71681c5d",target:"_blank"}},[t._v(" 更多语法 ")]),n("table",{staticClass:"shotcut-table"},[n("thead",[n("tr",[n("th",[t._v("Markdown")]),n("th",[t._v("结果")]),n("th",[t._v("快捷键")])])]),n("tbody",[n("tr",[n("td",[t._v("# 标题")]),n("td",[t._v("H1")]),n("td")]),n("tr",[n("td",[t._v("## 标题")]),n("td",[t._v("H2")]),n("td",[t._v("Ctrl / ⌘ + H")])]),n("tr",[n("td",[t._v("**文本**")]),n("td",[n("b",[t._v("粗体")])]),n("td",[t._v("Ctrl / ⌘ + B")])]),n("tr",[n("td",[t._v("[描述](http://)")]),n("td",[n("a",[t._v("链接")])]),n("td",[t._v("Ctrl / ⌘ + K")])]),n("tr",[n("td",[t._v("`code`")]),n("td",[n("code",[t._v("Inline Code")])]),n("td",[t._v("Ctrl / ⌘ + Shift + K")])]),n("tr",[n("td",[t._v("```code```")]),n("td",[n("pre",[t._v("Code")])]),n("td",[t._v("Ctrl / ⌘ + Shift + C")])]),n("tr",[n("td",[t._v("![alt](http://)")]),n("td",[t._v("图片")]),n("td",[t._v("Ctrl / ⌘ + Shift + I")])]),n("tr",[n("td",[t._v("* item")]),n("td",[t._v("列表")]),n("td",[t._v("Ctrl / ⌘ + Shift + L")])])])])])}],$=(n("c284"),{}),D=Object(m["a"])($,L,I,!1,null,"6f1bdaae",null),N=D.exports;const M=[{text:"让文章获得更多曝光",href:"5c9064f45188252d7e34d615"},{text:"了解社区规范",href:"5cb04a4e5188251ae4157867"}];var P={components:{ShotcutPanel:N},data:()=>({link:M[Math.floor(Math.random()*M.length)]}),computed:{extended(){return"extended"===this.$store.getters.MARKDOWN_LAYOUT}},methods:{toggleLayout(){this.$store.dispatch(this.$store.types.TOGGLE_MARKDOWN_LAYOUT)},uploadImage(){this.$emit("uploadImage")}}},U=P,R=(n("7415"),Object(m["a"])(U,S,A,!1,null,"a28e2374",null)),F=R.exports,H=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"preview-footer"},[n("div",{staticClass:"title"},[t._v("预览")]),n("div",{staticClass:"word-count",class:{isLimited:t.isLimited}},[t._v(t._s(t.displayWordCount))])])},B=[],q={props:["wordCount"],computed:{displayWordCount(){return this.wordCount?this.wordCount+" 字":"字数"},isLimited(){return this.wordCount&&this.wordCount>o["b"]}}},z=q,V=(n("3348"),Object(m["a"])(z,H,B,!1,null,"12760342",null)),X=V.exports,G=n("ea37"),W=n("6a08"),Y=n("1b28"),K=n("64ed"),J=n("6b53"),Q={components:{EditorHeader:j,Editor:T["Editor"],EditorFooter:F,PreviewFooter:X,ImageUploadProgressPanel:J["a"]},props:["guided","post","status"],data(){const t=this;return{imageLoading:!1,plugins:[...Y["a"],{editorEffect:({editor:t})=>{this.cm=t}},Object(Y["c"])({onLoadingChange(e){t.imageLoading=e},catchError(){t.$error("图片地址解析失败")}})]}},computed:{extended(){return"extended"===this.$store.getters.MARKDOWN_LAYOUT},wordCount(){return Object(G["b"])(this.post.markdown)},notNeedConfirmedUpdate(){return[this.post.title,this.post.category,this.post.tags,this.post.cover_image,this.post.markdown]}},watch:{notNeedConfirmedUpdate(){this.requestUpdate()}},created(){this.requestUpdate=Object(r["a"])(()=>{this.guided||this.update()},o["a"])},methods:{sanitize(t){const e=JSON.parse(JSON.stringify(t));return e.tagNames.push("section"),e.attributes["*"].push("style"),e},handleChange(t){this.post.markdown=t},async fileHandler(t){const e=await Object(W["b"])("",[t]);return e[0].Url},openImageFileDialog(){this.$refs.fileInput.click()},async handleFileInput(t){try{const e=t.target,n=this.cm;if(!e.files||!e.files.length)return;const i=e.files[0],s=await this.fileHandler(i),a=n.getSelection();n.replaceSelection(`![${a}](${s})`),n.focus()}catch(e){this.$error(e)}},onTitleSubmit(){},update(){const t=Object(K["getProcessor"])({}).processSync(this.post.markdown).toString();this.post.html="deprecated",this.post.brief_content=Object(a["a"])(t),this.$emit("update")},publish(){this.$emit("publish")}}},Z=Q,tt=(n("0506"),n("39f1"),n("8ebf"),Object(m["a"])(Z,i,s,!1,null,"3b72bea0",null));e["a"]=tt.exports},"8a69":function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));class i{}i.fromDescriptor=function(t){return t?Object.assign(new i,t,{title:t.title?t.title:t.tag_name}):null}},"8aea":function(t,e,n){t.exports=n.p+"img/editor-more.6937009a.svg"},"8bb0":function(t,e,n){"use strict";var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"status-text",attrs:{title:t.title},domProps:{innerHTML:t._s(t.html)}})},s=[];const a='文章将会自动保存至<a href="/editor/drafts">草稿</a>';var r={props:["status"],data:()=>({html:a,lastSaveTime:null}),computed:{title(){return this.lastSaveTime?"最近保存于 "+this.lastSaveTime.toLocaleString():""}},watch:{status(){switch(this.status){case"saving":this.html="保存中...";break;case"error":this.html="出现错误";break;case"editing":this.html='已保存至<a href="/editor/drafts">草稿</a>',this.lastSaveTime=new Date;break;default:this.html=a}}}},o=r,c=(n("ab26"),n("2877")),l=Object(c["a"])(o,i,s,!1,null,"df49ce58",null);e["a"]=l.exports},"8db5":function(t,e,n){"use strict";var i=n("ec8c"),s=n.n(i);s.a},"8e2d":function(t,e,n){},"8ebf":function(t,e,n){"use strict";var i=n("676a"),s=n.n(i);s.a},"8f0a":function(t,e,n){},9221:function(t,e,n){"use strict";var i=n("43b4"),s=n.n(i);s.a},"95c6":function(t,e,n){},"964c":function(t,e,n){"use strict";n.d(e,"b",(function(){return s})),n.d(e,"a",(function(){return a}));const i=window.localStorage;function s(t,e){return i.setItem(t,JSON.stringify(e))}function a(t){return JSON.parse(i.getItem(t))}},"992a":function(t,e,n){t.exports=n.p+"img/md.555fde04.svg"},"9af7":function(t,e,n){},"9b04":function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var i=n("c1df"),s=n.n(i);function a(t,e){return s()(t).format(e)}},"9bdd":function(t,e,n){},"9db5":function(t,e,n){"use strict";n.r(e),n.d(e,"CLASS_NAME",(function(){return s})),n.d(e,"LANG_ATTR_NAME",(function(){return a})),n.d(e,"DEFAULT_LANG",(function(){return r})),n.d(e,"format",(function(){return o}));var i=n("a061");const s=Object(i["e"])("highlight"),a="code-lang",r="bash";function o(t){t.querySelectorAll("pre").forEach(t=>{t.classList.add(s)})}},"9fb7":function(t,e,n){"use strict";var i=n("8e2d"),s=n.n(i);s.a},a061:function(t,e,n){"use strict";n.d(e,"e",(function(){return o})),n.d(e,"b",(function(){return c})),n.d(e,"a",(function(){return l})),n.d(e,"d",(function(){return u})),n.d(e,"c",(function(){return d}));const i="juejin-editor-",s="juejin-editor-",a="is-juejin-editor-element",r="is-juejin-editor-container";function o(t){return`${i}${t}`}function c(t){return 0===t.indexOf(i)}function l(t){return 0===t.indexOf(s)}function u(t){return t.hasAttribute&&t.hasAttribute(a)}function d(t){return t.hasAttribute&&t.hasAttribute(r)}},a0bb:function(t,e,n){"use strict";var i=n("9bdd"),s=n.n(i);s.a},a0d4:function(t,e,n){},a175:function(t,e,n){"use strict";var i=n("da4a"),s=n.n(i);s.a},a1fe:function(t,e,n){"use strict";var i=n("ee38"),s=n.n(i);s.a},a3a9:function(t,e,n){},a4f5:function(t,e,n){},a775:function(t,e,n){},a9cf:function(t,e,n){"use strict";n.d(e,"a",(function(){return r}));var i=n("453e");i["a"];var s=n("3b5f"),a=n.n(s);n("db82"),n("b8ba");new a.a({bucket:"gold-user-assets"});function r(t){return Promise.resolve()}},ab26:function(t,e,n){"use strict";var i=n("bf1c"),s=n.n(i);s.a},abd9:function(t,e,n){"use strict";n.r(e),n.d(e,"BLOCK_LEVEL_ELEMENT_LIST",(function(){return i})),n.d(e,"VOID_ELEMENT_LIST",(function(){return s})),n.d(e,"CHAR_MAP",(function(){return a}));const i=["ADDRESS","ARTICLE","ASIDE","BLOCKQUOTE","CANVAS","DD","DIV","DL","DT","FIELDSET","FIGCAPTION","FIGURE","FIGCAPTION","FOOTER","FORM","H1","H2","H3","H4","H5","H6","HEADER","HGROUP","HR","LI","MAIN","NAV","NOSCRIPT","OL","OUTPUT","P","PRE","SECTION","TABLE","TFOOT","UL","VIDEO"],s=["AREA","BASE","BR","COL","EMBED","HR","IMG","INPUT","KEYGEN","LINK","MENUITEM","META","PARAM","SOURCE","TRACK","WBR"],a={"&quot;":'"',"&#34;":'"',"&amp;":"&","&#38;":"&","&lt;":"<","&#60;":"<","&gt;":">","&#62;":">","&nbsp;":" ","&#160;":" "}},ad56:function(t,e,n){"use strict";var i=n("e151"),s=n.n(i);s.a},ae73:function(t,e,n){"use strict";var i=n("ca2a"),s=n.n(i);s.a},b8ba:function(t,e,n){"use strict";n.d(e,"b",(function(){return i})),n.d(e,"a",(function(){return s})),n.d(e,"c",(function(){return a}));function i(t){return s(t||"not found",404)}function s(t,e,n){return n=n||new Error(t||"error"),n.normalizedCode=e||500,n}function a(t){const e=new Error(t||"unauthorized");return e.normalizedCode=401,e}},bafc:function(t,e,n){"use strict";var i=n("c80e"),s=n.n(i);s.a},bc00:function(t,e,n){"use strict";function i(t,e,n,i){var s=Number(t[e].meta.id+1).toString(),a="";return"string"===typeof i.docId&&(a="-"+i.docId+"-"),a+s}function s(t,e){var n=Number(t[e].meta.id+1).toString();return t[e].meta.subId>0&&(n+=":"+t[e].meta.subId),"["+n+"]"}function a(t,e,n,i,s){var a=s.rules.footnote_anchor_name(t,e,n,i,s),r=s.rules.footnote_caption(t,e,n,i,s),o=a;return t[e].meta.subId>0&&(o+=":"+t[e].meta.subId),'<sup class="footnote-ref"><a href="#fn'+a+'" id="fnref'+o+'">'+r+"</a></sup>"}function r(t,e,n){return(n.xhtmlOut?'<hr class="footnotes-sep" />\n':'<hr class="footnotes-sep">\n')+'<section class="footnotes">\n<ol class="footnotes-list">\n'}function o(){return"</ol>\n</section>\n"}function c(t,e,n,i,s){var a=s.rules.footnote_anchor_name(t,e,n,i,s);return t[e].meta.subId>0&&(a+=":"+t[e].meta.subId),'<li id="fn'+a+'" class="footnote-item">'}function l(){return"</li>\n"}function u(t,e,n,i,s){var a=s.rules.footnote_anchor_name(t,e,n,i,s);return t[e].meta.subId>0&&(a+=":"+t[e].meta.subId),' <a href="#fnref'+a+'" class="footnote-backref">↩︎</a>'}t.exports=function(t){var e=t.helpers.parseLinkLabel,n=t.utils.isSpace;function d(t,e,i,s){var a,r,o,c,l,u,d,h,f,p,m,g=t.bMarks[e]+t.tShift[e],b=t.eMarks[e];if(g+4>b)return!1;if(91!==t.src.charCodeAt(g))return!1;if(94!==t.src.charCodeAt(g+1))return!1;for(l=g+2;l<b;l++){if(32===t.src.charCodeAt(l))return!1;if(93===t.src.charCodeAt(l))break}if(l===g+2)return!1;if(l+1>=b||58!==t.src.charCodeAt(++l))return!1;if(s)return!0;l++,t.env.footnotes||(t.env.footnotes={}),t.env.footnotes.refs||(t.env.footnotes.refs={}),u=t.src.slice(g+2,l-2),t.env.footnotes.refs[":"+u]=-1,d=new t.Token("footnote_reference_open","",1),d.meta={label:u},d.level=t.level++,t.tokens.push(d),a=t.bMarks[e],r=t.tShift[e],o=t.sCount[e],c=t.parentType,m=l,h=f=t.sCount[e]+l-(t.bMarks[e]+t.tShift[e]);while(l<b){if(p=t.src.charCodeAt(l),!n(p))break;9===p?f+=4-f%4:f++,l++}return t.tShift[e]=l-m,t.sCount[e]=f-h,t.bMarks[e]=m,t.blkIndent+=4,t.parentType="footnote",t.sCount[e]<t.blkIndent&&(t.sCount[e]+=t.blkIndent),t.md.block.tokenize(t,e,i,!0),t.parentType=c,t.blkIndent-=4,t.tShift[e]=r,t.sCount[e]=o,t.bMarks[e]=a,d=new t.Token("footnote_reference_close","",-1),d.level=--t.level,t.tokens.push(d),!0}function h(t,n){var i,s,a,r,o,c=t.posMax,l=t.pos;return!(l+2>=c)&&(94===t.src.charCodeAt(l)&&(91===t.src.charCodeAt(l+1)&&(i=l+2,s=e(t,l+1),!(s<0)&&(n||(t.env.footnotes||(t.env.footnotes={}),t.env.footnotes.list||(t.env.footnotes.list=[]),a=t.env.footnotes.list.length,t.md.inline.parse(t.src.slice(i,s),t.md,t.env,o=[]),r=t.push("footnote_ref","",0),r.meta={id:a},t.env.footnotes.list[a]={tokens:o}),t.pos=s+1,t.posMax=c,!0))))}function f(t,e){var n,i,s,a,r,o=t.posMax,c=t.pos;if(c+3>o)return!1;if(!t.env.footnotes||!t.env.footnotes.refs)return!1;if(91!==t.src.charCodeAt(c))return!1;if(94!==t.src.charCodeAt(c+1))return!1;for(i=c+2;i<o;i++){if(32===t.src.charCodeAt(i))return!1;if(10===t.src.charCodeAt(i))return!1;if(93===t.src.charCodeAt(i))break}return i!==c+2&&(!(i>=o)&&(i++,n=t.src.slice(c+2,i-1),"undefined"!==typeof t.env.footnotes.refs[":"+n]&&(e||(t.env.footnotes.list||(t.env.footnotes.list=[]),t.env.footnotes.refs[":"+n]<0?(s=t.env.footnotes.list.length,t.env.footnotes.list[s]={label:n,count:0},t.env.footnotes.refs[":"+n]=s):s=t.env.footnotes.refs[":"+n],a=t.env.footnotes.list[s].count,t.env.footnotes.list[s].count++,r=t.push("footnote_ref","",0),r.meta={id:s,subId:a,label:n}),t.pos=i,t.posMax=o,!0)))}function p(t){var e,n,i,s,a,r,o,c,l,u,d=!1,h={};if(t.env.footnotes&&(t.tokens=t.tokens.filter((function(t){return"footnote_reference_open"===t.type?(d=!0,l=[],u=t.meta.label,!1):"footnote_reference_close"===t.type?(d=!1,h[":"+u]=l,!1):(d&&l.push(t),!d)})),t.env.footnotes.list)){for(r=t.env.footnotes.list,o=new t.Token("footnote_block_open","",1),t.tokens.push(o),e=0,n=r.length;e<n;e++){for(o=new t.Token("footnote_open","",1),o.meta={id:e,label:r[e].label},t.tokens.push(o),r[e].tokens?(c=[],o=new t.Token("paragraph_open","p",1),o.block=!0,c.push(o),o=new t.Token("inline","",0),o.children=r[e].tokens,o.content="",c.push(o),o=new t.Token("paragraph_close","p",-1),o.block=!0,c.push(o)):r[e].label&&(c=h[":"+r[e].label]),t.tokens=t.tokens.concat(c),a="paragraph_close"===t.tokens[t.tokens.length-1].type?t.tokens.pop():null,s=r[e].count>0?r[e].count:1,i=0;i<s;i++)o=new t.Token("footnote_anchor","",0),o.meta={id:e,subId:i,label:r[e].label},t.tokens.push(o);a&&t.tokens.push(a),o=new t.Token("footnote_close","",-1),t.tokens.push(o)}o=new t.Token("footnote_block_close","",-1),t.tokens.push(o)}}t.renderer.rules.footnote_ref=a,t.renderer.rules.footnote_block_open=r,t.renderer.rules.footnote_block_close=o,t.renderer.rules.footnote_open=c,t.renderer.rules.footnote_close=l,t.renderer.rules.footnote_anchor=u,t.renderer.rules.footnote_caption=s,t.renderer.rules.footnote_anchor_name=i,t.block.ruler.before("reference","footnote_def",d,{alt:["paragraph","reference"]}),t.inline.ruler.after("image","footnote_inline",h),t.inline.ruler.after("footnote_inline","footnote_ref",f),t.core.ruler.after("inline","footnote_tail",p)}},bc2f:function(t,e,n){"use strict";var i=n("df41"),s=n.n(i);s.a},bde8:function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var i=n("e974"),s=n("8a69");class a{static fromDescriptor(t,e){if(!t)return null;let n={};return"detail"===e?(t.article_draft=t.article_draft||{},n=Object.assign(new a,Object.assign(Object.assign(Object.assign(Object.assign({},t.article_draft),t.author_user_info),t.user_interact),{type:t.article_draft.edit_type,abstract:t.article_draft.brief_content,tags:(t.tags||[]).map(s["a"].fromDescriptor),category:i["a"].fromServerDescriptor(t.category),createdAt:t.article_draft.ctime&&new Date(Number(1e3*t.article_draft.ctime)),updatedAt:t.article_draft.mtime&&new Date(Number(1e3*t.article_draft.mtime)),html:t.article_draft.html_content,markdown:t.article_draft.mark_content}))):n=Object.assign(new a,t,{id:t.id,abstract:t.brief_content},{tags:(t.tags||[]).map(s["a"].fromDescriptor),category:i["a"].fromServerDescriptor({id:t.category_id,name:t.category_name,isSubscribe:t.isSubscribe}),createdAt:t.ctime&&new Date(Number(1e3*t.ctime)),updatedAt:t.mtime&&new Date(Number(1e3*t.mtime))}),n}}},be41:function(t,e,n){},be86:function(t,e,n){t.exports=n.p+"img/md.555fde04.svg"},bf1c:function(t,e,n){},bf5f:function(t,e,n){t.exports=n.p+"img/move-icon.5b802847.svg"},bfe9:function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var i=n("b23e"),s=n.n(i);function a(t){return s.a.sanitize(t,{ADD_ATTR:["autoplay","controls","loop","preload","target"],FORBID_TAGS:["style"]})}},c019:function(t,e,n){"use strict";var i=n("00b7"),s=n.n(i);s.a},c284:function(t,e,n){"use strict";var i=n("81ba"),s=n.n(i);s.a},c32a:function(t,e,n){"use strict";n.r(e);var i=function(){var t=this,e=t.$createElement;t._self._c;return t._m(0)},s=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"view not-found-view"},[n("h1",[t._v("404")]),n("p",[t._v("此页面不存在")])])}],a={metaInfo(){return{title:"此页面不存在"}}},r=a,o=(n("ee80"),n("2877")),c=Object(o["a"])(r,i,s,!1,null,"a789e520",null);e["default"]=c.exports},c34c:function(t,e,n){"use strict";function i(t,e){let n=0;return e/=2,function(...i){Date.now()-n>=e&&setTimeout(()=>{t.apply(null,i),n=Date.now()},e)}}function s(t,e){let n=0;return function(...i){clearTimeout(n),n=setTimeout(()=>t.apply(this,i),e)}}n.d(e,"b",(function(){return i})),n.d(e,"a",(function(){return s}))},c41c:function(t,e,n){},c4dc:function(t,e,n){},c5cc:function(t,e,n){"use strict";n.d(e,"a",(function(){return s}));const i={"juejin.im":"apinew.juejin.im"};async function s({url:t,method:e="get",query:n,body:s,showError:r=!0,headers:o={},reqHost:c}){n&&(t+="?"+a(n));const l=i[window.location.host];t=l?`https://${l}${t}`:t;const u=await fetch(t,{credentials:"include",method:e,headers:{"Content-Type":"application/json"},body:s?JSON.stringify(s):void 0}),d=await u.json();if(r&&d.err_no){const t=new Error(d.err_msg);throw t.normalizedCode=d.err_no,t}return d}function a(t){return Object.keys(t).filter(e=>void 0!==t[e]).map(e=>`${encodeURIComponent(e)}=${encodeURIComponent(t[e])}`).join("&")}},c80e:function(t,e,n){},c901:function(t,e,n){"use strict";n.d(e,"a",(function(){return d}));var i=n("7a61"),s=n("8690"),a=n("bfe9"),r=n("9db5"),o=n("519d"),c=n("7f42");const l=["H1","H2","H3","H4","H5","H6","IMG","A","BLOCKQUOTE","UL","OL","LI","B","STRONG","U","I","SUP","SUB","STRIKE","P","BR","SPAN","DIV","CODE","PRE","TABLE","THEAD","TBODY","TFOOT","TR","TH","TD"],u=["href","src","title","alt"];class d{toEditingHtml(t){return h(Object(s["a"])(Object(a["a"])(t))).innerHTML}fromEditingHtml(t){return Object(i["a"])(Object(a["a"])(t))}}function h(t){t=m(t);const e=/^hljs \S+$/.test(t.className)?t.className.split(/\s+/).pop():"";switch(f(t),t.nodeName){case"B":t.className=c["CLASS_NAME"];break;case"STRONG":const n=document.createElement("b");n.innerHTML=t.innerHTML,t.className=c["CLASS_NAME"],t.parentNode.insertBefore(n,t),t.parentNode.removeChild(t),t=n;break;case"CODE":t.className=o["CLASS_NAME"];break;case"PRE":const i=document.createElement("div"),s=document.createTextNode(t.innerText);i.appendChild(s),t.setAttribute("code-lang",e),t.innerHTML=i.innerHTML,t.className=r["CLASS_NAME"];break;case"H1":case"H2":case"H3":case"H4":case"H5":case"H6":t.innerHTML=t.innerText;break}return Array.prototype.slice.call(t.children).forEach(h),t}function f(t){for(let e=t.attributes.length-1;e>=0;e--){const n=t.attributes[e].name;p(n)&&t.removeAttribute(n)}}function p(t){return-1===u.indexOf(t)}function m(t){if(g(t)){const e=b(t),n=document.createElement(e?"div":"span");return n.innerHTML=t.innerHTML,v(n,t),t.parentNode.insertBefore(n,t),t.parentNode.removeChild(t),n}return t}function g(t){return-1===l.indexOf(t.nodeName)&&t.parentNode}function b(t){const e=window.getComputedStyle(t);return-1===e.display.indexOf("inline")}function v(t,e){for(let n=e.attributes.length-1;n>=0;n--)t.setAttribute(e.attributes[n].name,e.attributes[n].value)}},c931:function(t,e,n){"use strict";var i=n("40fe"),s=n.n(i);s.a},ca2a:function(t,e,n){},cd49:function(t,e,n){"use strict";n.r(e);var i={};n.r(i),n.d(i,"$alert",(function(){return J})),n.d(i,"$error",(function(){return Q}));n("db4d");var s=n("2b0e"),a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"juejin-web-editor"}},[n("AlertList",{ref:"alertList"}),n("AntiblockAlert"),n("router-view")],1)},r=[],o=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"alert-list"},t._l(t.list,(function(t,e){return n("alert",{key:e,staticClass:"alert",attrs:{content:t.content,type:t.type}})})),1)},c=[],l=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"alert",class:[t.type]},[t._v(t._s(t.content))])},u=[],d={props:["type","content"]},h=d,f=(n("bafc"),n("2877")),p=Object(f["a"])(h,l,u,!1,null,"3350daf2",null),m=p.exports,g={components:{Alert:m},props:["timeout"],data:()=>({list:[]}),methods:{push(t){this.list.unshift(t),window.setTimeout(()=>{this.list=this.list.filter(e=>e!==t)},this.timeout||3e3)}}},b=g,v=(n("7600"),Object(f["a"])(b,o,c,!1,null,"6156d880",null)),_=v.exports,k=function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.visible?n("div",{staticClass:"antiblock-alert"},[n("span",[t._v(" 广告屏蔽插件可能会影响编辑器的正常使用与执行性能，请将此页面加入白名单 ")]),n("span",{staticClass:"close-btn ion-close",on:{click:t.close}})]):t._e()},y=[],C=n("964c"),w={data:()=>({visible:x()}),methods:{close(){this.visible=!1,j()}}};function x(){return!O()&&E()}function E(){const t=document.createElement("div");t.className="ad ads adv advert adsbox",document.body.appendChild(t);const e="none"===window.getComputedStyle(t).display;return document.body.removeChild(t),e}function O(){return!!C["a"]("hideAntiblockAlert")}function j(){C["b"]("hideAntiblockAlert",!0)}var T=w,S=(n("9221"),Object(f["a"])(T,k,y,!1,null,"4712b9df",null)),A=S.exports,L={components:{AlertList:_,AntiblockAlert:A},created(){this.$root.$on("alert",(t,e)=>{this.$refs.alertList.push({content:t,type:e})})}},I=L,$=(n("a0bb"),n("5c64"),Object(f["a"])(I,a,r,!1,null,null,null)),D=$.exports,N=n("78f8"),M=n.n(N),P=n("24c0"),U=n("c34c");s["a"].use(M.a);const R=new M.a({mode:"history",saveScrollPosition:!0,linkActiveClass:"route-active",scrollBehavior:(t,e,n)=>t.hash?{selector:t.hash}:{x:0,y:0},routes:[{path:"/editor",name:"index",component:n("0b6e").default},{path:"/editor/book/:id/section/:sectionId?",name:"bookEditor",component:n("33f7").default},{path:"/editor/drafts",name:"draftIndex",component:n("425c").default},{path:"/editor/drafts/:id",name:"editDraft",component:n("4cc8").default},{path:"/editor/posts/:id",name:"editPost",component:n("08a6").default},{path:"/editor/guide/markdown",name:"guide:markdown",component:n("e94c").default},{path:"*",name:"notFound",component:n("c32a").default}]});R.beforeEach((t,e,n)=>{n()});const F=Object(U["a"])(t=>{P["a"].exec("set","page",t.fullPath),P["a"].exec("send","pageview")},300);R.afterEach(F);var H=R,B=n("08e3"),q=n.n(B),z=n("916c"),V=n.n(z);s["a"].use(V.a);const X=new V.a.Store({modules:{auth:n("1b8d").default,error:n("5250").default,layout:n("58e8").default,draft:n("3d36").default}});X.types=n("7c64");var G=X,W=n("31bd"),Y=n("7bbb"),K="不要吹灭你的灵感和你的想象力; 不要成为你的模型的奴隶。 ——文森特・梵高";function J(t,e){t=t instanceof Error?t.message:t,this.$root.$emit("alert",t,e)}function Q(t,e){const n=e||("string"===typeof t?t:(t||{}).message)||"执行异常";this.$alert(n,"error"),console.error(t)}s["a"].use(n("d3a2")),s["a"].use(n("3b37")),Object.assign(s["a"].prototype,i);var Z=n("ca1f"),tt=n.n(Z);window.TEA=tt.a;const et="juejin.im"!==window.location.hostname;function nt(){Object(W["sync"])(G,H),s["a"].use(q.a),new s["a"]({store:G,router:H,render:t=>t(D)}).$mount("#juejin-web-editor")}function it(){console.log(K)}window.TEA.init({app_id:2608,channel:"cn",log:et}),window.TEA.config({app_name:"jj_web",disable_auto_pv:!0,_staging_flag:et?1:0}),window.TEA.start(),Y["c"](G).catch(t=>(console.error(t),window.alert("初始化失败，请检查登录状态"),Promise.reject(t))).then(nt).then(it)},cdb2:function(t,e,n){t.exports=n.p+"img/extend.ec7370cb.svg"},cde9:function(t,e,n){"use strict";var i=n("c41c"),s=n.n(i);s.a},cecb:function(t,e,n){"use strict";n.d(e,"a",(function(){return i})),n.d(e,"b",(function(){return s}));const i=500,s=2e4},d24a:function(t,e,n){t.exports=n.p+"img/summary-extend.0b48f17b.svg"},d3a2:function(t,e,n){"use strict";n.r(e),n.d(e,"install",(function(){return s}));var i=n("8690");function s(t,e){t.mixin({created(){this.$domEvents={listenerRemoverList:[]}},mounted(){const t=this.$options.domEvents;t&&Object.keys(t).forEach(e=>{this.$domEvents.listenerRemoverList.push(Object(i["f"])(window,e,n=>{t[e].call(this,n)}))})},beforeDestroy(){this.$domEvents.listenerRemoverList.forEach(t=>t())}})}},d45d:function(t,e,n){t.exports=n.p+"img/summary-collapse.1fdc233a.svg"},d5d1c:function(t,e,n){t.exports=n.p+"img/img.8288be10.svg"},d87f:function(t,e,n){"use strict";var i=n("7e9c"),s=n.n(i);s.a},da4a:function(t,e,n){},dd3b:function(t,e,n){},de99:function(t,e,n){"use strict";var i=n("c4dc"),s=n.n(i);s.a},df41:function(t,e,n){},dfa1:function(t,e,n){"use strict";var i=n("9af7"),s=n.n(i);s.a},dfb8:function(t,e,n){"use strict";var i=n("8199"),s=n.n(i);s.a},e022:function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));const{html2text:i,removeElement:s}=n("e4bf"),a=/PRE|TABLE|BLOCKQUOTE|FIGURE|IFRAME/,r=/转[载发]|原文(链接|地址)|文来自|发表?于/,o=/\.(\s|$)|。/;function c(t,e=140){const n=l(t),i=d(n),s=i.filter(t=>t.hasEndMark),a=s.map(t=>t.filteredText).join(" "),r=e>0?f(a,e):a;return r}function l(t){return i(u(t))}function u(t){try{return t=t.replace(/<!--[\s\S]*?-->/g,""),s(t,({tag:t})=>a.test(t))}catch(e){return console.error(e.message),t}}function d(t){return t.split(/\n+/).map(t=>t.replace(/\s+/g," ").trim()).filter(t=>t).map(t=>{const e=h(t).filter(t=>!r.test(t)).join(""),n=o.test(e);return{text:t,filteredText:e,hasEndMark:n}})}function h(t){return t.replace(new RegExp(o,"g"),"$&__SEN_END__").split("__SEN_END__").filter(t=>t)}function f(t,e){return t.length>e?t.slice(0,e-1)+"…":t}},e0a3:function(t,e,n){"use strict";var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("nav",{staticClass:"navigator",class:{active:t.active}},[n("div",{staticClass:"toggle-btn",style:{backgroundImage:"url("+t.avatarUrl+")"},on:{click:function(e){t.active=!t.active}}}),n("div",{directives:[{name:"show",rawName:"v-show",value:t.active,expression:"active"}],staticClass:"menu root-menu",on:{"!click":function(e){t.active=!1}}},[n("div",{staticClass:"item-group"},[n("a",{staticClass:"item",attrs:{href:"/editor/drafts/new?v=2"}},[t._v("写文章")]),1===t.user.book_author?n("a",{staticClass:"item",attrs:{href:"/editor/book/new/section?v=2"}},[t._v(" 写小册 ")]):t._e(),n("a",{staticClass:"item",attrs:{href:"/editor/drafts?v=2"}},[t._v("草稿")])]),n("div",{staticClass:"item-group"},[n("a",{staticClass:"item",attrs:{href:"/user/"+t.user.user_id}},[t._v("我的主页")]),n("a",{staticClass:"item",attrs:{href:"/user/"+t.user.user_id+"/likes"}},[t._v("我喜欢的")]),1===t.user.book_author?n("a",{staticClass:"item",attrs:{href:"/user/"+t.user.user_id+"/books?type=wrote"}},[t._v(" 我的小册 ")]):t._e(),n("a",{staticClass:"item",attrs:{href:"/user/"+t.user.user_id+"/collections"}},[t._v(" 我的收藏集 ")]),n("a",{staticClass:"item",attrs:{href:"/subscribe/subscribed"}},[t._v("标签管理")])]),t._m(0)]),n("ArticleImporter",{ref:"articleImporter"})],1)},s=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"item-group"},[n("a",{staticClass:"item",attrs:{href:"/user/settings/profile"}},[t._v("设置")]),n("a",{staticClass:"item"},[t._v(" 关于 "),n("i",{staticClass:"icon ion-chevron-right"}),n("div",{staticClass:"menu sub-menu"},[n("div",{staticClass:"item-group"},[n("a",{staticClass:"item",attrs:{href:"/app",target:"_blank"}},[t._v("下载应用")]),n("a",{staticClass:"item",attrs:{href:"/about",target:"_blank"}},[t._v("关于")]),n("a",{staticClass:"item",attrs:{href:"https://xitu.io/jobs",target:"_blank"}},[t._v(" 加入我们 ")]),n("a",{staticClass:"item",attrs:{href:"https://github.com/xitu/gold-miner",target:"_blank"}},[t._v(" 翻译计划 ")]),n("a",{staticClass:"item",attrs:{href:"https://bd.juejin.im",target:"_blank"}},[t._v(" 合作伙伴 ")])])])])])}],a=n("5c91"),r=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{directives:[{name:"show",rawName:"v-show",value:t.importing,expression:"importing"}],staticClass:"article-importer"},[n("input",{ref:"fileInput",staticClass:"file-input",attrs:{type:"file",multiple:"multiple"},on:{change:function(e){return t.onFileSelected(e)}}}),n("div",{staticClass:"text"},[t._v(t._s(t.text))])])},o=[],c=n("6c54"),l=n("c901"),u=n("705e");const d={id:"5562b428e4b00c57d9b94b9d"};function h(t){const e=b(t.name);return"markdown"===e?f(t):"wysiwyg"===e?p(t):Promise.resolve()}function f(t){const e=new u["a"],n=g(t.name);return v({type:"markdown",title:n,tags:[],markdown:t.content,html:e.toHtml(t.content),screenshot:"",abstract:"",category:d}).then(t=>c["a"](t))}function p(t){const e=new l["a"],n=m(t.content),i=n.title||g(t.name);return v({type:"wysiwyg",title:i,tags:[],markdown:"",html:e.fromEditingHtml(e.toEditingHtml(n.content)),screenshot:"",abstract:"",category:d}).then(t=>c["a"](t))}function m(t){const e=t.replace(/^[\s\S]*?<body>/i,"").replace(/<\/body>[\s\S]*$/i,""),n=e.replace(/^[\s\S]*?<h1[\s\S]*?>([\s\S]+?)<\/h1>[\s\S]*$/i,"$1").trim(),i=e.replace(/<h1[\s\S]*?>[\s\S]+?<\/h1>/i,"").trim().replace(/http:\/\/upload-images/i,"https://upload-images");return{title:n,content:i}}function g(t){return t.replace(/\..+?$/,"").replace(/^-+|-+$/g,"").replace(/(?=\S)-(?=\S)/g," ")}function b(t){return/\.md$/i.test(t)?"markdown":/\.html$/i.test(t)?"wysiwyg":void 0}function v(t){return c["c"](t)}var _=n("8896"),k={data:()=>({list:[],importing:!1,importedCount:0}),computed:{user(){return this.$store.getters.USER},text(){return this.importing?`正在导入（${this.importedCount} / ${this.list.length}）`:""}},methods:{openFileDialog(){this.$refs.fileInput.click()},onFileSelected({target:t}){const e=[].slice.call(t.files);e.length&&(e.some(t=>!/\.(md|html)$/i.test(t.name))?this.$error("只支持 .md 和 .html 文件"):this.importFromFileList(e).then(()=>{this.$refs.fileInput.value=null}))},importFromFileList(t){return this.list=t,this.importedCount=0,this.importing=!0,this.importArticleList().catch(t=>{this.$error(t),this.importing=!1})},importArticleList(){if(this.importedCount<this.list.length){const t=this.list[this.importedCount];return Object(_["b"])(t).then(e=>h({name:t.name,content:e})).then(()=>(this.importedCount++,this.importArticleList()))}return this.updatePageState(),Promise.resolve()},updatePageState(){window.location.href="/editor/drafts?t="+Date.now()}}},y=k,C=(n("2e106"),n("2877")),w=Object(C["a"])(y,r,o,!1,null,"e196e394",null),x=w.exports,E={components:{ArticleImporter:x},data:()=>({active:!1}),computed:{user(){return this.$store.getters.USER},avatarUrl(){const t=this.user.avatar_large;return t?Object(a["a"])(t,64,64):""}},domEvents:{click({target:t}){this.$el.contains(t)||(this.active=!1)}},methods:{importArticle(){this.$refs.articleImporter.openFileDialog()}}},O=E,j=(n("4cf4"),Object(C["a"])(O,i,s,!1,null,"204624f7",null));e["a"]=j.exports},e108:function(t,e,n){"use strict";var i=n("46bb"),s=n.n(i);s.a},e151:function(t,e,n){},e234:function(t,e,n){},e248:function(t,e,n){"use strict";n.d(e,"d",(function(){return o})),n.d(e,"c",(function(){return c})),n.d(e,"a",(function(){return l})),n.d(e,"f",(function(){return u})),n.d(e,"b",(function(){return d})),n.d(e,"e",(function(){return h})),n.d(e,"g",(function(){return f}));var i=n("c5cc"),s=n("7bbb"),a=n("bde8"),r=n("b8ba");function o(t,e){return s["a"]()?Object(i["a"])({url:"/content_api/v1/article_draft/query_list",method:"post",body:{}}).then(t=>t.data).then(t=>(t||[]).map(a["a"].fromDescriptor)):Promise.reject(Object(r["c"])())}function c(t){return s["a"]()?Object(i["a"])({url:"/content_api/v1/article_draft/detail",method:"post",body:{draft_id:String(t)}}).then(t=>t.data).then(t=>t?a["a"].fromDescriptor(t,"detail"):{}):Promise.reject(Object(r["c"])())}function l(t){return s["a"]()?Object(i["a"])({url:"/content_api/v1/article_draft/create",method:"post",body:{category_id:String(t.category.id||""),tag_ids:t.tags.map(t=>t.tag_id||t.id),link_url:t.link_url||"",cover_image:t.screenshot||"",is_gfw:t.is_gfw,title:t.title||"",brief_content:t.brief_content,is_english:t.is_english,is_original:t.is_original,edit_type:"markdown"===t.type||10===t.type?10:0,html_content:t.html||"",mark_content:t.markdown||""}}).then(t=>t.data).then(t=>t?a["a"].fromDescriptor(t):{}):Promise.reject(Object(r["c"])())}function u(t){return s["a"]()?Object(i["a"])({url:"/content_api/v1/article_draft/update",method:"post",body:{id:String(t.id),category_id:String(t.category.id||""),tag_ids:t.tags.map(t=>t.tag_id||t.id),link_url:t.link_url||"",cover_image:t.cover_image||"",is_gfw:t.is_gfw,title:t.title||"",brief_content:t.brief_content,is_english:t.is_english,is_original:t.is_original,edit_type:"markdown"===t.type||10===t.type?10:0,html_content:t.html||"",mark_content:t.markdown||""}}).then(t=>t.data):Promise.reject(Object(r["c"])())}function d(t){if(!s["a"]())return Promise.reject(Object(r["c"])());s["b"]();return Object(i["a"])({url:"/content_api/v1/article_draft/delete",method:"post",body:{draft_id:String(t)}}).then(t=>t.data)}function h(t,e){return s["a"]()?Object(i["a"])({url:"/content_api/v1/article/publish",method:"post",body:{draft_id:String(t)}}).then(t=>t.data).then(t=>(window.TEA("article_publish",{user_level:e,user_id:t.user_id||"0",article_id:t.article_id||"0",published_at:t.ctime||0,category_id:t.category_id||0}),t)):Promise.reject(Object(r["c"])())}function f(t){}},e37c:function(t,e,n){"use strict";n.d(e,"b",(function(){return o})),n.d(e,"a",(function(){return c})),n.d(e,"e",(function(){return l})),n.d(e,"c",(function(){return u})),n.d(e,"d",(function(){return d}));var i=n("e248");function s(t){return i["c"](t)}function a(t){return i["g"](t)}var r=n("6c54");function o(t){return s(t)}function c(t){return r["f"](t)}function l(t){return a(t)}function u(t){return`https://${window.location.host}/post/${t}`}function d(){return`https://${window.location.host}/published`}},e3ce:function(t,e,n){"use strict";var i=n("56b5"),s=n.n(i);s.a},e4bf:function(t,e,n){"use strict";n.r(e),n.d(e,"html2text",(function(){return r})),n.d(e,"removeElement",(function(){return o}));const{BLOCK_LEVEL_ELEMENT_LIST:i,VOID_ELEMENT_LIST:s,CHAR_MAP:a}=n("abd9");function r(t){const e=`__BLOCK_BOUND_${Date.now()}__`;return t=t.replace(/[\r\n]+/g,"\n"),t=t.replace(/<br[^>]*>/g,"\n"),t=t.replace(/[ \f\t\v]+/g," "),t=t.replace(/<\/?([^>\s]+)[^>]*>/g,(t,n)=>c(n.toUpperCase())?e:""),t=t.replace(new RegExp(`^(${e})+|(${e})+$`,"g"),"").replace(new RegExp(`(${e})+`,"g"),"\n"),t=t.replace(/&(\S+?);/g,t=>a[t]||t),t}function o(t,e){const n=[],i=[];while(t){const s=t.match(/<\/?([^>\s]+)([^>]*)>/);if(s){const a=s.index,r=s[0],o=s[1].toUpperCase(),c="/"===r[1],u=l(o);if(i.length)if(c){if(i[0]!==o)throw new Error("end tag is not matched.");i.shift()}else!u&&i.unshift(o);else{const c=(s[2].match(/id="(.+?)"/i)||{})[1],l=(s[2].match(/class="(.+?)"/i)||{})[1];n.push(t.slice(0,a)),e({id:c,tag:o,className:l})?!u&&i.unshift(o):n.push(r)}t=t.slice(a+r.length)}else n.push(t),t=""}return n.join("")}function c(t){return i.includes(t)}function l(t){return s.includes(t)}},e94c:function(t,e,n){"use strict";n.r(e);var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("MarkdownEditor",{attrs:{guided:!0,post:t.post}})},s=[],a={title:"掘金－Markdown 编辑器使用手册",markdown:n("1518")},r=n("88f3"),o={components:{MarkdownEditor:r["a"]},data:()=>({post:a})},c=o,l=n("2877"),u=Object(l["a"])(c,i,s,!1,null,"35caaf9a",null);e["default"]=u.exports},e974:function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));class i{}i.fromServerDescriptor=function(t){return t?(t=Object.assign(Object.assign(Object.assign({},t),t.category||{}),t.user_interact||{}),i.fromDescriptor({id:t.category_id,name:t.category_name,title:t.category_name,subscribed:t.is_follow,category_url:t.category_url})):null},i.fromDescriptor=function(t){return t?Object.assign(new i,t):null}},ea37:function(t,e,n){"use strict";n.d(e,"a",(function(){return r}));var i=n("a810"),s=n.n(i);n.d(e,"b",(function(){return s.a}));var a=n("b9bf");function r(t){return s()(o(t||""))}function o(t){const e=t.replace(/<!--[\s\S]*?-->/g,"").replace(/<[^>]*>/g,"");return Object(a["htmlDecode"])(e)}},ec8c:function(t,e,n){},ee10:function(t,e,n){"use strict";n.d(e,"a",(function(){return c})),n.d(e,"b",(function(){return u}));var i=n("1487"),s=n.n(i),a=n("7cbb"),r=function(t){var e={keyword:"query mutation subscription|10 type input schema directive interface union scalar fragment|10 enum on ...",literal:"true false null"};return{aliases:["gql"],keywords:e,contains:[t.HASH_COMMENT_MODE,t.QUOTE_STRING_MODE,t.NUMBER_MODE,{className:"type",begin:"[^\\w][A-Z][a-z]",end:"\\W",excludeEnd:!0},{className:"literal",begin:"[^\\w][A-Z][A-Z]",end:"\\W",excludeEnd:!0},{className:"variable",begin:"\\$",end:"\\W",excludeEnd:!0},{className:"keyword",begin:"[.]{2}",end:"\\."},{className:"meta",begin:"@",end:"\\W",excludeEnd:!0}],illegal:/([;<']|BEGIN)/}};function o(t,e,n){t.registerLanguage(e,n)}function c(){return s.a.listLanguages().sort()}function l(t){return!!s.a.getLanguage(t)}function u(t,e){return l(t)?s.a.highlight(t,e).value:Object(a["a"])(e)}o(s.a,"graphql",r)},ee38:function(t,e,n){},ee80:function(t,e,n){"use strict";var i=n("0c00"),s=n.n(i);s.a},f1da:function(t,e,n){"use strict";var i=n("043c"),s=n.n(i);s.a},f673:function(t,e,n){"use strict";var i=n("37c5"),s=n.n(i);s.a},f8ff:function(t,e,n){},f9a5:function(t,e,n){t.exports=n.p+"img/logo.3e69d5af.svg"},fa05:function(t,e,n){"use strict";var i=n("5636"),s=n.n(i);s.a}});